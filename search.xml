<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>写作手法</title>
      <link href="/posts/20251209094457/"/>
      <url>/posts/20251209094457/</url>
      
        <content type="html"><![CDATA[<h2>如何写一篇比较好的科技类文章</h2><ol><li>摘要必须理清，具有吸引力<blockquote><p>这是一个测试语句</p></blockquote></li></ol>]]></content>
      
      
      <categories>
          
          <category> Paper </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Write </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>四种DRL算法的异同</title>
      <link href="/posts/20251204182715/"/>
      <url>/posts/20251204182715/</url>
      
        <content type="html"><![CDATA[<h2>MADDPG<sup>[1]</sup>、MATD3、MAPPO<sup>[2]</sup>与PMPO的异同</h2><p>MADDPG、MATD3、MAPPO与PMPO四种算法都是“多智能体强化学习”的不同做法，可以把它们理解成为同一个目标下的四种“学习风格”。</p><h3>一、共同目标</h3><p>举一个简单的例子几个小机器人在一起搬箱子，每个机器人都能看到一部分环境，却不知道别人怎么想，它们必须一起完成任务，但每个机器人都在“自私地”学自己的策略，因此整个环境总是在变，学习容易不稳定。</p><p>这四个算法都是用来解决这个核心问题：<font color="#d970d5">多智能体一起学习，但环境因为大家同时变化而变得很难学。</font></p><p>四者的共同点有：</p><ol>  <li>都属于多智能体强化学习，适用于多个智能体共同完成任务；</li>  <li>都采用集中训练、分散执行的方式。训练时共享一些信息，执行时各自独立；</li>  <li>都试图让学习过程稳定，避免“你变我变大家都变导致学不会”的情况</li></ol><h3>二、四个算法的直观区别</h3><h5>1. MADDPG</h5><ul>  <li>比喻：MADDPG就像每个学生都用自己的笔记(actor)，但考试时老师(critic)会告诉每个学生“我看到了全班人的答案，你这个答案好不好”，所以其比单独学习更稳定；</li>  <li>技术特点：是DDPG<sup>[3]</sup>的多智能体版本，适合连续动作问题，比如机器人控制；</li>  <li>优点：容易理解，容易实现，比单智能体更稳定；</li>  <li>缺点：DDPG本身不太稳定，训练容易受超参数影响。</li></ul><h5>2. MATD3</h5><ul>  <li>比喻：比MADDPG更聪明的学生。他知道“老师可能偏心，把分数打高了”，于是引入两个老师（双Q值）同时评分，让分数更真实，从而学习更稳；</li>  <li>技术特点：是TD3<sup>[4]</sup>的多智能体版本，因此比MADDPG大幅提升稳定性；</li>  <li>优点：比MADDPG更稳，更不容易学炸；</li>  <li>缺点：仍然属于确定性策略，探索不如随机策略。</li></ul><h5>3. MAPPO</h5><ul>  <li>比喻：这群学生的学习方式变了，不是去猜正确答案，而是“学习一套概率分布”，让自己的行为更有弹性，并利用“概率裁剪”（防止更新太猛）保持稳定；</li>  <li>技术特点：基于PPO<sup>[5]</sup>的多智能体方法，现在非常流行；</li>  <li>优点：非常稳定，特别适合大规模智能体，比如多人对抗游戏、交通调度等；</li>  <li>缺点：在某些高精度连续控制任务的样本效率不如TD3/MATD3。</li></ul><h5>4. PMPO</h5><ul>  <li>比喻：这群学生不光学习自己的策略，它们还学习“大家之间如何协作的概率关系”，有点像研究团队合作模式的学生，把协作结构建模得更细；</li>  <li>技术特点：基于策略梯度，重点在于“建模智能体之间的协作概率结构”；</li>  <li>优点：更强的协同能力，更适合复杂任务；</li>  <li>缺点：计算复杂度比较高，不如MAPPO那样广泛使用。</li></ul><h3>三、总结</h3><p>按学习方式分类：</p><ul>  <li>确定性策略方法：MADDPG和MATD3</li>  <li>随机策略方法：MAPPO和PMPO</li></ul>按稳定性：<ul>  <li>最稳定：MATD3和MAPPO</li>  <li>较不稳定：MADDPG</li>  <li>稳定但复杂度高：PMPO</li></ul><p>MADDPG：多智能体版 DDPG，简单但不够稳。</p><p>MATD3：加强版 MADDPG，更稳定。</p><p>MAPPO：多智能体 PPO，最稳定使用最广。</p><p>PMPO：建模协作结构更强，但更复杂。</p><p>相对应的应用背景：</p><ul>  <li>机器人或物理控制类：MATD3。</li>  <li>游戏对抗、多智能体协作：MAPPO。</li>  <li>新颖的研究、强化智能体协作结构：PMPO。</li>  <li>简单跑通一个demo：MADDPG 或 MAPPO</li></ul><ol><li>Lowe R, Wu Y I, Tamar A, et al. Multi-agent actor-critic for mixed cooperative-competitive environments[J]. Advances in neural information processing systems, 2017, 30.</li><li>Yu C, Velu A, Vinitsky E, et al. The Surprising Effectiveness of PPO in Cooperative Multi-Agent Games[C]//Thirty-sixth Conference on Neural Information Processing Systems Datasets and Benchmarks Track.</li><li>Lillicrap T P, Hunt J J, Pritzel A, et al. Continuous control with deep reinforcement learning[J]. arXiv preprint arXiv:1509.02971, 2015.</li><li>Fujimoto S, Hoof H, Meger D. Addressing function approximation error in actor-critic methods[C]//International conference on machine learning. PMLR, 2018: 1587-1596.</li><li>Schulman J, Wolski F, Dhariwal P, et al. Proximal policy optimization algorithms[J]. arXiv preprint arXiv:1707.06347, 2017.</li></ul>]]></content>
      
      
      <categories>
          
          <category> ML &amp;&amp; DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> PPO </tag>
            
            <tag> Dr. </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MAPPO论文阅读1</title>
      <link href="/posts/20251203150250/"/>
      <url>/posts/20251203150250/</url>
      
        <content type="html"><![CDATA[<h1>Distributed Pursuit-Evasion Game of Limited Perception USV Swarm Based on Multiagent Proximal Policy Optimization</h1><h2>方法概要</h2><p>  该文章提出一种用于多USV的追逃博弈的分布式捕获策略优化方法，基于MAPPO算法，结合速度控制机制，形成动态包围圈；网络层采用Bi-GRU；策略方面采用动态障碍物（速度和方向）和课程学习技术。</p><h3>状态表示</h3><p>追捕者的局部观测由三部分组成，分别为：1. 自身状态，包括：当前速度，通过速度控制机制计算出的期望速度，碰撞半径和航向；2. 感知范围内第1到第m个相邻追捕者，分别包括：与第n个相邻者生成的VO区域，欧氏距离以及$\frac{1}{t_n}$ （$t_n$为预测的碰撞时间）；3. 感知范围内第1到第q个静态障碍物，分别包括与第p个相邻者生成的VO区域，欧氏距离以及$\frac{1}{t_p}$ （$t_p$为预测的碰撞时间）。</p><p>对于2,3组成部分，按欧氏距离对其进行排序，并裁剪为一个固定维度的向量，即限制数量，最终以一个128维固定长度的向量输入到Bi-GRU网络中。</p><p>对于不同的追捕者的观测状态排序问题，基于相对角度$\alpha_r$重新组织观测状态，其表示追捕者和逃避者速度方向之间的角度。</p><h3>奖励函数设计</h3><p>$$r_i = r_{vo} + r_{col} + r_{f}$$</p><p>其中，$r_{vo}$是一个即时奖励，用于鼓励追捕者尽可能选择VO区域之外的速度，以避免在追捕过程中遇到障碍</p><p>$$r_{vo} =\begin{cases}l_1 - l_2 \cdot \left | \mathrm{v} - \mathrm{v^{des}} \right | , \quad \mathrm{v} \notin \mathrm{VO} \quad or \quad t &gt; t_s \\l_3 - L_4 \cdot (t + 0.1)^{-1}, \quad \mathrm{v} \in \mathrm{VO} \quad and \quad t &gt; 0.1 \cdot t_s \\-l_5 \cdot (t + 0.1)^{-1}, \quad t &lt; 0.1 \cdot t_s\end{cases}$$</p><p>其中$\mathrm{v}$和$\mathrm{v^{des}}$分别表示追逐者当前速度和速度控制机制输出的期望速度，$l_1$ 和 $l_2$ 是用于鼓励追逐者接近逃避者的可调参数，$t$ 是估计的碰撞时间，$t_s$ 是安全避障时间。当追逐者的速度在 VO 区域内时,且小于$0.1 \cdot t_s$，$l_5$ 用于惩罚这种行为。当追逐者的速度在 VO 区域内时，应分配负奖励以惩罚这种行为，其中 $l_3$ 和 $l_4$ 表示奖励系数。向量 $C_{VO} = [\mathrm{v}_P, \mathrm{v}_l, \mathrm{v}_r ]^T$ 可用于确定当前速度 \mathrm{v} 是否在 VO 区域内。</p><p>$$\begin{matrix}\mathrm{v} \notin VO : (\mathrm{v} - \mathrm{v}_p) \times\mathrm{v}_l &lt; 0 \vee (\mathrm{v} - \mathrm{v}_p) \times\mathrm{v}_r &gt; 0 \\\mathrm{v} \in VO : (\mathrm{v} - \mathrm{v}_p) \times\mathrm{v}_l \ge 0 \vee (\mathrm{v} - \mathrm{v}_p) \times\mathrm{v}_r \le 0.\end{matrix}$$</p><p>当 $t &lt; 0.1\cdot t_s$ 时，意味着追踪者即将在短时间内发生碰撞，应给予负奖励。</p><p>$r_{col}$ 是一种延迟奖励，当发生碰撞时提供负奖励。通过整合即时奖励和延迟奖励，它允许追逐者同时考虑当前任务和长期目标。</p><p>$r_f$ 是对包围阵型的奖励，旨在激励追捕者均匀地分布在逃避者周围，定义如下：</p><p>$$r_f = -l_6 \cdot \frac{1}{n} \sum_{i=1}^n d_{1E} \cdot d_{iE}$$</p><p>其中$\hat{d}_\mathrm{iE}$是从追逐者$i$指向逃避者的单位向量，$r_f$的范围是$[−l_6, 0]$，并且更高的值表示更好的包围队形，应该注意的是，只有当$n \ge 2$时，队形奖励$r_f$才有意义。</p><h3>算法架构图</h3><p><img src="http://pzxnys.github.io/images/20251203.png" alt="算法架构图"></p><p>由于MAPPO采用随机策略，其策略网络输出动作为概率分布。为了增强MAPPO的随机探索能力，引入了虚拟障碍，并设置其为随机动作选择，有利于更好地处理不确定性，加速训练收敛，并提高策略的泛化能力。</p><h3>课程学习</h3><p>多无人艇追逃场景通常包含多个追逐者和逃避者。直接针对大规模捕获任务进行训练通常会导致策略收敛缓慢和奖励稀疏问题。此外，追逐者和逃避者的相对速度以及包围半径也会影响捕获任务的难度。</p><p>因此，将课程学习融入到训练过程中，该过程从一个小规模的捕获任务、一个较大的包围半径和较慢的移动速度开始进行训练。这种方法鼓励追捕者在初始阶段探索复杂的捕获行为。随后，通过调整无人艇群的大小、包围半径和无人艇的速度，逐渐增加捕获任务的难度，直到与实际难度相符。</p><p>课程学习提供了一种渐进式的训练策略，使追逐者能够更有效地学习，并应对最初难以获得积极奖励的情况。这种训练技术通过探索引导和任务排序，有效地解决了稀疏奖励问题，并增强了追逐者在解决复杂捕获任务中的鲁棒性。</p><p>课程学习过程：首先使用三艘USV(一艘逃避者和两艘追逐者)在无障碍场景中进行训练；然后向场景中添加障碍物；最后逐渐增加追逐者的数量到四艘。逃避者的最大速度设置为追逐者最大速度的80%</p><h3>超参数设置</h3><p><img src="http://pzxnys.github.io/images/20251204.png" alt="超参数设置"></p><h3>结论</h3><p>本文研究了多无人水面艇（USV）追逃博弈问题，并提出了一种适用于具有有限感知范围的USV集群的分布式捕获控制方法。所提出的方法是一种端到端的控制方法，不需要系统模型的知识。该方法具有在未知环境中自主学习和持续优化捕获策略的能力。通过增强传统的MAPPO训练框架，并在训练过程中加入课程学习，该方法进一步提高了策略的探索性能和收敛速度。通过对比仿真实验和虚拟现实场景测试，验证了该方法的有效性。实验结果表明，该方法在策略收敛速度、捕获效率和泛化能力方面具有显著优势，并在实际场景中具有潜在的适用性。未来的研究将侧重于探索涉及多个追逐者和多个逃避者的追逃博弈问题，以及策略从仿真到实践的转移。</p><div style="font-size: 14px; line-height: 1.6; color: #5a5a5aff;"><ul><li>Li F, Yin M, Wang T, et al. Distributed pursuit-evasion game of limited perception USV swarm based on multiagent proximal policy optimization[J]. IEEE Transactions on Systems, Man, and Cybernetics: Systems, 2024.</li></ul></div>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
            <tag> MAPPO </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一学就废</title>
      <link href="/posts/20231013140818/"/>
      <url>/posts/20231013140818/</url>
      
        <content type="html"><![CDATA[<h2 id="div-align-center-Assimilatioon-of-Clear-sky-FY-4A-AGRI-radiances-within-the-WRFDA-system-for-the-prediction-of-a-landfalling-Typhoon-Hagupit-2020-br-br-WRFDA系统中同化FY-4A-的-AGRI-晴空辐射数据用于预测Hagupit-2020-台风登陆-div"><div align='center'> Assimilatioon of Clear-sky FY-4A AGRI radiances within the WRFDA system for the prediction of a landfalling Typhoon Hagupit(2020) <br><br>WRFDA系统中同化FY-4A 的 AGRI 晴空辐射数据用于预测Hagupit(2020)台风登陆</div></h2><h3 id="div-align-center-Abstract-div"><div align=center>Abstract</div></h3><p>在天气研究与预报模型数据同化（Weather Research and Forecasting model’s Data Assimilation, WRFDA）系统框架中同化风云四号A（FY-4A）卫星先进静止辐射成像仪（AGRI）的辐射数据，并以登录台风Hagupit为背景设计了两个实验，讨论同化晴空辐射对台风分析和预测的附加价值。一个实验室同时同化 AGRI 辐射数据和全球电信系统（Global Telecommunications System, GTS）的传统数据，对照实验实验是仅同化GTS数据。结果表明，通过动力场和热力场变量与探空观测值的均方根误差（Root Mean Square Error, RMSE）反映得出，同化 AGRI 辐射后，分析场的误差减小。此外，台风轨迹和降雨预报的最终改善，可能在一定程度上依赖于500 hPa 位势高度增量和垂直平均水平水汽通量的分析。通过同化台风核心的 AGRI 辐射，相对湿度超过95的区域被扩大，从而使预报中的降雨分布和强度都得到改善。改进后的动力场和热力场使 AGRI 实验的台风轨迹预测更加精确，在 36 h 的预报中，平均误差为 37 KM。</p><blockquote><p>全球电信系统（Global Telecommunications System, GTS）是世界气象组织（World Meteorological Organization, WMO）创建和管理的国际气象和气候数据传输和分发系统，GTS 旨在促进全球气象数据、观测数据、天气预报、警告和其他气象信息的传递和共享，已支持气象预报、监测和应急响应。以下是有关 GTS 的一些关键特点和信息：</p><ol><li class="lvl-3"><strong>数据传输和分发：</strong> GTS 是一个全球性的通信网络，他通过卫星、互联网、电报、无线电和其他通信手段传输气象和气候数据。这些数据包括观测数据（如温度、湿度、风速等）、气象雷达图像、卫星图像、数值天气模型输出和其他气象信息；</li><li class="lvl-3"><strong>国际合作：</strong> GTS 依赖于国际合作，因为气象和气候信息需要在不同国家之间进行传递。国际气象社区通过 WMO 协调这些活动，以确保数据的可靠传输和共享；</li><li class="lvl-3"><strong>数据标准化：</strong> GTS 使用标准化的数据格式和编码规则，以确保数据的一致性和互操作性。这有助于不同国家和气象机构之间的数据交换；</li><li class="lvl-3"><strong>支持气象服务：</strong> GTS 的主要目标之一是支持天气预报、气象监测、自然灾害警告和气候研究。通过快速传递数据和信息，GTS 有助于提高气象服务的效能；</li><li class="lvl-3"><strong>多媒体数据：</strong> 除了传输数值数据之外，GTS 还支持多媒体数据，如卫星图像和雷达图像。这些数据对气象专业人员和大众都很有用；</li><li class="lvl-3"><strong>国家气象服务：</strong> 每个国家都有自己的国家气象服务，负责在本国范围内管理 GTS 的数据传输和分发。这些机构与国际气象社区合作，以确保数据的全球传递。</li></ol><p>总的来说，全球电信系统是一个关键的气象和气候信息传输网络，通过它，气象数据可以在国家范围内快速、可靠地传递，从而支持天气预报、气象监测和气象研究。这有助于提高气象服务的质量和全球气象信息的可用性。</p></blockquote><h3 id="div-align-center-Introduction-div"><div align=center>Introduction</div></h3><p>台风预报所面临的问题：</p><ol><li class="lvl-3"><p>对小尺度非线性特征的描述不精确；</p></li><li class="lvl-3"><p>台风动力场和热力场模型，物理过程的缺陷；</p></li><li class="lvl-3"><p>台风核心观测数据不足；</p></li><li class="lvl-3"><p>海气相互作用机制的理解不足；</p></li></ol><p>尽管有一些研究人员表明，使用多普勒雷达观测，通过径向速度和反射率的同化可以减少台风轨迹和强度预报的误差，但其存在一定的缺陷，即无法提供海水连续时空覆盖。</p><p>为了最大限度减少台风预报误差，大量研究通过同化遥感数据来提高模型初始场的质量，欧洲中期天气预报中心（European Centre for Medium-Range Weather Forecasts, ECMWF）统计得出，卫星数据同化占所有同化数据的 90% 以上。在所有类型的卫星中，对地静止卫星能提供高时空分辨率的观测，被广泛应用于区域数值天气预报。</p><p>新一代静止卫星（相较于之前的静止卫星，它们的观测值有着显著提高）包括：</p><ol><li class="lvl-3"><p>Geostationary Operational Environmental Statellite (GOES)， 美国国家海洋和大气管理局 (NOAA)</p></li><li class="lvl-3"><p>风云-4A/4B (FY-4A/4B)，中国气象局 (CMA)</p></li><li class="lvl-3"><p>Himawari-8/-9，日本气象厅 (JMA)</p></li><li class="lvl-3"><p>……</p></li></ol><br><font size=2; color=grey>[1]. Shu A, Shen F, Jiang L, et al. Assimilation of Clear-sky FY-4A AGRI radiances within the WRFDA system for the prediction of a landfalling Typhoon Hagupit (2020)[J]. Atmospheric Research, 2023, 283: 106556.</font>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>菜就要多学</title>
      <link href="/posts/20231002140259/"/>
      <url>/posts/20231002140259/</url>
      
        <content type="html"><![CDATA[<h2 id="台风过程的大气-海洋-海浪耦合与卫星数据同化模拟">台风过程的大气-海洋-海浪耦合与卫星数据同化模拟</h2><h3 id="div-align-center-摘要-div"><div align = center>摘要</div></h3><p>  对于台风多发海域，准确模拟出台风过程风场、波浪场和流场是至关重要的。本文采用 MCT 耦合器将中尺度大气模型 WRF、非结构化网络海洋模型 FVCOM 及非结构化网格波浪模型 SWAN 进行耦合，并在计算过程中利用 WRF 大气模式的资料同化模块 WRFDA 对风场进行卫星资料同化，即建立大气-海洋-海浪实时耦合模型与卫星数据同化的联合运用模型（WRF-FVCOM-SWAN-ASSIMILATION 模型，简称 W-F-S-A 模型），对海南岛附近海域台风过程进行模拟，进一步获得了设计要素。论文的主要工作和结论如下：</p><blockquote><ol><li class="lvl-3"><p>在通过 MCT 耦合器实现 WRF-FVCOM-SWAN 模型耦合的基础上，通过 FVCOM 模式和 SWAN 模式的热启动，成功建立了 WRF-FVCOM-SWAN-ASSIMILATION（W-F-S-A）耦合同化数学模型（以下简称 W-F-S-A 耦合同化模型）。</p></li><li class="lvl-3"><p>分别基于纯 WRF 模型驱动、纯耦合模型、W-F-S-A 耦合同化模型对台风风场路径和强度、海表温度场、波浪场模拟结果进行了比较，结果表明，W-F-S-A 耦合同化模型模拟结果与实测数据偏差最小。</p></li><li class="lvl-3"><p>对 1999 - 2018 共 20 年间经过海南岛附近海域的 70 场台风进行了 W-F-S-A 耦合同化模拟，得到了台风过程风场、海表流场、海表温度场和波浪场模拟结果。</p></li><li class="lvl-3"><p>基于 20 年台风过程风、浪模拟结果，获得了单一变量和联合分布的不同重现期设计要素。</p></li></ol></blockquote><p><strong>关键词：</strong> 大气-海洋-海浪耦合模型；连续同化；台风；频率分析；联合分布</p><h3 id="div-align-center-绪论-div"><div align = center>绪论</div></h3><h4 id="研究目的和意义">研究目的和意义</h4><p>  台风具有极强的破坏性，对于建筑物、沿海生态系统、电力设施都具有较大的危害。而且从台风发生的空间分布来看，西北太平洋是全球台风发生频率最高的区域，约占全球总数的 1/3。我刚频率西北太平洋，是全球范围内受台风影响最大的国家之一，年平均有 9.3 个台风影响我国，居世界之首。近年来，南海作为我国重要战略区域的地位日趋明显，获得南海海域的海洋环境设计要素对于南海海上工程的建设十分关键。获得合理设计参数需要对台风过程的风场、流场以及波浪场进行模拟。因此，如何合理准确地模拟台风过程中的风、浪、流过程，具有十分重要的意义，成为本文研究的主要内容。</p><h4 id="国内外主要研究进展">国内外主要研究进展</h4><h5 id="台风过程风、浪、流的特征">台风过程风、浪、流的特征</h5><p><strong>台风风场特征</strong></p><p>  台风风场的平面结构可以简单分成两部分，其中心区域为台风眼区，是一个低压区，风速很弱；台风眼区外的空气向台风眼汇合，在北半球气流呈逆时针方向旋转，且产生大风区。另外，由于在北半球，空气质点受到的科氏力与径向速度垂直，使得台风的运动呈右偏性。</p><p><strong>台风过程中海洋的响应特征</strong></p><p>  台风过程中海洋的响应特征体现在两方面，一方面是对海表流场的影响，另一方面是对海表温度场的影响。</p><ol><li class="lvl-3"><p><strong>海表流场：</strong> 台风过境时，受风应力作用，海表会形成旋转流场。台风过境时，海表往往会形成逆时针旋转流场，流场中心位于台风中心的右后方，具有一定的滞后性。且流场具有明显的右偏性，台风移动路径右侧的流速大于左侧。</p></li><li class="lvl-3"><p><strong>海表温度场：</strong> 台风过境时，会引起海表较大幅度的降温，最大降温幅度受台风强度、海洋结构的影响。且温度场受风场制约呈不对称分布，具有明显的右偏性，最大降温区位于台风移动路径的右侧。</p></li></ol><p><strong>台风过程中海浪的响应特征</strong></p><p>  台风过程中，巨大的风应力会产生强烈的风浪，风浪与远处传来的涌浪叠加，构成了台风浪，台风浪的时空分布特征主要受台风风场制约，同时也受岛屿效应、海底地形以及潮流的影响。台风过境时，海表会形成旋转波浪场，呈椭圆形分布，且波浪场受风场制约呈不对称分布，具有明显的右偏性，台风移动路径右侧的有效波高大于左侧。</p><h5 id="台风过程数值模拟">台风过程数值模拟</h5><p><strong>台风过程风场数值模拟</strong></p><p>  近年来台风模拟的发展较为迅速，从早期的客观分析法，到经验模型法，再至现在常用的数值模拟法，对于台风模拟的精度提升和风场刻画日趋完善。</p><p>  <strong>客观分析法：</strong> 风场计算最传统的方法，其原理是将气象站的观测资料在地形网格上进行插值，从而实现风场数据的扩充，同时利用相关的约束条件与物理方程对风场数据进行修正，使数据满足动力平衡条件。但修正后的数据仍具有观测资料本身具有的不连续性、风速局限性、不稳定性等特点，同时还有观测的偶然性误差。</p><p>  <strong>经验模型法：</strong> 使用相关的台风模型取代了物理约束方程，但是其本质上并没有改善实测数据质量和数量的不足，并且台风模型多为轴对称模型，对于实现高精度模拟和台风复杂风场的刻画还是有一定难度。</p><p>  <strong>数值模拟法：</strong> 随着计算机技术的快速发展，其成为新的研究方向，同时人们也要通过寻求更精确的风场资料、研究更完备的台风模型去改善台风模拟结果。对于风场资料的获取也从最初的仪器观测资料，发展到雷达资料，再到卫星数据资料，目前已发展至卫星资料再分析数据，这从源头上提高了风场模拟的精度。近年来，数值模拟方法不断发展，中尺度大气模式逐渐成为主流。</p><p><strong>台风过程流场和温度场数值模拟</strong></p><p>  台风对海洋的作用主要体现在海表流场和海表温度场这两方面，这两者的模拟主要通过海洋模式实现，目前海洋模式已发展到三维模拟，国内外普遍采用的模式主要由 ECOM、ROMS、POM、和 FVCOM 等。其中前三种模型多采用结构化网格，这对于实际岸线的刻画是不利的。FVCOM 海洋模型采用三角形网格，即非结构化网格，可模拟复杂岸线对流场和温度场的影响，其能较好地刻画出流场、温度场的右偏性、以及流场的滞后性等特点。</p><p><strong>台风过程波浪场数值模拟</strong></p><p>  波浪研究一直是国内外海洋动力学研究的热门话题，对于波浪参数与波浪传播过程的模拟计算，目前主流的方法是通过数学模型求解波浪在传播过程中的折射、绕射效应以及浅水变形，数学模型原理主要分为经典的射线理论、缓坡方程、Boussinesq 方程和波作用谱平衡方程。在上世纪八十年代后期，研究者开始利用波作用谱方程作为数学模型模拟波浪。目前已经发展至第三代海浪模式，主要包括 WAM、WAVEWATCH III、SWAN 等。近年来的波浪模拟普遍采用了风场驱动海浪模式的计算方法进行数值模拟，在一定程度上提高了模拟效果。研究发现，在复杂地形中，利用嵌套模式是更为科学准确的。</p><p><strong>耦合模式对台风的数值模拟</strong></p><p>  台风与海洋之间存在强烈的热量交换，台风过境时会导致海表温度下降，且台风强度越大，海表温度降低的幅度越大。相应地，海表温度降低会减少供给台风的潜热通量、感热通量和水汽通量，导致台风强度减弱。另一方面，台风在海表产生的近惯性流也会导致混合层温度持续降低，从而减弱台风强度。因此为了更真实地模拟出台风过程的风场、流场和温度场，需要建立<strong>大气-海洋耦合模式</strong>。其对模拟精度的提高是十分必要的</p><p>  台风是台风浪生成的主要动力因素，因此在波浪的模拟中考虑风场的影响是必不可少的，波浪对于大气的影响是不可忽略的，分为动力作用和热力作用。在动力作用中，大气传递动量到上层海洋，驱动表层海水运动，部分动能被海浪场吸收，因此动力作用会减弱台风强度；在热力作用中，海浪会增强海表感热、潜热通量对于大气的传递，从而增强台风强度。因此为了提高风场和波浪场的模拟精度，需要建立<strong>大气-海浪的实时双向耦合模式</strong>。其可以较好地改善台风强度的模拟效果，但对台风路径的改善程度较小。</p><p>  台风过程中海洋内部也有强烈的相互作用，因此考虑<strong>海洋-海浪耦合模式</strong>，实现其计算也是十分重要的。</p><p>  由上文可知，<strong>大气－海洋耦合</strong>可以改善台风过程的风场、流程、温度场的模拟效果，<strong>大气－海浪耦合模式</strong>可以可以较好地改善台风强度的模拟效果，<strong>海浪－海洋耦合模式</strong>较好地改善了流场和波浪场的模拟结果。因此，更优化的耦合方式正在由两者互相耦合的计算模式向三者两两耦合的计算模式发展，<strong>大气－海洋－海浪耦合模式</strong>就在此基础上建立起来了。国内外目前建立的海气浪耦合模式主要基于结构化网格，这对于实际岸线的刻画是不利的，因此引入非结构网格的数值模式，例如 FVCOM 海洋模型，可以模拟复杂岸线对流场和温度场的影响，改善模拟结果。</p><h5 id="卫星资料同化研究">卫星资料同化研究</h5><p>  卫星资料同行是在资料通话的基础上发展起来的，资料同行的理论基础来源于气象学中的分析技术。资料同化的含义是，基于统计“最优”的目的，将多种不同形式的观测数据融合到数值模拟模式中，从而建立起实测值与数值模拟值之间的相互协调关系，在观测资料足够多的前提下，数值模拟模式通过不断导入、整合、调整观测数据，从而使模拟结果越来越接近实际情况，最终得到的模拟结果达到在统计意义上最合理、最准确的效果。</p><p>  资料同化理论的发展较早，上个世纪 60 年代开始，同化的基本概念形成，此时的同化方法以逐步订正法为主。到上个世纪 80 年代，最优插值法成为当时主导的同化方法，在这一时间段内变分法被提出并逐渐形成。90 年代，变分方法渐渐成熟并开始得到应用。随着卫星的出现，卫星遥感资料的高质量、全球性、高频次、高精度等优点使用同化效果得到了极大的提高，目前各国气象部门普遍采用卫星遥感资料的直接同化。21 世纪初，提出了混合资料同化方法，例如三维变分同化法。</p><p>  目前世界上采用三维变分同化进行大气模拟的系统有 GSI 同化系统和 WRF 大气模式。GSI（Grid Statistical Interpolation）业务同化系统是美国环境预报中心（NCEP）所采用的同化系统，主要用于全球预报、区域预报以及飓风预报，是目前世界上较先进和成熟的同化系统之一。WRFDA（WRF Data Assimilation）同化模块是 WRF 大气模式中一个不依赖主模块的，可以单独安装编译单独使用的模块。</p><p>  当然，卫星资料同化也不是完美无瑕的，由于卫星数据也是观测资料，必然存在仪器的观测误差，同时还有辐射传输模式造成的系统性偏差、统计学的偶然误差等，因此卫星资料同化还需要一定的“修正”方法。总结台风过程模拟的工作可以发现，目前利用<strong>大气－海洋－海浪耦合模型</strong>和<strong>卫星数据同化</strong>进行台风过程模拟的工作还不多见。</p><h5 id="水文频率分析方法研究">水文频率分析方法研究</h5><p>  正确获取波高的多年分布规律，从而合理地确定不同重现期的设计波高数值，是十分关键的。最传统的方法是采用全部实测波浪数据，利用不同的坐标转换，按直线外延推求不同重现期的设计波高。这种方法的本质是依据经验对直线外延，有两个主要缺点，其一：采用不同的定线方法，对计算结果的影响较大，任意性和随机性较大；其二：对于未完全开发的区域，往往没有长期的波浪实测资料，所以样本数据的容量不够。</p><p>  随后发展出了年最大值分析法，即对年最大波高组成的系列， 选配一条合适的理论频率曲线，外延推求多年一遇设计波高。其中应用于水文频率统计的概率分布函数主要有皮尔逊 III 型分布、对数正态分布、耿贝尔第一型极值分布和威布尔分布等。这种方法引进了多种概率分布函数，提供了多种科学的定线方法，解决了以往定线随机性的问题。但是无法解决样本数据容量过小的问题，因为波浪资料的年限往往不够长，由几十个或十余个经验点数据选配一条理论频率曲线，任意性还是比较大的。</p><p>  <strong>泊松-耿贝尔复合极值分布：</strong> 首先根据台风统计资料，经过分析得出影响某一个海域的台风发生频次极好地符合泊松（Poisson）分布；然后检验每次台风影响下形成的波高，得到波高分布在包伟尔几率格纸上呈现直线关系，说明台风波浪波高原始分布符合耿贝尔（Gumbel）分布，由此得到了一种海洋工程中推算设计波高的方法。《港口与航道水文规范》（JTS145-2015）中规定，对于台风多发海域，某一波向一年中出现一个以上较大台风波高时，可按台风波高的最大值系列取样，采用泊松一耿贝尔复合极值分布确定不同重现期的设计波高。</p><p>  随着海洋、海岸工程的发展，采用联合分布方法计算风、浪、流联合频率越来越受到人们的重视。因为台风过程各要素的计算结果中，最大风速、最大流速、最大波高往往不在同一时刻出现，并且各要素最大值的组合形式是复杂多样的，若采用传统的单一要素频率分析法，其结果往往偏于过于保守。联合分布方法以对海洋工程影响最大的要素作为主导要素，考虑了与该要素最大值同时发生的其他要素的较大值，更符合实际情况，在保证设计安全的情况下有可能降低工程造价。</p><h4 id="本文的主要研究工作">本文的主要研究工作</h4><p>  目前的大多数研究所采用的模拟方法是数值模型模拟出风场，再利用风场驱动海洋模型和海浪模型获得流场、温度场和波浪场，这样的模拟方法局限于单一模型的独立模拟，且模拟精度与实际情况偏差较大，受制于风场的模拟精度。因此，本文的模型从两方面改善台风过程中各数值场的模拟精度。</p><p>  其一是改善风场模拟本身的精度，因为受风场初始场资料的分辨率较低和数值模型积分过程的计算误差影响，模拟得到的风场结果会有台风移动路径不准确、台风强度偏弱等问题，由此产生了利用卫星资料对模拟结果进行校正的方法–卫星资料连续同化。卫星资料具有时空分辨率较高、覆盖面积较广的特点，在很大程度上弥补了海洋气象站的常规观测资料稀少的缺点。</p><p>  其二是通过模型耦合提高模拟精度。由于台风过程不是单一的大气作用过程，而是一个复杂的大气-海洋-海浪相互作用的过程，因此模拟思路应该更向实际情况发展，不局限于单一模型的独立模拟，也不再局限于离线耦合，而是向多个软件的实时耦合发展，建立大气-海洋-海浪的实时耦合模型，这样的模拟思路在原理上更科学更符合实际，且对于台风风场、海表流场、温度场和波浪场的模拟效果都有相应改善。</p><p>  另外，对于各设计要素的确定，传统方法大多是对各设计要素分别进行概率分析，然后选取其某一重现期值作为设计标准。但是各种极端情况同时出现的概率极小，如最大风速、最大波高同时发生在同一时刻的概率极小，所以传统方法是不符合实际、也是偏于保守的，会导致工程成本估算过高，因此为合理反映海洋工程在实际中受风、浪的影响，获得风、浪的联合分布更具有实际价值。</p><p>  为了提高台风过程风、浪、流模拟精度，本文将采用 MCT 耦合器对中尺度大气模型 WRF、非结构化网络海洋模型 FVCOM及非结构化网格波浪模型 SWAN 进行耦合，并在计算过程中利用 WRF 大气模式的资料同化模块 WRFDA（WRF Data Assimilation）对风场进行卫星资料同化，即建立大气-海洋-海浪实时耦合模型与卫星数据同化的联合运用模型，对 1999-2018 年影响海南岛海域的台风过程风场、海表流场、波浪场进行数值模拟，最后利用水文频率统计法获得工程所需的设计要素。</p><h3 id="div-align-center-基于卫星同化的大气-海洋-海浪实时耦合模式-div"><div align=center>基于卫星同化的大气-海洋-海浪实时耦合模式</div></h3><h4 id="数值模型简介">数值模型简介</h4><p>  由于台风过程不仅涉及大气本身的变化，而且涉及海洋、波浪的变化，因此分别采用大气、海洋和波浪模型描述这些变化过程并通过模型耦合描述他们之间的相互影响。</p><h4 id="耦合器及耦合方案">耦合器及耦合方案</h4><h5 id="耦合器">耦合器</h5><p>  大气－海洋－波浪耦合模式基于 MCT（Model Coupling Toolkit）耦合器建立。MCT 耦合器是一款用来建立耦合模式的开源程序工具包。MCT 支持并行耦合系统的各子模式间多个分布式变量的数据交换。MCT 采用 FORTRAN90 编写，包含一系列 FORTRAN 模块，各子模式调用这些模块实现数据的发送和接收。<a target="_blank" rel="noopener" href="https://github.com/quantheory/MCT">MCT 开源代码</a></p><h5 id="耦合方案">耦合方案</h5><p>  耦合模式由主程序调用 WRF、FVCOM 和 SWAN 子模式同时独立计算，在设定的某一计算时间，各子模式调用MCT子程序进行数据的发送和接收，实现子模式两两之间的实时数据交换。由于 WRF 采用结构化网格，FVCOM 和 SWAN 采用相同的非结构化三角形网格，WRF 和 FVCOM、SWAN 之间进行变量交换时需要进行插值，而 FVCOM 和 SWAN 之间可以直接传递变量。模式耦合机制如图 1 所示。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-04-09-21-50.png'/><font size=2; color=natural>图 1. 模式耦合机制</font></div><h4 id="大气-海洋耦合机制">大气-海洋耦合机制</h4><h5 id="大气对海洋的作用">大气对海洋的作用</h5><p>  大气与海洋耦合中，台风过程中的海气相互作用主要体现在海面大风造成上层海洋强烈的搅拌和混合，改变其热力结构。大气对海洋产生强迫作用，主要包括海表面风应力、长波辐射、短波辐射、感热通量、潜热通量、海面以上 10m 处风速。FVCOM 模式在笛卡尔坐标下的三维动量方程和连续性方程为：</p><p>$$<br>\left\{\begin{matrix}<br>\frac{\partial u}{\partial t} + u \frac{\partial u}{\partial  x} + v \frac{\partial u}{\partial y} + w \frac{\partial u}{\partial z} - fv = -\frac{1}{\rho_0} \frac{\partial (P_H + P_a)}{\partial x} - \frac{1}{\rho_0}\frac{\partial q}{\partial x} + \frac{\partial }{\partial z}(K_m \frac{\partial u}{\partial z} ) + F_u \\<br>\frac{\partial v}{\partial t} + u \frac{\partial v}{\partial  x} + v \frac{\partial v}{\partial y} + w \frac{\partial v}{\partial z} + fu = -\frac{1}{\rho_0} \frac{\partial (P_H + P_a)}{\partial y} - \frac{1}{\rho_0}\frac{\partial q}{\partial y} + \frac{\partial }{\partial z}(K_m \frac{\partial v}{\partial z} ) + F_v \\<br>\frac{\partial w}{\partial t} + u \frac{\partial w}{\partial x} + v \frac{\partial w}{\partial y} + w \frac{\partial w}{\partial z} = -\frac{1}{\rho_0} \frac{\partial q}{\partial z} + \frac{\partial }{\partial z}(K_m \frac{\partial w}{\partial z} ) + F_w \\<br>\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} + \frac{\partial w}{\partial z} = 0<br>\end{matrix}\right.<br>\tag{1}<br>$$</p><p>  温度扩散方程为：</p><p>$$<br>\frac{\partial T}{\partial t} + u \frac{\partial T}{\partial x} + v \frac{\partial T}{\partial y} + w \frac{\partial T}{\partial z} = \frac{\partial }{\partial t}(K_h \frac{\partial T}{\partial z} ) + F_T<br>\tag{2}<br>$$</p><p>式中，$x,\ y$ 和 $z$ 分别为笛卡尔坐标系中坐标，分别代表水平和垂直方向；$u,\ v$ 和 $w$ 分别是流速沿 $x,\ y,\ z$ 方向的分量；$T$ 代表温度；$f$ 是科氏力参数；$\rho_0$ 为海水密度；$P$ 为压力；$K_h$ 代表紊动动能的垂向扩散系数。$F_u$ 代表 $x$ 方向的水平动量，$F_v$ 代表 $y$ 方向水平动量，$F_t$ 代表温度扩散项。</p><p>  流速 $u$ 和 $v$ 表面边界条件为：</p><p>$$<br>K_m(\frac{\partial u}{\partial z}, \frac{\partial v}{\partial z}) = \frac{1}{\rho_0}(\tau_{sx}, \tau_{sy})<br>\tag{3}<br>$$</p><p>$$<br>(\tau_{sx}, \tau_{sy}) = C_d \sqrt{U_{10}^2 + V_{10}^2}(U_{10},\ V_{10})<br>\tag{4}<br>$$</p><p>其中，$(\tau_{sx}, \tau_{sy})$ 是表面风应力的 $x、y$ 方向分量，$C_d$ 为拖曳力系数，$(U_{10}，V_{10})$ 为海面上空 10m 处风速。</p><p>  而温度的表面和底部边界条件为：</p><p>$$<br>\frac{\partial T}{\partial z} = \frac{1}{\rho c_p K_p} [Q_n(x,y,t) - SW(x,y,\zeta,t)]<br>\tag{5}<br>$$</p><p>$$<br>\frac{\partial T}{\partial z} = -\frac{A_H tan \alpha}{K_h} \frac{\partial T}{\partial n}<br>\tag{6}<br>$$</p><p>其中 $Q_n(x,y,t)$ 是表面净热通量，包括四部分：向下的短波辐射通量和长波辐射通量，感热通量和潜热通量；$SW(x,y,\zeta,t)$ 是到达海表面的短波辐射通量，$C_p$ 是海水的比热容，$S_H$ 是水平热扩散系数，$\alpha$ 是底部地形的坡陡，$n$ 是水平坐标。</p><p>  耦合时，大气模式传递到海洋模式中的海面上空 10m 风速用以计算表面风应力，影响流场的求解。而传递的长波辐射、短波辐射、感热通量、潜热通量用以计算 $Q_n(x,y,t)$ 和 $SW(x,y,\zeta,t)$，影响温度扩散方程的求解，改变海表温度分布。</p><h5 id="海洋对大气的作用">海洋对大气的作用</h5><p>  海洋向上的热量通量是台风系统发展和维持的重要热源，其主要通过海表温度来体现，海表温度既影响台风的形成和移动，又影响台风强度。耦合模式中，海洋模式模拟的海表温度 SST 传递至 WRF 模式中，通过表面层方案更新大气模式下垫面温度，继而通过下垫面温度影响边界层方案、积云对流方案和辐射方案计算，对表面通量（长波辐射、短波辐射、表面应力等）和大气状态（位温、湿度、云雨等）产生影响，影响模拟的台风强度和路径。由于涉及方程表达式较多，本文不再赘述。</p><h4 id="大气-海浪耦合机制">大气-海浪耦合机制</h4><h5 id="海浪对大气的作用">海浪对大气的作用</h5><p>  气浪耦合中，大风条件下，强浪场显著改变了海表状态，直接影响海气界面上的动量、热量和物质交换过程，这种影响通过海表粗糙度的变化来实现。在 WRF 模式中需要计算表面动量 、热量 和湿度 ，三者分别表示如下：</p><p>$$<br>F_m = \rho_1 C_m |\vec{V_{SL}}|^2<br>\tag{7}<br>$$</p><p>$$<br>F_h = \rho_1 c_p C_{hq}(\theta_{sk} - \theta_1)<br>\tag{8}<br>$$</p><p>$$<br>F_q = \rho_1 LC_{hq}M(q_{vsk} - q_{v1})<br>\tag{9}<br>$$</p><p>其中，$C_m$ 为动量交换系数，$C_{hq}$ 为热通量和水汽通量有效交换系数，具体关系式为：</p><p>$$<br>C_m = \frac{U^2_* }{|\overline{V_{SL}}|^2}<br>\tag{10}<br>$$</p><p>$$<br>\vec{V_{SL}}^2 = u^2 + v^2<br>\tag{11}<br>$$</p><p>$$<br>C_{hq} = u_*k[\psi_h(\frac{Z_r}{L_{MO}}) - \psi_h(\frac{Z_{OT}}{L_{MO}}) + ln(\frac{Z_r}{Z_{OT}})]^{-1}<br>\tag{12}<br>$$</p><p>其中，$Z_r$ 是观测高度，$Z_{OT}$ 是有温度贡献的海表面粗糙长度，$L_{MO}$ 是 Monin-Obukhov 长度。</p><p>$$<br>L_{MO} = \frac{-u_*^3 \bar{\theta}}{kg(\theta_{sk} - \theta_{1})}<br>\tag{13}<br>$$</p><p>  摩阻速度 $u_<em>$ 和由动量贡献的海表面粗糙长度 $Z_{om}$ 有关，$u_</em>$ 和 $Z_{om}$ 关系式如下：</p><p>$$<br>u_* = k |\vec{V_{SL}}| [\psi_m(\frac{Z_r}{L_{MO}}) - \psi_m(\frac{Z_{om}}{L_{MO}}) + ln(\frac{Z_r}{Z_{om}})]^{-1}<br>\tag{14}<br>$$</p><p>  海面上的波浪将改变海表面粗糙度 $Z_o$ 中的 $Z_{om}$ 大小，通过建立 $Z_{om}$ 和波浪参数之间的关系可以反映波浪对风场的影响：</p><p>$$<br>Z_{om} = f(H_{wave},\ L_{pwave},\ T_{psurf})<br>\tag{15}<br>$$</p><p>  Taylor 等根据实验数据提出了粗糙度关于波高和波陡的关系式：</p><p>$$<br>Z_{om} = 1200.0H_{wave}(H_{wave} / L_{pwave})^{4.5}<br>\tag{16}<br>$$</p><p>其中，$H_{wave}$ 是有效波高，$L_{pwave}$ 是谱峰周期对应的波长。</p><p>  WRF 模式的 MYNN 近地面层方案中可以选用 Taylor 参数化方案，但波浪要素通过考虑风速的经验公式计算。本文对 Taylor 参数化方案计算方法进行改进，耦合时，WRF 模式海表粗糙度根据 SWAN 模式有效波高、谱峰周期和谱峰波长等结果实时更新，而不是采用经验公式计算波浪要素。</p><h5 id="大气对海浪的作用">大气对海浪的作用</h5><p>  热带气旋过程中，强风的作用引起海表形成较大的风浪，耦合中，大气模式向海浪模式传递海面上 10 米处的风速作为波浪场的驱动风场。</p><p>  SWAN 模式的建立基于包含源汇项的波作用谱平衡方程，描述风浪生成及其在近岸区的演化过程。在直角（笛卡尔）坐标系下，波作用谱平衡方程的表达式为：</p><p>$$<br>\frac{\partial}{\partial t} N + \frac{\partial}{\partial x} C_x N + \frac{\partial}{\partial y} C_y N + \frac{\partial}{\partial \sigma} C_\sigma N + \frac{\partial}{\partial \theta} C_\theta N = \frac{S}{\sigma}<br>\tag{17}<br>$$</p><p>其中，$N$ 为波作用密度谱，$S$ 为用谱密度表示的源汇项；$\theta$ 为波向，即各谱分量垂直于波峰线的方向；$\sigma$ 为波浪的相对频率，即在随水运动的坐标系中观测到的频率；$C_x、C_y$ 为 $x、y$ 方向的波浪传播速度；$C_\theta、C_\sigma$ 为 $\theta、\sigma$ 空间的波浪传播速度。</p><p>  SWAN 模式中波作用谱平衡方程的源汇项表达式为：</p><p>$$<br>S = S_{in} + S_{ds,w} + S_{da,b} + S_{da,br} + S_{nl4} + S_{nl3}<br>\tag{18}<br>$$</p><p>其中，$S_{in}$ 表示风能输入，$S_{ds,w}$ 表示由白浪引起的波能耗散，$S_{ds,b}$ 表示由底部摩擦引起的波能耗散，$S_{ds,br}$ 表示水深变浅引起的波浪破碎，$S_{nl4}$ 表示四波非线性相互作用，$S_{nl3}$ 表示三波非线性相互作用。</p><p>  风能输入 $S_{in}$ 由两部分组成：线性增长项和指数增长项。风能输入表达式为：</p><p>$$<br>S_{in} = A + BE(\sigma,\theta)<br>\tag{19}<br>$$</p><p>式中，$A$  表示线性增长项，$BE$ 表示指数增长项。在 SWAN 模式中，输入项是海面上空 10m 处的风速 $U_{10}$，而 $A$ 和 $BE$ 的计算过程中采用摩擦速度 $U_*$，两者之间的关系式为：</p><p>$$<br>U_* = C_D U_{10}^2<br>\tag{20}<br>$$</p><p>其中，$C_D$ 表示风拖曳力系数：</p><p>$$<br>C_D = (0.55 + 2.97 \widetilde{U} - 1.49 \widetilde{U}^2) \times 10^{-3} \\<br>\widetilde{U} = U_{10} / U_{ref}<br>\tag{21}<br>$$</p><p>其中，$U_{ref}$ 是参考风速。</p><p>  因此，大气模式模拟的海面以上 10m 风速影响波浪模式中的风能输入项，进而影响波作用谱平衡方程的求解。</p><h4 id="海洋-海浪耦合机制">海洋-海浪耦合机制</h4><h5 id="海浪对海洋的作用">海浪对海洋的作用</h5><p>  波浪会对水流的运动过程、分布形式产生复杂影响，主要表现为：波浪辐射应力产生驱动力、海面粗糙度增大引起表面风应力的增加以及底部剪切应力改变导致底部摩阻的增加，本文仅考虑波浪辐射应力的影响。在笛卡尔坐标系下，考虑三维辐射应力的 FVCOM控制方程，请移步原文。</p><p>  耦合中，海浪模式传递波高、波向、波长等给海洋模式FVCOM，FVCOM 基于传递的波参数计算波速、波数、波能与波浪辐射应力，进而求解控制方程。</p><h5 id="海洋对海浪的作用">海洋对海浪的作用</h5><p>  水流也会对波浪的演变过程和形态产生复杂影响，水流流向和波浪传播方向异同会引起波要素（例如：波速、波长、波陡等）的变化。SWAN 模式波作用谱平衡方程，请移步原文。</p><p>  模型耦合时，海洋模式传递流速和水位给海浪模式，水深和背景流场的变化影响波浪模式中的频率迁移和波浪折射，影响波作用谱平衡方程的求解。</p><h4 id="卫星资料连续同行">卫星资料连续同行</h4><h5 id="WRFDA-概述">WRFDA 概述</h5><p>  WRF 大气模式的资料同化模块 WRFDA（WRF Data Assimilation）是一个不依赖主模块的，可以进行单独编译并且单独使用的模块。本文采用同化模块版本为 WRFDA 3.8.1（目前最新为：<a target="_blank" rel="noopener" href="https://github.com/wrf-model/WRF">WRFDA 4.5.1</a>），可以实现的功能包含：混合资料同化（Hybrid）、集合卡尔曼变换（ETKF）、三维变分同化（3D-Var）、思维变分同化（4D-Var）。WRFDA 系统包括观测数据前处理（OBSPROC），主区域同化及侧边界条件更新，背景场误差协方差构造（GEN BE）等功能模块，各模块以及它们与 WRF 系统的其余部分的关系如图 2 所示。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-04-17-41-09.png'/><font size=2; color=natural>图 2. WRFDA运行流程图</font></div><h5 id="三维变分同化原理">三维变分同化原理</h5><p>  WRFDA 中的三维变分同化系统是基于 MM5 大气模式的三维变分同化系统（3D-Var）发展起来。变分数据同化系统的基本原理是通过迭代算法求解指定的目标函数以获取对于真实气候状态的一个最优估计。变分同化的内容主要包括目标函数得确定，观测算子及预报模式的选取，背景场误差协方差 $B$ 的计算，控制变量 $v$ 与分析整理 $\delta_x$ 的变换关系 $U$ 的建立、下降算法选取与目标函数计算。具体步骤请移步原文。</p><p>  卫星资料的连续同化通过 WRF 大气模式的资料同化模块 WRFDA（WRF Data Assimilation）来实现，本文的同化方案采用三维变分同化。图 3 所示为一个模拟时间步长的耦合-同化过程：在初始耦合计算完成后生成了 WRF 风场的初始场和边界条件，然后再单独运行 WRFDA 模块进行卫星资料同化，并更新 WRF 的初始场和边界条件，再以新的初始场和边界条件进行耦合模型计算，得到同化后的 WRF 的风场数据、FVCOM 的流场数据和 SWAN 的波浪场数据，至此完成了第一个模拟时间步长的耦合一同化计算，之后的计算以此类推，最终完成所有时间步长的耦合一同化计算，实现连续耦合一同化计算。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-04-17-57-15.png'/><font size=2; color=natural>图 3. 耦合-同化过程</font></div><h4 id="本章小节">本章小节</h4><p>  本章从模式概述以及控制方程两方面对本课题所采用的中尺度大气模式 WRF、非结构化网格海洋模型 FVCOM、第三代海浪模式 SWAN、大气-海洋-海浪耦合机制、卫星资料同化原理以及耦合模拟-数据同化联合模型进行了介绍。</p><h3 id="div-align-center-台风算例与耦合同化计算方案的确定-div"><div align = center>台风算例与耦合同化计算方案的确定</div></h3><h4 id="风场资料的选取">风场资料的选取</h4><p>  本文主要针对海南岛附近海域进行分析。根据热带气旋的强度划分依据，并结合<a target="_blank" rel="noopener" href="http://typhoon.zjwater.gov.cn/">台风实时发布系统</a> 和 <a target="_blank" rel="noopener" href="https://www.typhoon.org.cn/">中国台风网</a>，对1999 - 2018 年间经过太平样的共计 528 场热带气旋进行了路径观察和强度分析。具体资料选取，请移步原文。</p><h4 id="计算区域与网格划分的确定">计算区域与网格划分的确定</h4><p>  影响 WRF 模型计算的物理参数有很多，其中计算区域范围和网格精度是两个十分关键的影响因素。具体<strong>计算区域与网格划分的确定</strong>请移步原文。</p><p>  为了取得更准确的风场模拟结果，且在一定程度上保证计算资源与模拟结果的平衡，本文的 WRF 大气模式采用水平方向的大小网格嵌套计算，地形范围在合理程度上进行扩大，覆盖至菲律宾海域，地形范围如图 4 所示，主区域 D1（大模型）与嵌套区域 D2（小模型）均采用正方形网格。主区域 D1 的经度范围为 $104.07^\circ E$ ~ $130.28^\circ E$，纬度范围为 $0.15^\circ N$ ~ $40.63^\circ N$，其空间分辨率为 12km，网格数为 $372 \times 199$；嵌套区域 D2 的经度范围为 $106.51^\circ E$ ~ $116.38^\circ E$，纬度范围为 $16.23^\circ N$ ~ $22.26^\circ N$，其空间分辨率为 4km，网格数为 $168 \times 258$。垂向分层层数采用不均匀的 35 层。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-04-21-09-13.png'/><font size=2; color=natural>图 4. 计算范围地形</font></div><p>  海洋模型 FVCOM 和海浪模型 SWAN 的水平网格为非结构化三角形网格，采用经纬坐标，近岸和水深变化剧烈处采用局部网格加密最小网格点间距约 500m，开边界处网格较疏，最大网格点间距约 20km。地形纬度范围为 $11.60^\circ N$ ~ $25.38^\circ N$，经度范围为 $105.61^\circ E$ ~ $119.65^\circ E$。模型单元数 50785，网格节点数为 26418，地形范围和网格示意图如图 5。FVCOM 海洋模型垂向采用 $\sigma$ 坐标分为 15 层。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-04-21-10-15.png'/><font size=2; color=natural>图 5. FVCOM 模式和 SWAN 模式的计算范围和网格</font></div><h4 id="耦合模式计算方程的确定">耦合模式计算方程的确定</h4><h5 id="WRF-模式计算方案的确定">WRF 模式计算方案的确定</h5><p>  WRF 大气模式是通过选取不同的计算参数来模拟相应的气象过程，不同的计算参数对于台风模拟的路径、强度影响较大，因此针对模拟研究区域选取合适的计算参数是十分关键的。</p><p>  本文采用的是 W-F-S-A 耦合同化模式，其中耦合模式相对于单一的 WRF 模式有所改进。单一的 WRF 模型中一般需要引入参数以描述海浪的作用。近年来，国内外普遍采用海表面粗糙度对海浪的影响进行参数化因此耦合模式基于 Taylor 和 Yelland 公式对原始 WRF 计算模型进行了修改，建立了海表面粗糙度 $Z_{om}$ 与波浪参数（波高、谱峰周期、波长）的关系，将其加入至 MYNN 选项中：</p><p>$$<br>Z_{om} = 1200.0 H_{wave}(H_{wave} / L_{wave})^(4.5)<br>\tag{22}<br>$$</p><p>并同时改进 WRF 计算模型中的海表面层和海表边界层的物理模式。本文选取的 WRF 模型参数如表 1 所示。</p><p><font size=2; color=natural>表 1. WRF 模式参数选择结果</font></p><table align = center>    <tr>        <th width=150px;>项目</th>        <th width=400px>方案</th>    </tr>    <tr>        <td>陆面过程</td>        <td>Noah-MP</td>    </tr>    <tr>        <td>积云参数化</td>        <td>Kain-Fritsch</td>    </tr>    <tr>        <td>微物理过程</td>        <td>WSM6 方案</td>    </tr>    <tr>        <td>短波辐射</td>        <td>Dudhia 方案</td>    </tr>    <tr>        <td>长波辐射</td>        <td>RRTM 方案</td>    </tr>    <tr>        <td>表面层</td>        <td>Monin-Obukhov-Janjic(Eta) 方案；MYNN 方案</td>    </tr>    <tr>        <td>边界层</td>        <td>Mellor-Yamada-Janjic(Eta) 方案；MYNN 2.5 阶方案</td>    </tr></table><h5 id="耦合模式计算方案的确定">耦合模式计算方案的确定</h5><p>  WRF 主区域积分时间步长根据手册的推荐，取为计算网格精度 12km 的 6 倍，即 72s，主区域 D1 与嵌套区域 D2 采用双向计算。为排除非耦合和耦合试验初始海表温度不同导致的海气界面差异，温度初始场的海表温度均采用 NECP 的全球日平均数据 RTG_SST，潮位开边界使用 MIKE21 提取，并提前计算 ７ 天获得耦合模拟时的初始流场。FVCOM 模型积分时间步长取 5s。SWAN 模型由较大范围的波浪模拟结果提供边界场和初始场，计算时间步长 300s。WRF、FVCOM 和 SWAN 三者耦合交换时间步长取 600s。</p><h4 id="同化方案的确定">同化方案的确定</h4><h5 id="卫星资料的选取">卫星资料的选取</h5><p>  要通过卫星资料连续同行改善风场模拟精度，前提是选择合适的卫星遥感资料。本文选取 NOAA-15、NOAA-18 两颗卫星的 AMSU-A 亮温资料进行同行。其中 AMSU-A 探测器包含 15 个通道，第 4-14 号通道为 AMSU-A1，主要探测大气温度数据，第 1、2、3 和 15 号通道为 AMSU-A2（窗区/表面），主要探测降水量和地表信息。本文采用的传感器通道为第 5~9 号通道。</p><h5 id="计算模式的确定">计算模式的确定</h5><p>  大气辐射传输模式类型的选取对于同化模块是十分关键的，WRF 中采用了国际上应用较为广泛的两种快速辐射传输模式：CRTM 与 RTTOV。经过前人的实验对比，本文选择 CRTM 快速辐射传输模式 2.1.3 版本（目前为 <a target="_blank" rel="noopener" href="https://github.com/JCSDA/crtm">V 2.4.0</a>）作为同化时的大气辐射传输模式。</p><h5 id="同化方法的确定">同化方法的确定</h5><p>  本文采用 GSI-3Dvar 三维变分同化，无法实时融合各时段的卫星资料数据，只能选取指定同化窗口内的卫星资料数据作为同化数据进行融合分析，且单次童虎窗口的时间步长不宜过大，不可能覆盖整个台风模拟时间段。所以，本文采取卫星资料连续同化的方法改善这一缺陷，以 6h 间隔资料循环同化方案为例进行说明，若某一卫星经过研究区域的时间间隔约为 12h，采取循环同化的优点在于，若前一次 6h 的同化窗口内没有识别到卫星数据，可以在下一个 6h 的同化窗口中进行识别，从而在一定程度上保证模拟同化时间段内只有很少的卫星资料没有识别，提高卫星资料的利用率和卫星数据的同化效果。综上所述，本文采用 GSI-Dvar 三维变分同化，同化方法采用 6h 间隔资料循环同化。</p><h4 id="本章小节-2">本章小节</h4><p>  本章对 1999-2018 年台风样本数据的选取理由及结果进行了介绍，并说明了风场初始再分析资料获取的来源。此外，还对算例模拟方案三大部分的设置过程进行了详细说明，一是模型计算区域、网格划分非确定理由和结果；二是耦合模式中各模型计算方案的确定理由和结果；三是同化方案的确定理由和结果。</p><h3 id="div-align-center-台风过程的风场模拟-div"><div align=center>台风过程的风场模拟</div></h3><h4 id="台风风场特征">台风风场特征</h4><p>  上层海洋对台风的响应主要受制于风应力，风场强迫使上层海洋产生波浪与海流，改变海水温度分布，台风风场是影响台风过程上层海洋状态的主要因素。关于耦合同化模拟得到的风场过程，请移步原文。</p><h4 id="台风路径和风场强度">台风路径和风场强度</h4><p>  对台风风场数值模拟的结果除了风场特征分析外，还需要通过与实测资料的对比验证分析模拟误差，本文的实测验证数据采用 <a target="_blank" rel="noopener" href="https://tcdata.typhoon.org.cn/zjljsjj.html">CMA-STI 西北太平洋热带气旋最佳路径数据集</a>，该数据集是研究影响我国海域台风常用的数据校对资料。其数据基础建立在全国各级气象站每年在热带气旋过后所收集到的常规和非常规气象观测资料上，由中央气象局委托，上海台风研究所主导，对每年的热带气旋的强度和路径资料进行分析、汇总、编制，形成台风年鉴数据集。CMA-STI 数据集提供自1949年开始的，发生在西北太平洋海域的热态气旋数据，数据内容包括台风强度等级、台风中心经纬度坐标、台风中心最低气压、台风中心最大风速等信息。具体由 W-F-S-A 耦合同化模式模拟得到的南海海域10场台风的路径、最大风速结果与相应时刻的 CMA-STI 数据集的对比分析图，请移步原文。</p><p>  对于台风路径模拟，大部分台风的平均模拟误差均在 35km 一下，从单台风的路径模拟结果来看，模拟误差最大的为 201329 号台风“罗莎”，模拟平均误差为 42km，通过改变地形、物理参数重新模拟并未得到明显改善，可能是初始的 FNL 再分析资料本身存在的系统误差导致。路径模拟误差最小的为 201409 号台风“威马逊”，模拟平均误差为 18.9km。值得注意的是，对于路径变化比较“曲折”的台风，即路径中有较多幅度大的拐点，甚至存在“蝴蝶结”型的路径，对于这些台风，W-F-S-A 耦合同化模式也能较好地刻画出台风移动的路径。</p><p>  对于台风中心附近最大风速模拟结果与 CMA-STI 数据对比，可以看出，模拟结果与数据集在台风风速变化趋势方面保持一致，大部分台风强度均为先增强后减弱的变化过程。从台风强度对比图中还可以看出，模拟初始时刻的台风风速结果往往较弱，低于 CMA-STI 数据集结果，其原因主要是 WRF 计算模式对于初始场的模拟结果不够理想，通过耦合-同化已经得到了相应的改善，但与实际情况相比仍存在 15m/s 左右的误差，但是本文已经采取扩大模拟时间的方式，在最大范围内保证模拟初始时刻不发生在研究区域附近，排除初始场误差。排除初始阶段的模拟结果，大部分台风的风速模拟误差均在 8m/s 以下，从当场台风的强度模拟结果来看，模拟误差最大的为 200521 号台风“启德”，平均误差为 10.2m/s；模拟误差最小的为 201409 号台风“威马逊”，平均误差为 1.5m/s，基本与 CMA-STI 数据集一致。</p><p>  综上所述，由 W-F-S-A 耦合同化模式模拟得到的 70 场台风的路径、强度结果与 CMA-STI 数据集的误差在合理范围内，模拟结果可作为后续推算设计要素的数据依据。</p><h4 id="耦合-同化效果分析">耦合-同化效果分析</h4><p>  关于作者所采用的 W-F-S-A 耦合同化模式与纯 WRF 模式的差异分析，请移步原文。综合分析可得，作者采用的 W-F-S-A 耦合同化模式，无论在台风路径的模拟还是台风风速强度的模拟均优于 WRF 模式。</p><h4 id="最大风速计算结果">最大风速计算结果</h4><h5 id="测点的选择">测点的选择</h5><p>  本文的研究区域为海南岛附近海域，所以选取海南岛岸线 30m 等深线上的八个点作为研究测点，如图 6 所示，测点经纬度数据见表 2。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-05-11-32-19.png'/><font size=2; color=natural>图 6. 测点位置图</font></div><p><font size=2; color=natural>表 2. 测点经纬度坐标</font></p><table align = center>    <tr>        <th width=200px;>测点编号</th>        <th width=200px>经度（ $^ \circ E$ ）</th>        <th width=200px>纬度（ $^ \circ N$ ）</th>    </tr>    <tr>        <td>1</td>        <td>109.02</td>        <td>20.03</td>    </tr>    <tr>        <td>2</td>        <td>108.33</td>        <td>19.04</td>    </tr>    <tr>        <td>3</td>        <td>108.80</td>        <td>18.26</td>    </tr>    <tr>        <td>4</td>        <td>109.84</td>        <td>18.32</td>    </tr>    <tr>        <td>5</td>        <td>110.30</td>        <td>18.60</td>    </tr>    <tr>        <td>6</td>        <td>110.72</td>        <td>19.24</td>    </tr>    <tr>        <td>7</td>        <td>110.87</td>        <td>20.09</td>    </tr>    <tr>        <td>8</td>        <td>110.36</td>        <td>20.14</td>    </tr></table><h5 id="研究风向的确定及最大风速的计算结果">研究风向的确定及最大风速的计算结果</h5><p>  对 70 场热带气旋的风向计算结果进行处理。按 N、NE、E、SE、S、SW、W、NW 进行8个方向的划分，统计所有热带气旋计算结果在各测点的风的频率结果。从而确定8个测点的研究风向。统计结果见表 3，研究风向确定结果见表 4，70场热带气旋的最大风速结果请移步原文附录 A。</p><p><font size=2; color=natural>表 3. 台风期间风向分布统计表</font></p><table align = center>    <tr>        <th width=100px></th>        <th width=100px>N</th>        <th width=100px>NE</th>        <th width=100px>E</th>        <th width=100px>SE</th>        <th width=100px>S</th>        <th width=100px>SW</th>        <th width=100px>W</th>    </tr>    <tr>        <td>1号测点</td>        <td>11%</td>        <td>41%</td>        <td>10%</td>        <td>10%</td>        <td>9%</td>        <td>4%</td>        <td>6%</td>    </tr>    <tr>        <td>2号测点</td>        <td>12%</td>        <td>14%</td>        <td>8%</td>        <td>11%</td>        <td>10%</td>        <td>5%</td>        <td>9%</td>    </tr>    <tr>        <td>3号测点</td>        <td>41%</td>        <td>11%</td>        <td>5%</td>        <td>4%</td>        <td>9%</td>        <td>12%</td>        <td>10%</td>    </tr>    <tr>        <td>4号测点</td>        <td>13%</td>        <td>32%</td>        <td>10%</td>        <td>7%</td>        <td>9%</td>        <td>9%</td>        <td>9%</td>    </tr>    <tr>        <td>5号测点</td>        <td>11%</td>        <td>33%</td>        <td>12%</td>        <td>8%</td>        <td>9%</td>        <td>8%</td>        <td>9%</td>    </tr>    <tr>        <td>6号测点</td>        <td>14%</td>        <td>34%</td>        <td>13%</td>        <td>9%</td>        <td>8%</td>        <td>7%</td>        <td>7%</td>    </tr>    <tr>        <td>7号测点</td>        <td>13%</td>        <td>37%</td>        <td>15%</td>        <td>9%</td>        <td>8%</td>        <td>5%</td>        <td>5%</td>    </tr>    <tr>        <td>8号测点</td>        <td>9%</td>        <td>46%</td>        <td>10%</td>        <td>9%</td>        <td>9%</td>        <td>5%</td>        <td>5%</td>    </tr></table><p><font size=2; color=natural>表 4. 8个测点研究风向的确定</font></p><table align = center>    <tr>        <th width=150px;>测点</th>        <th width=150px>方向</th>        <th width=150px>测点</th>        <th width=150px>方向</th>    </tr>    <tr>        <td>1号测点</td>        <td>NE</td>        <td>5号测点</td>        <td>NE</td>    </tr>    <tr>        <td>2号测点</td>        <td>NW</td>        <td>6号测点</td>        <td>NE</td>    </tr>    <tr>        <td>3号测点</td>        <td>N</td>        <td>7号测点</td>        <td>NE</td>    </tr>    <tr>        <td>4号测点</td>        <td>NE</td>        <td>8号测点</td>        <td>NE</td>    </tr></table><h4 id="本章小节-3">本章小节</h4><p>  本章对 1999-2018 年间影响海南岛附近海域的 70 场台风热带气旋，采用 W-F-S-A 耦合同化模式进行模拟。对 2014 年 15 号台风“海鸥”的风场特征进行了分析，模拟结果与前人的研究相符。将模拟得到的台风路径和风场强度与 CMA-STI 西北太平洋热带气旋数据集进行对比验证，验证结果说明模拟得到的 70 场热带气旋风场结果较合理，可以作为后续推算设计要素的数据依据。本章还通过对不同模拟方式模拟结果的比较论证了 W-F-S-A 耦合同化模式的最优性。通过对所有 70 场风速、风向结果的数据处理，确定了 8 个测点的研究风向，统计出 70 场热带气旋的最大风速结果。</p><h3 id="div-align-center-台风过程的流场和温度场模拟-div"><div align=center>台风过程的流场和温度场模拟</div></h3><h4 id="台风过程的表面流场特征">台风过程的表面流场特征</h4><p>  在台风旋转风场的作用下，台风路径附近海域会形成旋转流场。台风下的流程具有以下特征：1. 流场具有旋转性，流场中心位于台风移动方向的左后方，流场围绕旋转中心逆时针转动；2. 从流场等值线图中可以看出流场沿台风移动方向呈现明显的带状分布，且大流速区基本位于台风路径的右侧，并且各时刻的最大流速也基本出现在台风移动方向的右后方，因此台风下的流场具有明显的右偏性。</p><h4 id="台风过程的海表温度场特征">台风过程的海表温度场特征</h4><p>  台风经过海面时，在强风应力的影响下，海洋上下层发生强烈垂直混合，深层冷水上涌到混合层，导致海表温度显著下降。通过模拟实验说明了 W-F-S-A 耦合同化模式相较于 WRF 模式，能较好地反映出台风过境时海表温度下降的现象（具体模拟实验过程请移步原文），与实际情况更相符，说明了采用耦合模式的优越性。</p><p>  综上所述，台风过程温度场的特征为：1. 低温区场沿台风移动方向呈现明显的带状分布，且低温中心基本位于台风路径的右侧，并且 SST 下降幅度较大的区域也会发生在台风路径右侧的海域，因此台风下的温度场具有明显的右偏性；2. 模拟 66h 时降温范围仍较大，说明温度场的变化较台风风场的移动有一定的延迟性，降温会持续较长时间。</p><h4 id="模拟海表温度与-OISST-V2-0-卫星数据的对比">模拟海表温度与 OISST V2.0 卫星数据的对比</h4><p>  本文选择美国国家海洋和大气管理局（NOAA）的 OISST V2.0 海表温度卫星数据进行验证。空间分辨率为 $0.25^\circ \times 0.25^\circ$，该产品中的 AMSR + AVHRR 数据是通过 AMSR 微波反演得到的，适用于台风过程的温度验证。选取 UTC2014-07-17_06:00:00（模拟 24h），UTC2014-07-18_01:00:00（模拟 43h）两个时刻进行验证，结果如图 7 所示。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-05-14-52-20.png'/><font size=2; color=natural>图 7. 台风“威马逊”海表温度模拟值与 OISST V2.0 卫星数据对比结果</font></div><p>  可以看出，模拟结果与卫星数据吻合较好，趋势一致，说明了 W-F-S-A 耦合同行模式的合理性。同时，从时间对比上看，模拟 43h 时台风发展已经较为强烈，整体温度明显低于 24h，印证了台风过程中海表温度降低的现象；从空间对比上看，模拟 43h 时台风中心在北纬 $18.4^\circ$ 附近，可以看出此处 SST 明显低于周围。</p><h4 id="本章小结">本章小结</h4><p>  本章首先对 201409 号台风“威马逊”的流场特征、温度场特征进行了分析，说明了 W-F-S-A 耦合同化模式能较好地反映出台风过境时海表温度下降的现象。并将 W-F-S-A 耦合同行模式模拟得到的 SST 结果与 OISST V2.0 卫星数据进行验证，吻合程度较好。</p><h3 id="div-align-center-台风过程的波浪场模拟-div"><div align=center>台风过程的波浪场模拟</div></h3><h4 id="台风过程波浪场特征">台风过程波浪场特征</h4><p>  台风过境海域时，最明显最剧烈的现象之一就是海表面产生的大浪，据前人研究成果，在台风风场作用下，台风路径附近海域会形成风场驱动下的波浪场。</p><p>  本文以 201117号台风“纳莎”为例，说明台风作用下的波浪场特征。感兴趣者请移步原文</p><p>  由有效波高等值线的分析可得出，台风下的波浪场有以下特征：1. 波浪场中心为小浪区，中心四周波浪较大；2. 波浪场中心位于台风中心左后方，可见波浪对台风的响应作用有一定的延迟；3. 在台风登陆前，波浪场的大浪区基本位于台风路径的右侧，并且各时刻有效波高最大值也基本出现在台风移动方向的右前方，因此台风下的波浪场具有明显的右偏性。</p><h4 id="模拟结果与卫星高度计资料的对比">模拟结果与卫星高度计资料的对比</h4><h5 id="卫星高度计资料的选取">卫星高度计资料的选取</h5><p>  对台风过程波浪场数值模拟的结果除了分析波浪场特征外，还需要通过与实测资料的对比验证分析模拟误差，本文实测验证数据采用 AVISO 发布的 <a target="_blank" rel="noopener" href="https://aviso-data-center.cnes.fr/">OSTM/Jason-2 卫星高度计数据</a>。Jason-2卫星有三种数据类型，分别为 OGDR、IGDR、GDR，其中 GDR 数据有三种格式的数据，本文采用最复杂的 S-GDR 数据集，其为专业的传感器产品，包括了所有的雷达回波信息。</p><p>  Jason-2 卫星的扫描轨迹是具有周期性的，经过绘图发现，第 153 条扫描轨迹恰好经过南海，卫星地面轨迹如图 8 所示。值得注意的是，Jason-2 卫星是按照一定的时间间隔经过南海上空，因此其经过南海时不一定有台风发生，换言之，不能保证每一场台风过程下的波浪场都有相应的卫星数据进行验证，从另一个方面来说，70 场台风采用的地形参数、物理参数、耦合参数、同化方案都是一致的，因此采取抽样调查的思路，只需要验证一定数量的波高模拟结果，就可以基本说明所有模拟结果的合理性。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-05-16-36-52.png'/><font size=2; color=natural>图 8. Jason-2 卫星经过南海上空轨迹</font></div><h5 id="验证-对照实验的设置和结果">验证-对照实验的设置和结果</h5><p>  关于本文采用的 W-F-S-A 耦合同化模型与 WRF 模型的实验对比与分析，请移步原文。</p><p>  综合原文试验分析，说明 W-F-S-A 耦合同化模式模拟得到的波高结果是合理的，可以作为后续波浪要素推算的数据基础。此外，通过与纯 WRF 模式的对照，反映了耦合同化模式建立海表面粗糙度与波浪参数的关系的合理性，说明了耦合同化模式在模拟台风过程波浪场方面较 WRF 驱动 SWAN 模式更优，能反映出台风过程中海表面粗糙度的变化，更接近实际情况。</p><h4 id="研究波向的确定及有效波高、平均周期的计算结果">研究波向的确定及有效波高、平均周期的计算结果</h4><p>  对70场热带气旋的波向计算结果进行处理，按 N、NE、E、SE、S、SW、W、NW 进行 8 个方向划分，统计所有计算结果在各测点的波向频率结果，从而确定 8 个测点的研究波向。统计结果见表 5，研究波向确定结果见表 6，70场热带气旋的有效波高结果请移步原文，参见附录B。</p><p><font size=2; color=natural>表 5. 台风期间波向分布统计表</font></p><table align = center>    <tr>        <th width=100px></th>        <th width=100px>N</th>        <th width=100px>NE</th>        <th width=100px>E</th>        <th width=100px>SE</th>        <th width=100px>S</th>        <th width=100px>SW</th>        <th width=100px>W</th>    </tr>    <tr>        <td>1号测点</td>        <td>16%</td>        <td>39%</td>        <td>13%</td>        <td>6%</td>        <td>8%</td>        <td>4%</td>        <td>7%</td>    </tr>    <tr>        <td>2号测点</td>        <td>39%</td>        <td>11%</td>        <td>9%</td>        <td>5%</td>        <td>14%</td>        <td>7%</td>        <td>7%</td>    </tr>    <tr>        <td>3号测点</td>        <td>9%</td>        <td>9%</td>        <td>14%</td>        <td>30%</td>        <td>12%</td>        <td>12%</td>        <td>6%</td>    </tr>    <tr>        <td>4号测点</td>        <td>4%</td>        <td>16%</td>        <td>40%</td>        <td>12%</td>        <td>14%</td>        <td>7%</td>        <td>3%</td>    </tr>    <tr>        <td>5号测点</td>        <td>9%</td>        <td>43%</td>        <td>14%</td>        <td>13%</td>        <td>11%</td>        <td>5%</td>        <td>3%</td>    </tr>    <tr>        <td>6号测点</td>        <td>5%</td>        <td>46%</td>        <td>10%</td>        <td>18%</td>        <td>15%</td>        <td>3%</td>        <td>2%</td>    </tr>    <tr>        <td>7号测点</td>        <td>9%</td>        <td>48%</td>        <td>19%</td>        <td>10%</td>        <td>4%</td>        <td>2%</td>        <td>3%</td>    </tr>    <tr>        <td>8号测点</td>        <td>12%</td>        <td>54%</td>        <td>15%</td>        <td>4%</td>        <td>3%</td>        <td>3%</td>        <td>5%</td>    </tr></table><p><font size=2; color=natural>表 6. 8个测点研究波向的确定</font></p><table align = center>    <tr>        <th width=150px;>测点</th>        <th width=150px>方向</th>        <th width=150px>测点</th>        <th width=150px>方向</th>    </tr>    <tr>        <td>1号测点</td>        <td>NE</td>        <td>5号测点</td>        <td>NE</td>    </tr>    <tr>        <td>2号测点</td>        <td>N</td>        <td>6号测点</td>        <td>NE</td>    </tr>    <tr>        <td>3号测点</td>        <td>SE</td>        <td>7号测点</td>        <td>NE</td>    </tr>    <tr>        <td>4号测点</td>        <td>E</td>        <td>8号测点</td>        <td>NE</td>    </tr></table><h4 id="本章小结-2">本章小结</h4><p>  本章首先对 201117 号台风“纳莎”的波浪场特征进行了分析，并将 W-F-S-A 耦合同行模式模拟得到的波高结果与 Jason-2 卫星高度计数据进行验证，吻合程度较好。同时设置了 6 组耦合同化模式与 WRF 驱动 SWAN 模式的对照试验，说明了耦合同化模式较单一模式更能反映出台风过程中海表面粗糙度的变化，与实际情况更相符。最后对所有的有效波高、平均周期、波向结果进行数据处理，确定了 8 个测点的研究波向，统计出 70 场 热带气旋过程中的最大有效波高结果、最大平均周期结果。</p><h3 id="div-align-center-不同重现期设计要素推算-div"><div align=center>不同重现期设计要素推算</div></h3><h4 id="极值推算方法">极值推算方法</h4><h5 id="年最大值分析法">年最大值分析法</h5><p>  目前不同重现期设计要素的推算普遍采用年最大值分析法，就是对所分析要素按照每年的最大值取值，得到一组年最大值序列，再选配一条合适的理论频率曲线，外延推求多年一遇设计波高。应用于水文频率统计的概率分布函数主要有皮尔逊 III 型分布、对数正态分布、耿贝尔第一型极值分布和威布尔分布等。</p><p><strong>皮尔逊 III 型分布</strong></p><p>  皮尔逊 III 型分布曲线（P-III 型分布曲线）是我国《港口与航道水文规范》（JTS145-2015）中推荐的波高分布曲线，国内经验表面，它对于年最大值有效波高及其对应的平均周期的理论频率曲线拟合较好，年最大风速和河流的洪水频率的分析中通常也采用此种线型。对 P-III 型概率分布参数的取值，在水文频率计算中是十分重要的，因此，很多研究者一直致力于此方面的研究。目前，常用的参数估计方法主要有权函数法、极大似然法、适线法、概率权重矩法、线性矩法及常规矩法等。</p><p><strong>耿贝尔分布</strong></p><p>  耿贝尔分布（Gumbel 分布）对水文气象极值计算有较大的适用性，只要随机变量的原始分布属于正态分布或 $\Gamma$ 分布等指数分布族，其极值分布就渐进于 Gumbel 分布。</p><p>  本文对于不同重现期风速、不同重现期波浪平均周期额推算均采用年最大值分析法，其中对于不同重现期风速的概率分布函数选用 P-III 型分布，对于不同重现期波浪平均周期的概率分布函数选用 Gumbel 第一型极值分布。得到样本数据后进行初步分析处理，对于某个测点的设计要素系列，将设计要素按从大到小的次序排列，排序编号记为 $m$，再将 $m$ 代入式 22 计算其经验累积频率 $P$。</p><p>$$<br>P = \frac{m}{n+1} \times 100%<br>\tag{22}<br>$$</p><p>公式 23 拟推算设计要素的均值 $\bar{X}$。公式 24 计算波高的均方差 $S$。</p><p>$$<br>\bar{X} = \frac{1}{n}\sum^n_{i=1}X_i<br>\tag{23}<br>$$</p><p>$$<br>s = \sqrt{\frac{1}{n}\sum^n_{i=1} X_i^2 - (\frac{1}{n}\sum^n_{i=1} X_i)^2}<br>\tag{24}<br>$$</p><h5 id="泊松-耿贝尔复合极值分布">泊松-耿贝尔复合极值分布</h5><p>  泊松-耿贝尔复合极值分布是由马逢时等提出的一种利用极值分布理论（Gumbel 分布）推算海洋工程中设计波高的新方法。该方法的原理是，首先根据台风统计资料，经过分析得出影响某一个海域的台风发生频次极好的符合泊松（Poisson）分布；然后检验每次台风影响下形成的波高，得到波高分布在鲍威尔几率格纸上呈现直线关系，说明台风波浪波高原始分布符合耿贝尔（Gumbel）分布，由此形成了泊松-耿贝尔复合极值分布。《港口与航道水文规范》（JTS145-2015）中规定，对于台风多发海域，某一波向一年中出现一个以上较大台风波高时，可按台风波高的最大值系列取样，采用泊松-耿贝尔复合极值分布确定不同重现期的设计波高。因此，本文对于不同重现期波高的推算采用泊松-耿贝尔复合极值分布。</p><p>  对于某一海域，假设台风每年在其附近经过并产生影响的次数为 $n$ 次，显然 $n$ 是一个随机变量它的分布函数应该符合某种离散型分布，$n$ 的取值范围为 $0~k$ 之间的整数，其相应概率为 $P_K$。每年每次台风在该海域形成的最大波高记为 $\zeta_i$，$i = 1 ~ n$。每年 $n$ 场台风浪中有一个极大值记为 $\zeta_n = \underset{1 \leq i \leq n}{max} {\zeta_i}$，设 $\zeta_i$ 的原始分布函数为 $G(x)$。当台风出现次数为 $n$ 时概率分布函数为 $P_K$ 的情况下，台风波浪的年极值 $\zeta_n$ 的分布函数 $F(x)$。根据概率的加法和乘法定理，$F(x)$ 可写为：</p><p>$$<br>F(x) = P \{\zeta &lt; x \} = \sum_{k=0}^{\infty} P \{\zeta &lt; x, n=k \} \\<br>=\sum_{k=0}^{\infty} P \{\zeta &lt; x|_{n=k} \} P \{n=k \} \\<br>=\sum_{k=0}^{\infty} P \{max[\zeta_i] &lt; x \} \cdot P_k \\<br>=\sum_{k=0}^{\infty} P_k \cdot [G(x)]^k<br>$$</p><p>  由上式可见 $F(x)$ 是由 $n$ 的概率分布与 $\zeta$ 的概率分布两种分布所构成，所以称为复合极值分布。</p><p>  经过我国沿海一些台风观测站的检验，每年台风出现的次数 $n$ 符合泊松（Poisson）分布，即</p><p>$$<br>P_k = e^{-\lambda} \frac{\lambda^k}{k!}<br>\tag{26}<br>$$</p><p>式中：$\lambda$ 为每年台风出现的平均次数，可按下式计算</p><p>$$<br>\lambda = 台风影响本海域总次数 / 总年数<br>$$</p><p>  而台风波浪的经验累积频率点在鲍威尔概率格纸上近似成一条直线分布，说明台风波浪的分布耿贝尔分布，即：</p><p>$$<br>G(x) = e^ {-e^ {-x}} = exp \{-exp[-\alpha(H-u)] \}<br>\tag{27}<br>$$</p><p>式中：$\alpha$ 和 $u$ 为耿贝尔分布的两个参数，于是：</p><p>$$<br>F(x) = \sum_{k=0}^{\infty} e ^{-\lambda} \frac{\lambda^k}{k!} [G(x)]^k = e^{-\lambda[1-G(x)]} = 1 - P<br>\tag{28}<br>$$</p><p>式中：$P$ 为超值累积频率，即重现期的倒数。</p><p>  将 $G(x)$ 的表达式代入上式得</p><p>$$<br>1 - Px_p = - ln \{-ln[1+\frac{ln(1-p)}{\lambda}] \} = \alpha(H_P - u)<br>\tag{29}<br>$$</p><p>$\alpha$ 与 $u$ 可通过全部台风波浪最大波高组成的系列的均值 $\bar{H}$ 及均方差 $S$ 计算，或用最小二乘法求解，它们与 $\bar{H}$ 及 $S$ 的关系为：</p><p>$$<br>\alpha = \sigma_n / S \\<br>u = \bar{H} - \frac{y_n}{\alpha}<br>\tag{30}<br>$$</p><p>式中：$y_n$ 与 $\sigma_n$ 为仅与 $n$ 有关的参数。</p><p>  于是台风影响下，多年一遇的设计波高可按下式计算：</p><p>$$<br>H_P = u + \frac{x_p}{\alpha} = -ln \{-ln[1 + \frac{ln(1-p)}{\lambda}] \} \cdot \frac{1}{\alpha} + u<br>\tag{31}<br>$$</p><p>  设 $N$ 年共出现 $n$ 次台风，并将 $\alpha$ 与 $u$ 的表达式代入，可得：</p><p>$$<br>H_P = \bar{H} + \beta S<br>\tag{32}<br>$$</p><p>式中：</p><p>$$<br>\beta = -\frac{1}{\sigma_n} \{y_n + ln[-ln(1 + \frac{N ln(1-p)}{n})]\}<br>\tag{33}<br>$$</p><h4 id="传统方法对于不同重现期设计要素的推算">传统方法对于不同重现期设计要素的推算</h4><h5 id="不同重现期风速的推算结果">不同重现期风速的推算结果</h5><p>  对 W-F-S-A 耦合同化模式模拟得到的最大风速样本数据进行初步分析，将年最大风速从大到小进行排列，若某年发生的所有的热带气旋在某测点的最大风速模拟值均小于 $5m/s$，则认为该年份热带气旋对该测点的影响较小，不列入年最大风速序列。1-8 号测点的年最大风速序列表请移步原文。</p><p>  不同重现期最大风速的推算采用的是P-III型分布，1~8 号测点的拟合曲线结果图请移步原文。8个测点重现期为 50年、20年、10年和 5年的风速推算结果请移步原文。</p><h5 id="不同重现期波高的推算结果">不同重现期波高的推算结果</h5><p>  具体请移步原文</p><h5 id="不同重现期波浪平均周期的推算结果">不同重现期波浪平均周期的推算结果</h5><p>  具体请移步原文</p><h4 id="风浪联合分布">风浪联合分布</h4><h5 id="联合概率方法简介">联合概率方法简介</h5><p>  在台风过程中，需要推算的设计要素由最大风速、最大波高，水文频率分析的传统方法就是按照各要素的样本序列分别取值进行推算，各要素间是独立的。但实际情况是，最大风速、最大波高这两者一般不会出现在同一时刻，并且他们的组合形式是多样的，组合规律是复杂的。因此传统方法没有很好地体现出最大风速、最大波高这两者之间的关系，本文采用风-浪联合概率分布改善这一缺点。</p><p>  联合概率分析方法取其中一种要素（如波高）达到最大值时与其同一时间出现的其他各要素（如风速等）的计算值，共同分别作为统计样本，如此一来，实现了最大风速、最大波高出现在同一时刻，然后将联合分布的样本按照各要素分别取最大值序列，采用相应的频率分析方法进行不同重现期设计要素的推算，拟合出各设计要素的频率分布曲线。这样就可以推算出不同重现期的分别以风速为主或以波高为主的各种极端设计要素组合情况。然后在结构设计时，选择对结构产生最大作用效应的组合作为环境极端条件。本文以有效波高为主要作用，推算在有效波高达到最大值时的联合分布频率，以此为例来分析联合分布与传统方法的区别。最大风速的理论频率曲线的选取和参数计算同传统方法。</p><h5 id="联合分布样本数据">联合分布样本数据</h5><p>  对 W-F-S-A 耦合同化模式模拟得到的风速和波高样本数据处理，对最大波高时刻对应的风速进行取值，得到的联合分布样本数据，请移步原文附录 D。</p><h5 id="不同重现期风速的联合分布推算结果">不同重现期风速的联合分布推算结果</h5><p>  不同重现期最大风速的联合分布推算采用的是 P-III 型分布，1~8 号测点的拟合曲线结果，请移步原文附录 E。</p><p>  8个测点重现期为 50年、20年、10年和 5年的风速推算结果见表 7。</p><p><font size=2; color=natural>表 7. 各测点不同重现期风速联合分布推算结果 $(m/s)$</font></p><table>    <tr>        <th width=100px>测点</th>        <th width=100px>方向</th>        <th width=100px>50年（V2%）</th>        <th width=100px>20年（V5%）</th>        <th width=100px>10年（V10%）</th>        <th width=100px>5年（V20%）</th>    </tr>    <tr>        <td>1号测点</td>        <td>NE</td>        <td>38.11</td>        <td>34.70</td>        <td>30.72</td>        <td>26.90</td>    </tr>    <tr>        <td>2号测点</td>        <td>NW</td>        <td>20.23</td>        <td>18.55</td>        <td>16.95</td>        <td>14.80</td>    </tr>    <tr>        <td>3号测点</td>        <td>N</td>        <td>38.00</td>        <td>32.10</td>        <td>27.60</td>        <td>21.20</td>    </tr>    <tr>        <td>4号测点</td>        <td>NE</td>        <td>53.83</td>        <td>46.93</td>        <td>41.18</td>        <td>34.70</td>    </tr>    <tr>        <td>5号测点</td>        <td>NE</td>        <td>50.40</td>        <td>43.91</td>        <td>38.53</td>        <td>32.18</td>    </tr>    <tr>        <td>6号测点</td>        <td>NE</td>        <td>41.23</td>        <td>36.99</td>        <td>33.36</td>        <td>28.14</td>    </tr>    <tr>        <td>7号测点</td>        <td>NE</td>        <td>46.42</td>        <td>41.26</td>        <td>36.52</td>        <td>32.34</td>    </tr>    <tr>        <td>8号测点</td>        <td>NE</td>        <td>43.43</td>        <td>39.41</td>        <td>35.84</td>        <td>31.52</td>    </tr></table><h4 id="联合分布与传统方法的比较">联合分布与传统方法的比较</h4><p>  为了更好地说明联合分布与传统方法在推算设计要素方面的区别，将两者的计算结果进行比较。本文所采用的联合分布概率方法，选取有效波高为主要作用，因此波高的联合分布样本数据与传统方法的样本数据一致，其推算结果也一致。而最大风速的联合分布样本数据与传统方法的不同，风速推算的对比结果，请移步原文。</p><p>  对比分析可得，传统的频率分析方法推算的设计要素较联合分布要大，是偏于保守的。此外，联合分布的方法以有效波高作为主要作用，其设计要素中的最大风速是与有效波高同时发生的，更加符合实际情况，在保证设计安全的情况下降低了工程的造价。</p><h4 id="本章小结-3">本章小结</h4><p>  本章分别采用传统方法和联合分布对不同重现期的风速、有效波高、平均周期进行了推算。其中对于不同重现期风速、波浪平均周期的推算采用年最大值法，对于不同重现期风速的概率分布函数采用 P-III 型分布，对于波浪平均周期的概率分布函数选用耿贝尔第一型极值分布。对于不同重现期波高的推算采用泊松-耿贝尔复合极值分布。</p><p>  联合分布采用以有效波高为主要作用，推算在有效波高达到最大值时的风速的联合分布频率，并与传统方法进行对比，结果表明联合分布的推算结果较传统方法的设计标准均有所降低，说明传统方法偏于保守，联合分布更加符合实际海况，在保证设计安全的情况下降低了工程的造价。</p><h3 id="div-align-center-结论和建议-div"><div align=center>结论和建议</div></h3><h4 id="结论">结论</h4><p>  本文主要结论，不在此赘述，请移步原文</p><h4 id="建议">建议</h4><p>  大气-海洋-海浪的数值模拟是一个复杂的过程，由于时间限制，本文有些问题未进行考虑，在现有工作的基础上，以后可以进一步深入研究，本文提出一下几点建议，主要包括：</p><ol><li class="lvl-3"><p>本文建立的大气-海洋-海浪耦合同化模式中，WRF 采用结构化网格，FVCOM 海洋模式和 SWAN 海浪模式采用了相同的非结构化网格，在 WRF 模式和其他两种模式传递数据的过程中需要进行插值，本文未考虑插值过程数值误差问题，后续需进一步研究。</p></li><li class="lvl-3"><p>本文波浪场外海边界波浪要素由更大的 SWAN 模式计算所得，SWAN 模式在深海计算结果可能逊于 WAVEWATCH，后续考虑采用 WAVEWATCH 模拟波浪场。</p></li><li class="lvl-3"><p>本文采用 泊松-耿贝尔复合极值分布，推算不同重现期的有效波高时，对于特大值的处理不够完善，导致部分特大值与曲线有一定的偏离，后续可以采用水文频率分析中对于特大值的处理方法进行调整。</p></li><li class="lvl-3"><p>本文的数据集采集方面注重了风、浪的同步性，但在进行联合分布时，若能够将多元极值理论应用进来，将达到真正的联合分布。</p></li><li class="lvl-3"><p>由于时间所限，本文处理了 20 年的风场资料进行重现期推算，严格意义上无法推算 100 年重现期的设计要素，后续可以增加风场资料至30年的数据，可以推算 100 年重现期，使结果更加完善。</p></li></ol><br><font size=2; color=grey>[1]. 毛卿任. 台风过程的大气-海洋-海浪耦合与卫星数据同化模拟[D].天津大学,2019. <br></font>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>菜就是菜</title>
      <link href="/posts/20230926135659/"/>
      <url>/posts/20230926135659/</url>
      
        <content type="html"><![CDATA[<h2 id="基于ML的台风预测">基于ML的台风预测</h2><h3 id="div-align-center-摘要-div"><div align=center>摘要</div></h3><p>  台风是一种极端天气事件，每年夏季会对沿海地区城市经济造成重大损失，预测台风的形成和强度对台风灾害的预警至关重要。传统的基于热动力方程的数值预报方法和基于经验关系的统计预报方法现如今仍难以准确地预测台风强度。此外，一些研究虽然也尝试用机器学习方法进行预测来提高准确率，但通常没有考虑台风相关变量之间的时空关系。本文提出了一种基于深度学习的台风时空深度混合预测模型，可以弥补现有方法的不足之处。本文模型引入了三维卷积神经网络（3DCNN）和二位卷积神经网络（2DCNN）来学习台风相关大气海洋变量之间的空间关系，利用 LSTM 来学习台风变化过程中的时序关系。针对西太平洋（WP）、东太平洋（EP）、北大西洋（NA）三个海域的大量台风形成与强度预测实验表明，本文模型优于现有官方组织使用的诸多数值预报方法、统计预报方法和机器学习方法。台风 24h 形成预测实验中，本文模型能达到的最高准确率为 85.2%，Auc 值为 92.2%，24h 强度预测实验中，最小误差为 7.4kt（1kt = 0.512 m/s）。并且在参数分析时发现，模型训练时的超参数如学习速率最好设置为 $10^{-4}$ 的量级，并在 25~35 个 epoch 后停止模型的训练。构造输入数据集时，台风中心周围经纬度区域范围最好确定在 $9^\circ \times 9^\circ$ ~ $13^\circ \times 13^\circ$ 内。且 LSTM 时间步确定为 2 时能获得最好的预测效果。</p><br><p><strong>关键词：台风；强度；预测；时空；深度学习；时空深度混合预测模型</strong></p><br><h3 id="div-align-center-绪论-div"><div align=center>绪论</div></h3><h4 id="研究背景及意义">研究背景及意义</h4><p>  热带气旋是由温暖海洋热能驱动的天气尺度风暴，含一个无云区的中心，中心上空有一个暖核，围绕中心的气流呈逆时针方向旋转。在这个涡旋中，最低气压出现在中心，最大风速出现在中心附近，通常会达到或超过 34kt（10.8m/s）。根据世界气象组织定义，在西北太平洋区域，当热带气旋中心附近最大风速达到 64kt（32.7m/s）时则称为台风。这样的涡旋在大西洋和东太平洋称之为飓风，在北印度洋称为强气旋性风暴。</p><p>  台风乃至热带气旋最常形成于 $5^\circ N$ 以北的西北太平洋热带洋面上，但全球除东南太平洋和南大西洋外各大洋区的其他热带海域也均有热带气旋发生和活动，其中以北大西洋、东太平洋、北印度洋最为频繁。图 1 为 1985 ~ 2005 间热带气旋的全球分布图。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-09-27-17-35-24.png'/><font size=2; color=natural>图 1. 1985-2005 年间热带气旋全球分布图（wikipedia）</font></div><p>  台风的宏观结构大致分为六部分，分别是台风眼、眼外云墙、外包区、外围区、流入层、流出层。其中最为显著的特征是台风眼，它位于涡旋之中，眼内为下沉气流，静风，无云，亦为晴空区。有的台风有两个眼，称为同心双眼，也有两眼并列的台风，但极为罕见。台风眼外的云墙，是由于强烈上升运动而造成的深厚积云对流，台风最强的强风和暴雨也出现于此。台风眼和眼壁称为内核区，内核区直径小的可为二三十千米，而大的可扩大至为上百千米。外包区紧挨着内核区，风速比内核区削弱，螺旋雨带的主体在此区中。外围区紧挨着外包区，水平尺度是外包区的几倍，风速在该区虽明显减弱，但破坏力依然很强。此外，台风在低气压阶段，四周的空气是向中心流入的，从而形成了流入层。随着热带气旋的增强，切向风增大，流入现象也会减弱。流出层位于台风的顶部，对流层顶之上。该层气流在北半球呈反气旋式向外流出，使台风中心气压急剧下降，从而使得台风开始加强。图 2 可以清晰地展现台风的结构。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2309271953.png'/><font size=2; color=natural>图 2. 台风结构图（wikipedia）</font></div><p>  本文中所定义的台风强度即为台风中心附近最大风速。根据我国气象局（China Meterological Administration，CMC）对于西北太平洋热带气旋强度的划分，热带气旋不同等级分别对应不同的名称，如表 1 所示。因此，严格意义上，无论是台风还是飓风，均是热带气旋的一种等级划分，本质上仍为热带气旋。本文把所有全球大洋强度大于 64kt 的热带气旋统称为“台风”，强度大于 34kt 的热带气旋称之为“热带风暴”。</p><p><font size=2; color=natural>表 1. 热带气旋等级划分及对应名称</font></p><table>    <tr>        <th width=300px;>热带气旋等级名称</th>        <th width=200px>强度</th>    </tr>    <tr>        <td>热带低压</td>        <td>17kt ~ 33kt</td>    </tr>    <tr>        <td>热带风暴</td>        <td>34kt ~ 63kt</td>    </tr>    <tr>        <td>台风</td>        <td>64kt ~ 84kt</td>    </tr>    <tr>        <td>强台风</td>        <td>84kt ~ 104kt</td>    </tr>    <tr>        <td>超强台风</td>        <td>$\geq$ 105kt</td>    </tr></table><p>  台风发生时，人们一般能直接感受到的是狂风暴雨，而其造成的恶劣灾害事件可分为直接灾害和间接灾害两种。</p><ol><li class="lvl-3"><p><strong>直接灾害：</strong> 主要是直接由台风带来的风灾和洪涝灾害；</p><blockquote><p><strong>台风导致的风灾：</strong></p><ul class="lvl-3"><li class="lvl-2">海上航行受阻、海上石油勘探和平台生产设施、船舶、码头装卸运输设施等受损；</li><li class="lvl-2">沿海渔业和海洋养殖业设置受损而停业；</li><li class="lvl-2">农作物、果树等经济作物受强风损毁而减产甚至绝收；</li><li class="lvl-2">城市建筑工程设施被摧毁、城市交通运输受阻，事故频发。</li></ul><p><strong>台风强降雨引发的灾害：</strong></p><ul class="lvl-3"><li class="lvl-2"><p>城市的严重积水；</p></li><li class="lvl-2"><p>交通运输受阻，城市经济活动和居民生活严重受影响；</p></li></ul><p><strong>累积雨量很大却无处排放的情况下所引发的大范围灾害：</strong></p><ul class="lvl-3"><li class="lvl-2"><p>大面积农田被淹没，导致农作物减产甚至绝收；</p></li><li class="lvl-2"><p>堤岸、路基、通信和输电网设施被冲毁，导致大面积停电；</p></li><li class="lvl-2"><p>房屋、禽畜被损毁或者浸坏，导致人畜伤亡，从而引发流行疾病和瘟疫。</p></li></ul></blockquote></li><li class="lvl-3"><p><strong>间接灾害：</strong> 主要是由暴雨间接引发的山体滑坡和泥石流等地质灾害，以及由大风引起的沿海风暴潮灾害；</p><blockquote><p><strong>泥石流：</strong> 是山谷中含有大量泥沙和石块的洪流，主要表现为突然爆发，浑浊的泥石流体会沿陡峻的山沟顺势流下，在宽阔的堆积区堆积，从而对山区人民财产的生命安全造成了严重的危害；</p><p><strong>山体滑坡：</strong> 是构成斜坡的岩土体在重力作用下失稳，沿着坡体内部的一个（或几个）松软脆弱面（带）发生剪切而产生整体性下滑的现象，是山区水库、铁路、公路、及依山而建的居民等建筑设施常遇到的一种地质灾害，主要表现为河道阻塞、公路阻断、公车毁坏等；</p><p><strong>风暴潮：</strong> 指极端天气作用下所引发的海面异常增高的现象，若同时处于天文潮的高潮阶段，将导致潮位快速升高。主要表现为: (1) 水位暴涨、堤岸决口、人畜伤亡；(2) 海水倒灌、地下水遭受入侵、水体和土壤盐度升高、植物生存受威胁。</p></blockquote></li></ol><blockquote><p><strong>风暴潮</strong> 和 <strong>天文潮</strong> 的区别</p><ol><li class="lvl-3"><strong>风暴潮（Storm Surge）：</strong><br>风暴潮是一种自然现象，通常与气象事件，如飓风、台风或强热带风暴相关联。当这些气象事件接近海岸线时，它们会引起强风，将海水推向沿海地区。这种海水的堆积可以导致水位迅速升高，甚至可能引发洪水，对沿海社区造成严重危害。风暴潮的高度取决于多个因素，包括风力、气压、海底地形和海岸线的形状。风暴潮是飓风或台风最危险的方面之一，因为它可以导致海水大量涌入内陆地区，造成严重的淹水情况。</li><li class="lvl-3"><strong>天文潮（Tidal Surge）：</strong><br>天文潮是由太阳、月球和地球之间的引力相互作用引起的潮汐现象。这些引力作用导致海水周期性地上升和下降，形成了潮汐。通常每天都会经历两次高潮和两次低潮。天文潮是可预测的，其发生时间和幅度取决于月球和太阳的位置以及地球的自转。潮汐对航海、渔业和沿海生态系统都具有重要影响。</li></ol><p>风暴潮是由气象事件引起的，不可预测且可能具有破坏性的海水涌浪现象，而天文潮是由天体引力引起的周期性潮汐现象，可以根据天文数据进行预测。两者都与海水的升降有关，但根本原因和影响不同。</p></blockquote><p>  上述所有的灾害中，台风风灾往往将与其他台风灾害同时出现，如狂风伴随着巨浪对船舶的损害、狂风激起风暴潮冲毁海塘、堤坝或者导致海水漫滩、狂风夹带暴雨引发的洪水灾害、暴雨情况下强风拔树可触发山体滑坡和泥石流灾害等次生地质灾害。因而，台风的风力强度和持续时间是致灾的重要气象因素之一。除此之外，灾害的发生以及灾情严重程度还取决于台风预警、预报的准确率，受灾体状况，包括与之密切相关的社会环境和经济发展水平，以及防台抗灾措施的及时性和有效性。对于气象领域的研究人员和业务人员来说，为了减轻台风灾害带来的损失，主要关注部分还是在于提供更为准确的台风预警、预报结果，为接下来的防灾减灾措施做指引。</p><p>  确定台风中心位置和强度是制作台风预报和发布台风预警的第一步，因为台风预报的质量依赖于台风初始定位和定强的精度。台风监测是指利用各种手段对台风移动过程中的物理现象以及气象要素进行观测。台风监测所获取的气象记录、资料是进行台风预警、科学研究和防灾减灾、决策服务的基础。目前对于台风监测主要包括：地面探测、高空探测、雷达观测、以及遥感探测等。在台风监测和预警的实际业务中，确定台风中心位置和强度的主要依据是气象卫星、地面基准雷达和地面气象观测，少数国家则应用飞机探测作为一种重要的辅助监测手段。气象卫星图像是确定台风中心位置最常用的资料，然后使用 Dvorak 方法，并结合透明螺旋线板和主观解释，通过去顶适当的云系中心的位置来定位的：1）为根据云型特征确定台风中心；2）根据云图上的地标特征进行网格误差的校正；3）进行斜视误差的校正；4）再利用台风的前期位置活动强度变化以及路径与台风位置的相关来检验所确定的位置是否合理，最后确定出台风中心位置。</p><p>  至于台风强度的确定，同样无法直接测量。目前世界各国（包括中国、曰本、美国等）主要仍要采用 Dvorak 研发的 Dvorak 分析技术，根据静止气象卫星在红外和可见光波段观测的台风云型特征及其变化估计台风的强度，该技术已成为在缺少飞机探测地区监测台风的世界标准，也是进行强度预报最通用的方法。由于在卫星云图上，需要通过台风云系的多种结构特征才能真实反映强度。这些特征包括：台风中心大小、强对流区范围以及外围螺旋雨带等。可以通过对卫星云图中这些特征的分析判断，给出用于表征台风强度的现实指数，然后根据观测现实强度指数与中心最大风速的经验关系，进而得到台风中心最大风速，即台风的强度。</p><p>  对于台风预警和防台减灾而言，首先需要确定的是海域内是否有热带气旋生成，且是否会形成为台风。因而热带气旋的生成或台风的形成预报是首要需要考虑的问题。其次，需要知道的是台风未来途径的区域，而这主要取决于预报台风的移动路径（一般用 ３ 或 ６ 小时间隔的台风中心位置来表达），因此台风路径的预报也是需要重点考虑的问题。进而为了确定台风对某海域或某地的影响程度，需要关注台风的强度，而风雨预报也是在台风强度的基础上，综合考虑未来天气形势的变化而进行的，因此，台风的强度的预报是需要考虑的关键问题。再之后，则需重点关注的是台风的风雨预报、间接引发的地质灾害预报以及风暴潮预报等。</p><p>  就台风形成预报而言，已有的研究关注点普遍在于热带气旋的生成问题上，比如生成机理的研究上，通常认为热带气旋的生成是需要预先存在的扰动，暖而深的海洋混合层，大于平均的低层涡度和中层湿度，不稳定的大气层，弱的水平风垂直切变以及科氏力作用的存在。业务预报上，国外较为成熟的生成预报模式，如NOAA采用的全球模型 GFS 和 UKMET 及其集合模式是预测热带气旋发生的主要工具，可预报特定海域热带气旋的生成概率。而国内目前常使用的预报模式，如 T639 模式，可用于预测热带气旋的生成、路径和强度变化，尤其是在中尺度范围内。</p><p>  除开数值模式，预测热带气旋生成的方法从以前的统计方法，到现在与机器学习方法融合的新型方法，使得热带气旋生成的预测方法更加丰富，效果相比于以前有了较大的提升。研究学者们会在洋面上已有热带扰动的基础上，通过考虑周围的大气环境条件建立模型来预测是否会有热带气旋生成。其中一部分研究的目的是为了研究更为有效预测方法，另一部分研究的目的是为了开发为业务预报服务的热带气旋生成预报系统。此外，还有部分研究会利用大尺度环境场对热带气旋的活动进行季节性预报，主要通过定义热带气旋的生成指数（GPI），来描述热带气旋生成可能性大小的空间分布。</p><p>  台风路径最初大多是建重在预报经验的基础上，传铳的路径业务预报方法包括天气气候学预报方法、环境引导气流预报方法。近三十年来，出现了一些客观预报方法，包括统计预报方法、统计动力预报法、模式输出统计释用法、神经网络法等。大多采用的是历史台风资料作为统计样本，在对影响台风移动的大尺度环境场气压系统（如副热带高压、高空长波槽、高空切断冷涡等）、环境场引导气流、海洋要素（海温、洋流等）、下垫面状态（如地形、地温等）作相关分析基础上，选择具有天气学、大气热力动力学等物理意义作为预报因子，一般以特定时效（如 12、24、36、48 小时）的经向和纬向移动距离作为预报量，采用各种数理统计方法对历史样本研究建立台风路径预报模型来进行预报。而数值预报模式仍然是现阶段常用的一种预报方法，台风路径数值预报模式系统是在数值天气预报模式上研发的专业应用的数值预报系统，在模式中反映了台风独有的参数化方案（如积云参数化，边界层参数化，海气耦合）和针对台风建立相应的物理过程。由于台风数值预报模式的初始场含有观测误差和分析误差，且大气运动本身存在不确定性，所以数值预报同时受初始场误差和观测误差的影响，这将使最终的预报结果偏离实际预测结果。台风强度预报和台风路径预报有很多相似之处，但是由于台风的发展过程中存在迅速增强等现象，会使得台风强度预测更具有挑战性。同样业务预报中的预报方法和路径预报类似，但是比较常用的是统计法、统计动力法、以及数值天气预报方法。近年来统计预报方法和统计动力预报方法表现了最优的预报效果。其中统计预报方法除考虑气候相关变量外，还引入了当前和前期大气环境变量、海面变量以及卫星图像特征建立预报模型。而统计动力预报方法是以数值天气预报的预报产品为依托，通过考虑未来大气环境和海洋状况的变化来建立预报模型。总的来说，可以发现预报的总体趋势是，路径误差在逐年降低，而强度误差基本无太大的变化。</p><p>  为了提高台风预测的准确性，同样出现了越来越多的学者尝试将机器学习应用于台风预测相关领域。一些学者尝试利用深度学习里的前馈神经网络量化台风引起的海面温度冷却，通过增加在预测模型中海表温度冷却的作用<sup>[2]</sup>来提高台风预测的准确率。一些学者利用卷积神经网络提取卫星遥感图片里的特征，从而预测台风眼的路径轨迹<sup>[3]</sup>。一些学者为了准确预测表示台风发生时的风险概况，利用机器学习中的主成分分析预测相关参数的分布，发掘机器学习算法作为当前数值模式中参数方法的替代方案的潜力<sup>[4]</sup>，来确定风场可变性的全部范围。一些学者利用机器学习中的支持向量回归模型作为预测方法对台风的季节性进行预测<sup>[5]</sup>，从而为准确获得台风的发生频率、空间分布以及季节性的强度变化。还有一些学者利用深度学习从大量的卫星云图中研究其台风“胚胎”的可预测性<sup>[6]</sup>，或者对现有的预报方法进行误差订正<sup>[7]</sup>。然而，目前被研究的最多的还是机器学习或者深度学习在台风路径和强度研究中的应用。对于路径研究，主要研究的是台风中心的定位和中心位置以及轨迹的预测。对于强度研究，主要研究的是台风强度的估计，台风的强度分类，以及强度的预测。</p><p>  由于现阶段台风的形成预测问题是基本被忽视，而路径预测在有明显提升的同时强度预测却没有太大的改善，从而重点关注于台风的形成预测和强度预测问题。本文的目的是在以往台风预测相关研究的基础上，利用深度学习自动提取特征并且处理时空相关性的优势，提出一个能够有效提高台风预测的效果且减少实施的代价的台风预测模型。并以台风形成和台风强度实际预测为例，证明能够提供更为准确的台风预报和预警，为防灾减灾做贡献。</p><h3 id="div-align-center-相关研究方法-div"><div align=center>相关研究方法</div></h3><h4 id="相关台风预测方法">相关台风预测方法</h4><h5 id="数值预报方法">数值预报方法</h5><p>  台风数值预报一般是通过对一定海域内的气象海洋环境条件，如副热带高压、水汽输送、海温等大尺度环境场进行预报后，再对台风路径和台风强度等台风要素进行推断预报。其中路径预报一般只需要数值模式能够对大尺度环境场进行合理的描述，即可对路径做出较为准确的预报。而强度预报不仅需要数值模式对大尺度环境场进行描述，还需了解 内核热动力过程与环境场的关系，对台风涡旋结构、多尺度物理过程等多方面进行合理的定义。因此，根据数值预报模式准确预报台风强度的难道比路径要大。若要对台风的数值预报过程进行描述，需要从模式初始化、物理过程参数化这两方面展开。</p><p>  模式初始化是进行台风数值预报的第一步。模式初始化是根据观察和背景场资料，在热动力约束下生成模式初始场的过程。早期由于缺乏海上观测资料，台风模式初始化方法通常是构造少量的Bogus涡旋，然后通过插值或变分同化方法融合到模式初始分析场中。上述方法虽然对于预报能力在一定程度上有提升，但由于考虑了许多假设以及经验关系，所以仍然会导致台风预报误差过大。近年来，国内外均逐渐尝试将多种卫星遥感、雷达、飞机实测资料与同化方法结合，应用于台风模式的初始化及预报。</p><p>  VIRV法，一种典型的模式初始方法，它不仅避免了传统三维变分同化（3DVAR）方法不适用台风的问题，融合了四维变化同分（4DVAR）的优点，而且考虑了边界层对台风对流及其发展的重要性，在模式初始场中引入了与实际观测相符的台风结构。VIVR的过程为：（1）在 QuickSCAT 资料的中纬度区域的每个格点，利用边界层模式估计边界层顶的气压梯度，然后进行梯度订正；（2）在热带地区，根据混合层边界层模式估计边界层顶的气压梯度；（3）通过最小二乘法由气压梯度拟合最佳相对气压场；（4）根据（3）得到的相对气压和浮标站观测和数值模式背景场分析得出的参考气压计算海平面气压；（5）将海平面的气压同化进中尺度数值模式；</p><p>  过程中选择的反演中纬度海平面气压的方法是由 Patoux 等提出。假设边界层顶存在地转平衡，那么边界层顶的地转风（G）可根据公式 1 中由海面风（$U_h$）计算得出：<br>$$<br>\frac{U_h}{G} = \frac{V_T}{G} + \frac{1}{G} \frac{\partial V_2}{\partial \xi} + cos \alpha + sin \alpha<br>\tag{1}<br>$$<br>  式中 $V_T$ 为热成风，$V_2$ 为次级涡旋扰动，$\alpha$ 为边界层内风相对于垂直方向的旋转角度。由于假设存在地转平衡，所以需要再作梯度风订正。</p><p>  而热带地区风压场不再满足地转平衡，于是 Stevens et al 通过使用混合层模式来对气压场进行估计，可以得到如下方程：<br>$$<br>fk \times U + \frac{1}{\rho_0} \nabla P = \frac{\tau(h) - \tau(0)}{h}<br>\tag{2}<br>$$<br>  其中，$U$ 为边界层平均风速，$P$ 为海平面气压，$\tau(0)$ 为地表湍流应力，$\tau(h)$ 为边界层顶的湍流应力。</p><p>  气压场 $p$ 可由下式得出：<br>$$<br>|H^T Hx - H^T y| \equiv 0<br>\tag{3}<br>$$<br>  其中算子 $H = \begin{vmatrix}<br>\frac{1}{\alpha cos \varphi} &amp; \frac{\partial}{\partial \lambda} \<br>\frac{1}{a} &amp; \frac{\partial}{\partial \varphi} \<br>\end{vmatrix}$,<br>且 $a$ 为地球半径，$\lambda$ 为经度，$\varphi$ 为纬度。</p><p>  由（1~3）式结合海上的浮标站观测和数值模式背景场分析得出的参考气压值，可以得到中纬度地区和热带地区的气压场分布。</p><p>  在反演出海面气压场后还需将其同化进入台风模式的初始场中。典型同化方法包括最优插值、三维变分同化、四维变分同化、集合卡尔曼滤波、粒子滤波等。Ma and Tan 选择了较为成熟的三维变分同化，通过迭代最小化代价函数 $J(x)$ 来得到最接近观测的最优分析场 $x$，其代价函数由观测误差和背景场误差构成，具体定义为：</p><p>$$<br>J(x) = J^b + J^o = \frac{1}{2} (x - x^b )^T B^{-1} (x - x^b) + \frac{1}{2} (y - y^o) (E +F)^{-1} (y-y^o)<br>\tag{4}<br>$$</p><p>  上式对每个格点的误差分析，使用了背景误差，观测误差和代表性误差的加权，它们的误差协方差矩阵分别为 <strong>$B、E$</strong> 和 <strong>$F$</strong>。</p><p>  对流参数化是台风数值预报的第二步。在数值模式中，对流参数化方案是为了反映次网格尺度对流作用而设计的，其对于描述台风对流发展至关重要。目前，台风模式研究和业务应用中广泛应用的是 Kain-Fritsch 对流参数化方案。KF93 方案为估计对流云发展过程的不稳定能量及区域而采用的方法是拉格朗日气块法。具体细节：首先比较在气块抬升凝结高度（LCL）的气块温度与大气温度，来寻找上拽气流的源地。由于一般对流发生前 ，气块温度比环境温度低，气块难以抬升，因此需要在参数化方案中定义一个温度初始扰动 $\delta T_w$ 附加至气块现有的温度上，以强迫气块抬升。具体如下：<br>$$<br>\delta T_w = c_1 w^{1/3}_G<br>\tag{5}<br>$$<br>  其中 $w_G$ 为抬升凝结高度的垂直速度（$cm \cdot s^{-1}$）。</p><p>  当 $T_LCL + \delta T_w \leq T_{ENV}$ 时，则不满足触发对流的条件，须在更高一层的模式层中判断是否为上拽气流的源地层，依此类推，直至找到源地层为止。想法，如经附加温度扰动的气块温度高于环境温度，则已满足触发对流的条件。显然，定义温度扰动（$\delta T_w$）对于气块是否上升以及是否触发对流非常重要。</p><h5 id="统计预报方法">统计预报方法</h5><p>  一般来说，通过台风数值预报模式能对台风路径进行较为准确的预报，而台风强度预报的准确性不高。这是由于热带气旋强化过程的复杂性，使得强度预测技巧相对较低，因此强度预测也更加困难。此外，目前的数值模型无法以实时和可操作的方式明确解决对流问题，因此需要用其他强度预测方法来克服现有的数值模型的缺陷。通常，当无法通过机理分析建立模型时，可以采取收集大量数据的方法，通过对数据的统计分析建立模型。因为在大量的观察下，数据会表现出一定的规律性，这种规律可以通过函数关系式表示，函数关系式则称为回归方程，统计回归模型确定的是变量之间的相关关系。但是和台风相关的很多数据是无法通过实测得来的，所以仍然需要利用数值模式的产品。理想的替代方法是利用统计模型和数值模型的优势，将统计方法与数值天气预报的环境预测相结合起来，这种方法被统称为统计学-动力学方法。其中比较典型的是台风强度预测模式（Statistical Typhoon Intensity Prediction Scheme，STIPS），具体介绍请移步原文。</p><h5 id="机器学习方法">机器学习方法</h5><p>  近年来，许多学者将机器学习应用于台风领域，其在一定程度上弥补数值预报方法和统计预报方法的不足。具体方法请移步原文。</p><h4 id="相关深度学习方法">相关深度学习方法</h4><p><font size = 2; color = natural>PS: 由于之前一直处于该领域，故不再此处展开，具体请移步原文。</font></p><h3 id="div-align-center-基于深度学习的台风时空深度混合预测模型-div"><div align = center>基于深度学习的台风时空深度混合预测模型</div></h3><h4 id="引言">引言</h4><p>  台风从生成到发展的过程是一个时空变化的过程，影响台风变化甚至是台风周围的气象海洋要素也是时空相关的变量。然而，现有的方法很少将这种时空关系考虑进来，通常，预报因子都只是作为独立变量进行预测，因此可能造成预报效果不理想的原因之一。数值预报方法根据流体动力热力学方程考虑了这种时空关系，但是由于数值模式的计算复杂太大，且各种和台风相关的机制还不够完全，因此，虽然作为近些年来的主流预报方法，但是仍然存在很大的缺陷。本文旨在利用现有的统计预报和机器学习等台风相关预测方法的基础上，结合深度学习中卷积神经网络获取空间特征和长短期记忆神经网络获取时序特征的能力，充分学习台风活动过程的时间关系，建立台风时空深度混合预测模型来对台风的各种关键问题进行预测。本章则主要介绍如何把台风预测问题转换为时空序列预测问题，然后提出了解决这个问题的方法，即基于深度学习的台风时空混合预测模型，并详细给出了设计该模型的思路。</p><h4 id="问题定义">问题定义</h4><p>  本文希望通过历史台风资料，大气数据和海洋数据构建台风的预测模型，以能对未来台风的活动进行预测，比如是否形成、路径变化、强度变化、风雨状况等。在实际观测中，台风形成前的热带气旋等级为热带风暴。由于从热带风暴发展到台风的过程是一个空间和时间变化的过程，台风之后的发展消亡也是空间和时间变化的过程。在不考虑空间信息的情况下，热带风暴和台风的路径是时间序列，为分析获取其时序关系，需要采用多个时刻的大气和海洋数据来进行预测。但是热带风暴或台风中心的周围环境变量在任意时刻都是空间场，大气变量在空间中的三个维度包括经度、纬度、层。而与台风紧密相关的海面变量在空间中的维度只包括经度和纬度。如何从历史数据中获取台风形成之前与之后时空变量的规律对未来的台风活动进行预测？这是本文需要考虑的问题。本文由此可以将台风预测问题定义为时空序列预测问题。</p><p>  为了能通过深度学习的手段来解决台风预测这类时空序列预测问题，需要在已划分为空间网格点的区域中选择相应的数据。无论数据类型是再分析资料或者是卫星遥感的反演数据，选择的单层大气层或海表层的相关变量数据都可以用二维网格图表示。给定热带风暴或台风中心周围的二维网格图有 $M \times M$ 个网格点。大气压力层的数量是 $L$，大气变量的数量是 $R$，海面变量的数量是 $O$。因此热带风暴中心或台风中心 $X^P$ 周围的大气变量是 $M \times M \times L \times R$ 规格的网格数据集。热带风暴中心周围的海面变量 $X^S$ 是 $M \times M \times O$ 规格的网格数据集。包含大气变量和海洋变量的空间环境变量由此可以表示为 $X = [X^P, X^S]$。定义预测当前时刻是 $t$，预测当前时刻的环境变量是 $X_t$。$Y$ 是预测对象，可以表示台风是否形成，路径上的中心经纬度位置，强度或者风雨量等，$k$ 是预测时间步，$b$ 是在预测当前时刻之前应该考虑的回顾时间步，每个时间步长为 6 小时。</p><p>  因此，问题可以进一步被定义为给定预测当前时刻和回顾时刻风暴中心或者是台风中心周围环境变量网格数据集，预测台风在未来时刻的状态，如是否形成，形成后的强度、路径以及风雨等状态量。即给定时空变量序列 $X_{t - 6b} (b = 0, 1, 2, 3)$，预测台风的状态量 $Y_{t + 6k}$。简单表述如下：</p><p>$$<br>Y_{t + 6k} = f(X_t, X_{t - 6b}) \ \ \ \  k, b = 0, 1, 2, 3…<br>\tag{6}<br>$$<br>  $Y_{t + 6k}$ 是从当前预测时刻 $t$ 开始 $6k$ 小时后的预测对象，$f$ 是需要通过历史数据学习的模型，$X_t$ 是当前预测时刻热带风暴或者台风中心周围环境变量的网格数据集，$X_{t - 6b} 是预测当前时刻之前 $6b$ 小时环境变量的网格数据集。图 3 表示台风预测相关时空变量结构。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-02-11-37-43.png'/><font color = natural; size = 2>图 3. 台风预测相关变量的时空结构示意图</font></div><h4 id="模型框架">模型框架</h4><p>  该模型的总体框架如图 4 所示。本文提出了台风时空预测模型来学习与台风相关的大气和海洋变量的时空相关性。其主要思想是使用 3DCNN 来学习大气变量的三维空间关系，2DCNN 来学习海面变量的二维空间关系以及 LSTM 来学习台风变化过程中变量的时序关系。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-02-13-21-44.png'/><font color = natural; size = 2>图 4. 台风时空深度混合模型框架图</font></div>&emsp;&emsp;任意时刻热带风暴中心或台风周围的大气变量 $X^P$ 都是 $M \times M \times L \times N$ 规格的网格数据集，亦可作为 3DCNN 输入的 4D 张量。任意时刻热带风暴中心或台风中心周围的海面变量 $X^S$ 都是 $M \times M \times O$ 规格的网格数据集，亦可作为 2DCNN 输入的 3D 张量。 该模型在“connection”部分拼接 3DCNN 和 2DCNN 的输出向量，其长度为 $K$，并作为 LSTM 的输入。因此，台风时刻深度混合预测模型可以表述为：<p>$$<br>Y_{t + 6k} = LSTM(3DCNN(X^P_{t - 6b}), 2DCNN(X^S_{t - 6b}))<br>\tag{7}<br>$$<br>其中 $k = 1, 2, 3…$ 且 $b = 0, 1, 2, 3…$</p><p>  由于根据不同的预测问题，模型损失函数有不同的定义。对于神经网络模型，其代价函数仍然很大程度上与其他的参数模型相近，如线性模型的损失函数。大多数情况下，参数模型定义了一个分布 $p(Y|X;\theta)$，并且简单地使用最大似然原理，即意味着是将训练数据和模型预测间的交叉熵作为代价函数。有时则使用更简单的方法，不是预测 $Y$ 的完整的概率分布，而是在给定 $X$ 的条件下 $Y$ 的某种统计量，比如均方根误差和平均绝对误差。因此本文模型的整体损失函数可以表示为：</p><p>$$<br>J(\theta) = \frac{1}{N} \frac{1}{T} E_{X, Y ~ \hat{p}_{data}} ||Y - f(X;\theta)||^2<br>\tag{8}<br>$$</p><p>  其中，$N$ 表样本数，$T$ 表示 LSTM 的时间步数，$E$ 表示模型预测值与真实值之间差距的衡量标准，$Y$ 表示真实值，$X$ 表示输入值，$f$ 表示模型，$\theta$ 表示模型需要学习的参数。</p><p>  通常，设计网络模型时需要考虑损失函数的梯度足够大且具有足够的可预测性这样才能为训练出学习算法提供一个好的指引。用于实现最大似然估计的交叉熵函数可以处理离散型变量，因此可以用于台风预测中所定义的分类问题。而均方根误差和平均绝对误差虽然在使用基于梯度的优化方法时虽然往往不如交叉熵函数，但是通常可以适用于台风预测中所定义的回归问题。</p><h5 id="海表变量-X-S-二维空间关系的特征学习">海表变量 $X^S$ 二维空间关系的特征学习</h5><p><font size = 2; color = natural>PS: 具体请移步原文。</font></p><h5 id="大气变量-X-P-三维空间关系的特征学习">大气变量 $X^P$ 三维空间关系的特征学习</h5><p>  台风是一种强对流天气，其间大气存在强烈的垂直运动，因此大气变量不仅仅是三维空间变量，而且具有很强的相关性。常与台风相关的大气基本变量有：风的方向分量（u）、风的速度分量（v）、温度（t）、相对湿度（rh）和位势高度（z）。同样可以通过已有数据来定义一些与台风的相关变量，如位涡。垂直速度，涡度（VOR），散度（DIV）。而不能通过已有数据直接定义的有垂直风切变（VSHEAR）、垂直不稳定度（THEDV）、日生成潜力（DGP）、低层环流（CIRC）、最大潜在强度（MPI）。其中，最常用的涡度和散度可作如下表示（式中 $\vec{V}$ 为风矢量）：</p><p>$$<br>VOR = \nabla \times \vec{V} \\<br>DIV = \nabla \cdot \vec{V}<br>\tag{9}<br>$$</p><p>  此外，可通过压力层数据定义一些相关量：</p><p>$$<br>VSHEAR = \sqrt{(\overline{u_{850}} - \overline{u_{200}})^2 + (\overline{v_{850}} - \overline{v_{200}})^2} \\<br>THEDV = \sum_{p = 850 hpa}^{200 pha} wt(p) [\overline{\theta_E(850)} - \theta_E^*(p)]，\theta_E 为 850hpa 位温 \\<br>DGP = \overline{\xi 900} - \overline{\xi 200}，\xi 900 和 \xi 200 为 900hpa 和 200 hpa 压力层的相对涡度值 \\<br>CIRC = \oint_P u \cdot dl<br>MPI = 66.5 + 108.5e^{(0.8313(SST - 30))}<br>\tag{10}<br>$$</p><p>  由于现在对台风的机制理解还不够到位，传统的手动特征变量可能与之相关，却不能够保证是真正有效的。受涡度、风切变等这些传统物理特征的启发，加之为了充分利用深度学习自动提取特征的能力，模型同样使用 CNN 对台风相关的三维大气变量进行更复杂的特征学习。CNN 可以通过 3D 卷积核，即本文的 3DCNN，学习网格化大气变量各层各类型之间的相关性。如图 5 所示，3D 卷积核可以设置不同规格的卷积核尺寸，它将前一个特征图的相连几层的局部区域特征提取后映射到下一层子特征图的某一对应位置，再通过多个卷积核来生成多个系列的子特征图来学习整体与台风相关大气变量的空间特征。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-02-15-59-12.png'/><font size = 2; color = natural>图 5. 用于大气变量空间特征提取的三维卷积层示意图</font></div>&emsp;&emsp;第 i 层第 j 个特征图上位置（x, y, z）的值表示如下：<p>$$<br>u_{ij}^{xyz} = f(\sum_{k=0} \sum_{p=0}^{P_{i-1}} \sum_{q=0}^{Q_{i-1}} \sum_{r=0}^{R_{i-1}} w_{ijk}^{pqr} u_{(i-1) k}^{(x+p)(y+q)(z+r)} + b_{ij})<br>\tag{11}<br>$$<br>  其中 $R_{i}$ 是 3D 卷积核时间维度的值，$w_{ijk}^{pqr}$ 连接 k 层特征图（i, j）位置处卷积核内的（p, q, r）处的值，$b_{ij}$ 为偏置项。</p><p>  台风中心周围的大气变量各网格点各层之间同样存在各种复杂抽象的特征关系，因此仍然需要设置多个卷积核和多个卷积层来提取复杂的特征以进行预测，如图 6 所示。以一个样本为例，该 3DCNN 网络结构的输入为 $L$ 层 $M \times M$ 个网格位置的 $R$ 个海表变量，同样通过第一个卷积层的多个卷积核进行卷积操作后，生成了多个特征图，然后对特征图进行降采样操作，得到了同样数量的子特征图，再利用多个卷积层来对大气变量之间的复杂的抽象特征进行提取，最后对所有子特征图进行全连接展开后，降维为大气变量特征向量，此即为 3DCNN 用于大气变量三维空间关系特征学习的过程。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-10-02-16-42-41.png'/><font size=2; color=natural>图 6. 3DCNN 用于大气变量三维空间关系的特征学习示意图</font></div><h5 id="台风变化过程中时序关系的特征学习">台风变化过程中时序关系的特征学习</h5><p><font size = 2; color = natural>PS:大致思路为，将 3DCNN 学习到的大气变量特征和 2DCNN 学习到的海表变量特征作为 LSTM 的输入向量，学习时序相关特征。具体请移步原文。</font></p><h4 id="实现方法">实现方法</h4><p><font size = 2; color = natural>PS:该章节为，采用 TensorFlow 框架搭建上述模型的具体步骤。具体请移步原文。</font></p><h3 id="div-align-center-基于时空深度混合预测模型的台风形成及强度预测-div"><div align = center>基于时空深度混合预测模型的台风形成及强度预测</div></h3><p>实验所用数据集为：</p><ol><li class="lvl-3"><p>世界气象组织（World Meteorological Organization, WMO）版本的国际气候管理最佳轨道档案（International Best Track Archive for Climate Stewardship, IBTrACS）全球热带气旋最佳轨道数据集：<a target="_blank" rel="noopener" href="https://www.ncei.noaa.gov/products/international-best-track-archive">链接</a></p></li><li class="lvl-3"><p>欧洲中期天气预报中心（European Centers for Medium-Range Weather Forecasts, ECMWF）开源的大气海洋变量组成的实验数据集：<a target="_blank" rel="noopener" href="https://confluence.ecmwf.int/display/CKB/How+to+download+ERA5">ERA-Interin 再分析数据集</a></p></li></ol><p><font size = 2; color = natural>PS:该章为上述模型的实验部分，故不在此展开。具体请移步原文。</font></p><br><font size=2; color=grey>[1]. 陈睿. 基于深度学习的台风预测关键技术研究[D].国防科技大学, 2018.<br>[2]. Jiang G Q, Xu J, Wei J. A deep learning algorithm of neural network for the parameterization of typhoon‐ocean feedback in typhoon forecast models[J]. Geophysical Research Letters, 2018, 45(8): 3706-3716.<br>[3]. Hong S, Kim S, Joh M, et al. Globenet: Convolutional neural networks for typhoon eye tracking from remote sensing imagery[J]. arXiv preprint arXiv:1708.03417, 2017.<br>[4]. Loridan T, Crompton R P, Dubossarsky E. A machine learning approach to modeling tropical cyclone wind field uncertainty[J]. Monthly Weather Review, 2017, 145(8): 3203-3221.<br>[5]. Richman M B, Leslie L M. Adaptive machine learning approaches to seasonal prediction of tropical cyclones[J]. Procedia Computer Science, 2012, 12: 276-281.<br>[6]. Matsuoka D, Nakano M, Sugiyama D, et al. Detecting precursors of tropical cyclone using deep neural networks[C]//The 7th International Workshop on Climate Informatics, CI. 2017.<br>[7]. Richman M B, Leslie L M, Ramsay H A, et al. Reducing tropical cyclone prediction errors using machine learning approaches[J]. Procedia computer science, 2017, 114: 314-323.<br></font>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>新手村任务2</title>
      <link href="/posts/20230920134818/"/>
      <url>/posts/20230920134818/</url>
      
        <content type="html"><![CDATA[<h2 id="海洋如何影响天气和气候">海洋如何影响天气和气候</h2><p>  人类碳排放给地球带来的额外热量中有90%以上储存在海洋中–其中只有约2.3%使大气层暖化，其余的则会融化冰雪、使陆地变暖。<br>  海洋与大气紧密相连，这使得对其行为的了解成为对天气和气候条件预报至关重要的环节。海洋吸收了大部分抵达地球的太阳能。由于赤道接收的太阳能远多于两极，形成了巨大的水平和垂直洋流，并促使这一热量绕地球循环。其中一些洋流携带者热量进行数千里，之后将其中一大部分释放回大气。<br>  海洋的升温和降温速度比大气慢，因此，沿海地区的天气往往比大陆地区的天气温和，极冷和极热天气也较少。海洋的蒸发，特别是热带地区的蒸发，形成了大部分的雨云，影响了陆地上湿区和干区的位置。海洋捕获的巨大能量创造了世界上最强大、最具破坏性的风暴和极端事件，如气旋（包括热带气旋和温带气旋）。<br>  人类碳排放给地球带来的额外热量中有90%以上储存在海洋中–其中只有约2.3%使大气暖化，其余的则会融化冰雪、使陆地变暖。因此，大气层变暖的速度比原本要慢。然而，这不应该是我们不采取行动的诱因，因为海洋暖化只是推迟了气候变化的全面影响。由于热膨胀、海洋区域缺氧（无氧）、海冰融化、海洋热浪、珊瑚白化和其他不适合海洋生物生存的环境，过多的热量导致了海平面上升。在未来几个世纪里，海洋新吸收的大部分热量将不可避免地流向大气层。<br>  气象预报员将海洋观测和关于海洋–大气相互作用如何影响天气、季节性和长期气候及海洋形式的知识与温度（大气和海面）、气压、风况、波浪、降水和其他变量的观测结合了起来。这些数据集共同组成了数值天气和气候预测耦合模式的关键资料。因此，WMO全系统对支持海洋观测、研究和服务关系重大。</p><h2 id="热带气旋（台风）-sup-2-sup">热带气旋（台风）<sup>[2]</sup></h2><p>  热带气旋的形成是大气中多种尺度天气系统相互作用的结果。由于远洋观测资料的匮乏以及本身的多尺度特征，热带气旋的形成过程是当前热带大气研究中的一个难点问题。</p><h3 id="热带气旋和台风的区别">热带气旋和台风的区别</h3><p>  热带气旋和台风是两个相关的概念，但它们之间存在一些区别。以下是它们的主要区别：</p><ol><li class="lvl-3"><p><strong>定义：</strong></p><ul class="lvl-2"><li class="lvl-5"><strong>热带气旋</strong>是一个广泛的气象术语，用来描述在热带和亚热带地区形成的大气旋风系统。这包括热带低压、热带风暴、台风和飓风等。</li><li class="lvl-5"><strong>台风</strong>是热带气旋的一种具体类型，通常指的是西北太平洋地区的强热带气旋。</li></ul></li><li class="lvl-3"><p><strong>区域：</strong></p><ul class="lvl-2"><li class="lvl-5"><strong>热带气旋</strong>可以在全球热带和亚热带地区形成，包括大西洋、太平洋和印度洋等地区。</li><li class="lvl-5"><strong>台风</strong>通常是指太平洋西北部的热带气旋，包括台湾、菲律宾、日本等地。</li></ul></li><li class="lvl-3"><p><strong>命名：</strong></p><ul class="lvl-2"><li class="lvl-5"><strong>热带气旋</strong>的命名方式因地区而异。例如，大西洋和东北太平洋地区的热带气旋会根据一个固定的命名列表进行命名。</li><li class="lvl-5"><strong>台风</strong>是太平洋西北部的特定热带气旋类型的名称。</li></ul></li><li class="lvl-3"><p><strong>风力等级：</strong></p><ul class="lvl-2"><li class="lvl-5"><strong>热带气旋</strong>包括各种强度，从热带低压到飓风，飓风是大西洋和东北太平洋地区对台风的命名方式。</li><li class="lvl-5"><strong>台风</strong>通常指的是风力达到或超过每秒33米（约每小时118.8公里）的热带气旋。根据不同地区的标准，台风还可以分为不同的强度级别，如强台风和超强台风。</li></ul></li></ol><p>  总之，热带气旋是一个更广泛的概念，用来描述热带和亚热带地区形成的大风旋风系统，而台风是其中一种具体类型，主要出现在太平洋西北部地区。不同地区可能使用不同的术语和标准来描述和命名这些气旋。</p><h3 id="热带气旋形成的原因">热带气旋形成的原因</h3><p>  热带气旋（包括飓风、台风和热带风暴）形成的原因涉及多个复杂的气象因素。以下是热带气旋形成的大尺度环境条件：</p><ol><li class="lvl-3"><p>**暖海水：**热带气旋通常在温暖的海水表面上形成，海水温度至少需要达到26.5摄氏度或更高，以提供足够的热量和湿度供气旋的发展。</p></li><li class="lvl-3"><p>**海洋热含量：**除了温度，热带气旋还需要大量的海洋热含量，这意味着温暖的水层不仅存在于表面，而且在一定深度内（海表面及以下50米）都要保持温暖。这种温暖的水层有助于提供稳定的热量供气旋的发展。</p></li><li class="lvl-3"><p>**大气不稳定性：**热带气旋通常在大气中（海表面以上一定高度）存在不稳定的条件下形成，这意味着较暖的空气被迫上升，从而产生对流。即海面一定区域内存在有组织的对流，低层有着较强的气旋性涡度，且中层相对湿度较高。这种不稳定性有助于气旋的形成和增强。</p></li><li class="lvl-3"><p>**低垂直风切变：**垂直风切变是指不同高度处的风速和风向的差异。热带气旋形成和增强需要较低的垂直风切变，以便气旋的中心可以保持垂直对称，而不会被风切变摧毁。</p></li><li class="lvl-3"><p>**地球自转效应（克里奥利力）：**地球的自转会导致气流在北半球和南半球中受到偏转，这有助于旋转气旋的中心。</p></li><li class="lvl-3"><p>**足够的初始扰动：**热带气旋通常需要一个初始的扰动，如气旋或低压系统，来触发其形成过程。这个扰动可以是季风气流、对流带或其他天气系统的一部分。</p></li></ol><p>  热带气旋的形成是一个复杂的过程，涉及多个气象因素的相互作用。一旦形成，它们可能会在适当的条件下增强，最终可能演变成强烈的飓风或台风。气象学家使用各种观测和数值模型来监测和预测热带气旋的形成和发展。</p><p>  尽管这些大尺度条件对于热带气旋形成的重要性得到了普遍的认可，但是以上的条件并不能作为判断一个热带扰动能否发生发展成为一个热带低压的判据。因为热带大洋在大部分时间内其实都满足上述条件，而且上述的几个条件之间并不是相互独立的。越来越多的研究指出，对于热带气旋的形成，最为关键的是其中的中小尺度过程。以下是一些关键的中小尺度过程，对热带气旋的形成起着重要作用：</p><ol><li class="lvl-3"><p>**对流活动：**对流活动是指大气中的上升气流和降水的形成。在热带气旋的形成过程中，对流活动是关键的，因为它们有助于抬升暖湿空气并释放热量，促使气旋的发展。</p></li><li class="lvl-3"><p>**热带扰动：**热带气旋通常需要一个初始的扰动来触发其形成。这个扰动可以是气旋、低压区域或对流带，它们可以导致气流汇聚并开始旋转，为气旋的形成创造条件。</p></li><li class="lvl-3"><p>**水汽输送：**水汽是热带气旋的主要能量源之一。中小尺度的水汽输送过程，如季风、海洋暖流和热带海洋的蒸发，可以提供大量的水汽，使气旋有足够的湿度来维持和增强。</p></li><li class="lvl-3"><p>**风切变：**中小尺度的风切变，尤其是底层风切变，可以影响气旋的形成和发展。较小的风切变有助于维持气旋的对称性和结构。</p></li><li class="lvl-3"><p>**海洋表层热力过程：**海洋表层的温度变化和热力过程对热带气旋的形成至关重要。温暖的海水不仅提供了热量，还影响气旋的对流和上升运动。</p></li></ol><p>  这些中小尺度过程在热带气旋的形成和增强中起着关键作用。气象学家使用观测数据、数值模型和研究来理解这些过程如何相互作用，以便更好地预测和监测热带气旋的行为。</p><p>  近二十多年来，随着大气探测技术的发展和高精度数值计算能力的提高，人们对这些关键中尺度过程有了深入的认识。尽管如此，人们对热带气旋的形成过程还存在很多争议。如，许多研究表面，水汽含量逐渐增大的中层旋涡是许多热带气旋形成之前的共同特征。但是，关于中层涡旋对于热带气旋形成的作用，以及水汽的来源尚没有统一的结论。故本文着重探讨这两个关键过程，**一是中层涡旋的形成和发展，二是系统的水汽演变过程，**分别为热带气旋形成过程中的关键动力学和热力学过程。本文的工作旨在为热带气旋形成的预报提供理论依据。</p><h3 id="热带气旋形成的两个主要观点">热带气旋形成的两个主要观点</h3><ol><li class="lvl-3"><p>“自上而下”的发展方式：该理论认为，中层涡旋是热带气旋形成中的关键中尺度系统。</p></li><li class="lvl-3"><p>“自下而上”的发展方式：该理论认为涡旋热塔，即伴随有强气旋性旋转的上升对流是热带气旋形成中的关键系统。</p></li></ol><h3 id="热带气旋形成的过程中，水汽的演变">热带气旋形成的过程中，水汽的演变</h3><p>  在热带气旋形成过程中，水汽的演变是一个关键的过程，他涉及水汽的蒸发、上升、凝结和释放热能等步骤。以下是水汽演变在热带气旋形成中的关键过程：</p><ol><li class="lvl-3"><p>**蒸发：**热带气旋通常在温暖的海洋水域上形成，这些水域通常有相对温度的海水表面。当大气中的风把空气从海洋表面吹过时，水表面上的水分开始蒸发。这个过程将液态水转化为水蒸气，即水汽。</p></li><li class="lvl-3"><p>**上升：**蒸发后的水汽通常伴随着温暖空气上升。上升可能是由气流上升、地形障碍、或气旋内部的对流触发的。随着空气上升，气温下降，水汽开始冷却。</p></li><li class="lvl-3"><p>**凝结：**随着空气的上升和冷却，水汽逐渐达到饱和点，即空气中的水汽饱和度达到100%。在饱和点以下，水汽会凝结成小水滴或冰晶，形成云。这个过程释放热量，称为潜热释放。潜热释放是热带气旋中的能量源之一，它有助于气旋的增强。</p></li><li class="lvl-3"><p>**云团的发展：**随着水汽的凝结，云团逐渐发展，形成云层。云层中的气体和液滴进一步推动空气上升，加强了对流活动。</p></li><li class="lvl-3"><p>**云团的聚集：**多个云团可以在热带气旋的中心附近聚集，形成气旋的中心部分。这些云团通过释放热量和引导空气上升来帮助气旋的形成和增强。</p></li></ol><p>  总之，水汽演变是气旋形成过程中的关键步骤之一，因为它提供了气旋所需的湿度和热量。热带气旋通常在温暖的海洋水域上形成，其中水汽的蒸发和凝结过程对于气旋的发展至关重要。这些过程中释放的潜热是热带气旋强调增加的主要机制之一。</p><h4 id="湿焓、表面焓、海表焓之间的联系与区别">湿焓、表面焓、海表焓之间的联系与区别</h4><p>  湿焓、表面焓和海表焓是在气象和热力学中使用的概念，它们描述了空气或水在不同温度、湿度和压力条件下的热能状态。以下是它们之间的联系和区别：</p><ol><li class="lvl-3"><p><strong>湿焓（Enthalpy）：</strong></p><ul class="lvl-2"><li class="lvl-5">湿焓是指单位质量的空气或水在一定温度和湿度下的总热能。它通常用符号“H”表示。</li><li class="lvl-5">湿焓包括了内部能量和压力势能，以及潜热（相变时释放或吸收的热量）。</li><li class="lvl-5">在气象学中，湿焓通常用来描述大气中空气的状态，尤其是在讨论气流、对流和湿度变化时。</li></ul></li><li class="lvl-3"><p><strong>表面焓（Surface Enthalpy）：</strong></p><ul class="lvl-2"><li class="lvl-5">表面焓是指在地球地表或海洋表面的特定条件下，单位质量的空气或水的湿焓。它通常用符号“Hs”表示。</li><li class="lvl-5">表面焓通常用于描述地表或海洋表面的能量状态，特别是与气象和热传输过程相关的研究中。</li></ul></li><li class="lvl-3"><p><strong>海表焓（Sea Surface Enthalpy）：</strong></p><ul class="lvl-2"><li class="lvl-5">海表焓是指海洋表面上的水体（通常是海水）在特定条件下的湿焓。它也可以用符号“Hs”表示。</li><li class="lvl-5">海表焓通常用于描述海洋表面的热能状态，特别是在热带气旋（如飓风、台风）的形成和增强过程中，因为温暖的海洋表面是热带气旋的主要能量来源之一。</li></ul></li></ol><p><strong>联系和区别：</strong></p><ul class="lvl-0"><li class="lvl-2"><p>表面焓和海表焓的概念非常相似，因为它们都描述了特定表面上的湿焓状态。通常情况下，当谈论海洋表面时，我们使用术语“海表焓”，而在陆地或地表时使用“表面焓”。</p></li><li class="lvl-2"><p>湿焓是一个更广泛的概念，不限于特定表面，它描述了空气或水在任何温度和湿度条件下的总热能状态。</p></li></ul><p>  总之，湿焓、表面焓和海表焓都是描述热能状态的概念，它们在不同的气象和热力学上下文中使用，以帮助科学家理解和描述大气和海洋的热力学过程。</p><h3 id="本文研究内容和目的">本文研究内容和目的</h3><p>  本文将主要针对其中的中层涡旋的演变及作用和水汽变化过程开展研究工作，进一步揭示热带气旋形成中的关键过程，加深人们对热带气旋形成过程的认识。主要包括：</p><ol><li class="lvl-3"><p>中层涡旋的形成和演变特征及在热带气旋形成中的作用；</p></li><li class="lvl-3"><p>热带气旋前期扰动中的整层水汽变化及主要来源；</p></li><li class="lvl-3"><p>水汽垂直分布对热带气旋形成过程的影响。</p></li></ol><h3 id="数据集（资料）">数据集（资料）</h3><p>  本文采用的主要资料有：</p><ol><li class="lvl-3"><p>NCEP（National Centers for Environmental Prediction）的 FNL（Final）全球再分析资料：<a target="_blank" rel="noopener" href="https://rda.ucar.edu/datasets/">点击下载</a> 该数据的可用性和格式可能会根据时间而变化，因此最好查阅官方来源以获取最新的信息和访问方法。</p></li><li class="lvl-3"><p>WRF<sup>[3]</sup>（Weather Research and Forecasting）模式高精度模拟资料。</p><blockquote><p>WRF 是设计用于气象研究和数值天气预报的最先进的大气建模系统，它为大气过程提供了许多选项，并且可以在各种计算平台上运行。它具有两个动力核心、一个数据同化系统以及支持并行计算和系统可扩展性的软件架构，在数十米到数千公里的范围内的各种应用中均表现出色。</p></blockquote></li><li class="lvl-3"><p>JMA（Japan Meteorological Agency）最佳数据集，数据集包含了台风号、形成时间、各个时刻的经纬度以及强度（中心最低气压以及表面最大风速），时间间隔为6小时。<a target="_blank" rel="noopener" href="https://www.jma.go.jp/jma/jma-eng/jma-center/rsmc-hp-pub-eg/besttrack.html">JMA 最佳数据集</a></p></li></ol><h3 id="数值试验设计">数值试验设计</h3><h4 id="台风“鲇鱼”数值试验设计">台风“鲇鱼”数值试验设计</h4><p>  本文使用的模式为 WRF V3.6.1 <a target="_blank" rel="noopener" href="https://www2.mmm.ucar.edu/wrf/users/download/get_source.html">WRF 链接</a>，模式的初始场和边界条件是从 NECP 的 FNL再分析资料中获取的。模式采用如图1所示的三层网格嵌套，水平格距分别是13.5，4.5和1.5KM。所有区域垂直方向均为35层，模式顶为10hPa。时间为2010-10-08_06:00:00 ~ 2010-10-14_00:00:00，每小时输出一次。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-09-22-15-04-42.png'/><font size = 2; color = natural>图1. 台风“鲇鱼”数值试验网格嵌套示意图</font></div>&emsp;&emsp;模式中，3层网格云微物理参数化方案均采用 WSM6 方案，长波辐射参数化方案均采用 Rapid Radiative Transfer Model（RRTM）方案，短波辐射参数化方案是 Dudhia 方案。三层网格均没有使用任何积云对流参数化方案。<ul class="lvl-0"><li class="lvl-2"><p>**WSM6：**是一种云微物理方案，用于气象和大气科学领域的数值气象模型中，特别是用于描述云和降水过程。这个名称中的“WSM”代表“Warm- and Cold-Season processes of cloud and Precipitation”（云和降水的暖季和冷季过程）。</p></li></ul><blockquote><p>WSM6 方案旨在模拟云和降水的不同过程，包括云滴的形成和增长、雨滴的形成、降水、积冰、雪等。这个方案包括多个参数和模拟化的物理过程，以描述不同类型的云和降水时间。通常，气象模型会根据不同的研究或应用目标选择不同的微物理方案，以更好地模拟特定地区或时间段的天气现象。具体来说，WSM6 方案通常用于 WRF（Weather Research and Forecasting Model）等数值气象模型中，以模拟云、降水和相关气象过程。这个方案的特性和性能会影响模型的预报结果，因此在使用时需要仔细选择和配置。</p></blockquote><ul class="lvl-0"><li class="lvl-2"><p>**RRTM：**是一种用于计算大气辐射传输的计算机模型。它的主要目的是模拟大气中的辐射过程，包括太阳辐射的吸收和地球辐射的发射，以及在大气中的散射和吸收。RRTM通常用于气象和气候模型中，以更好地理解和预测地球的辐射平衡、温度分布和气候变化。以下是RRTM的一些关键特点和应用：</p></li></ul><blockquote><ol><li class="lvl-3"><p>**辐射传输模拟：**RRTM 被用来模拟辐射在大气中的传输和相互作用，包括太阳辐射和地球辐射。这对于研究大气能量平衡、气温、云的形成和降水等过程非常重要。</p></li><li class="lvl-3"><p>**波长范围：**RRTM 可以模拟不同波长范围的辐射传输，包括可见光、红外线和微波。这使得它可以用于分析不同能谱的辐射过程。</p></li><li class="lvl-3"><p>**应用领域：**RRTM 广泛应用于气象模型、气候模型、天气预报系统以及遥感和气象卫星数据的处理中。它有助于改善气象和气候模型的准确性，以便更好地模拟大气和地球的辐射行为。</p></li><li class="lvl-3"><p>**改进版本：**RRTM 有不同版本，包括 RRTM-IR（红外线辐射传输模型）和 RRTMG（RRTM的全光谱版本）。这些版本可能在不同波长范围内具有不同的参数化和改进，以适应不同研究需求。</p></li><li class="lvl-3"><p>**科学研究：**RRTM 的应用涵盖了气候变化、大气化学、云物理学和气象学等多个领域。研究人员使用它来改进对大气过程的理解，并为政策制定者提供有关气候变化和气象事件的信息。</p></li></ol></blockquote><p>  总之，RRTM 是在大气科学中用于模拟辐射传输的重要工具，对于气象预测、气候研究和环境监测都具有重要价值。不同版本的 RRTM 可以用于不同的研究和应用领域。</p><ul class="lvl-0"><li class="lvl-2"><p>**Dudhia：**指 Dudhia 短波辐射参数化方案（Dudhia shortwave radiation parameterization scheme）。这是一种在气象和气候模型中常用的参数化方案，用于模拟短波辐射过程，特别是太阳辐射的传播和相互作用。以下是 Dudhia 短波辐射参数化方案的一些关键特点：</p></li></ul><blockquote><ol><li class="lvl-3"><p>**太阳辐射模拟：**Dudhia 短波辐射参数化方案旨在模拟太阳辐射在大气中的传播、散射和吸收过程。这包括太阳辐射通过大气中的云、气溶胶和气体互动。</p></li><li class="lvl-3"><p>**辐射传输：**该方案考虑了辐射的传输和相互作用，以估算不同垂直层次和水平位置的辐射通量。</p></li><li class="lvl-3"><p>**云和气溶胶的影响：**Dudhia 短波辐射参数化方案还考虑云和气溶胶对太阳辐射的影响，因为云和气溶胶可以散射、吸收或反射太阳辐射。</p></li><li class="lvl-3"><p>**模型适用性：**这个参数化方案通常用于各种气象和气候模型，以模拟太阳辐射对地球表面和大气的影响，包括模拟日照、温度分别和气候现象。</p></li></ol></blockquote><p>  Dudhia 短波辐射参数化方案的具体实现和参数设置可能会因不同的模型版本和研究项目而异。因此，在使用该方案时，研究人员通常需要了解模型文档和配置选项，以确保其与研究目标和模型的匹配。此外，对于特定的气象和气候研究，还可能需要考虑其他短波辐射参数化方案以获得更精确的模拟结果。</p><p>  为了更好的模拟“鲇鱼”形成之前扰动所在的大尺度环境场，这里在最外层区域中使用谱逼近的方法，使用时间7天。在第二层和第三层网格中，谱逼近只在模式开始的24小时之内使用。</p><h4 id="敏感性实验设计">敏感性实验设计</h4><p>  为了探讨海表焓通量及相关的WISHE机制对“鲇鱼”台风形成的影响，设计了两个数值敏感性试验。敏感性试验的设置与控制试验基本相同，唯一的区别是模式最低层的水平风。在敏感性试验中，模式最低层的水平风被设为固定值。</p><blockquote><p><strong>WISHE机制</strong></p><p>  **WISHE（WISHE mechanism）：**是指“Warm Ocean，Moist Atmosphere，and Moist Convection”机制，它是一个用于解释和研究热带气旋（热带风暴和台风）发展的概念性模型。该机制描述了热带气旋的形成和增强过程，特别是关注热带海洋、湿度大气和湿对流等因素的相互作用。以下是WISHE机制的关键要点：</p><ol><li class="lvl-3"><p>**暖海洋：**WISHE机制的第一个要素是暖热带海洋。在热带地区，海水通常较暖，这提供了足够的热能来驱动大气中的湿度和对流。暖海洋表面温度是热带气旋发展的重要起点。</p></li><li class="lvl-3"><p>**湿度大气：**WISHE机制的第二个要素是湿度大气。湿度大气意味着大气中含有大量水汽。这是在热带地区常见的情况，因为暖海洋表面可以蒸发大量水汽到大气中。湿度大气有助于提供热带气旋所需的湿度和能量。</p></li><li class="lvl-3"><p>**湿对流：**湿对流是指在湿度大气中发生的大规模对流运动，其中空气上升并形成云和降水。湿对流是热带气旋发展的关键过程，因为它有助于释放暖湿空气中的潜热，进一步加热大气并增强气旋。</p></li><li class="lvl-3"><p>**正反馈循环：**WISHE机制中的关键思想是正反馈循环。当热带气旋形成时，它开始吸取暖湿空气，这会导致大气中湿度增加，并触发湿对流。湿对流释放的潜热加热会进一步提高气温，使得气旋更强大，继续吸取更多湿度和热能，形成一个正反馈循环，使气旋增强。</p></li><li class="lvl-3"><p>**发展和增强：**通过WISHE机制，热带气旋可以逐渐发展并增强，最终可能形成热带风暴、台风或飓风。</p></li></ol><p>  WISHE机制是对热带气旋发展的重要概念性理论，帮助解释了为什么热带地区的暖海洋和湿气大气是热带气旋形成和加强的理想环境。然而，实际的热带气旋发展受到许多其他复杂因素的影响，包括大气风切变、地形、季节变化等。因此，WISHE机制虽然提供了重要的基本理论，但实际的热带气旋发展仍然具有挑战性，并需要综合考虑多种因素。</p></blockquote><p>海表面通量包括感热通量（Sensible Heat Flux，SHX）和潜热通量（Latent Heat Flux，LHX），可用公式表示为：<br>$$<br>SHX = \rho c_p C_h U_a (\theta_g - \theta_a) \\<br>LHX = \rho L_v C_q U_a (q_g - q_a)<br>\tag{1}<br>$$</p><blockquote><p>其中：</p><ul class="lvl-1"><li class="lvl-2">**SHX：**感热通量，表示单位时间内由海洋表面传输到大气最低层的热量，通常以瓦特每平方米（$W/m^2$）为单位；</li><li class="lvl-2">**LHX：**潜热通量，表示单位时间内由海洋表面传输到大气最低层的潜热（与水汽相变相关的热量），也以瓦特每平方米（$W/m^2$）为单位；</li><li class="lvl-2">**$\rho$：**近海面层的空气密度，通常以每千克每立方米（$kg/m^3$）为单位。</li><li class="lvl-2">**$c_p$：**恒压下的比热，通常以焦耳每千克每摄氏度（$J/(kg\cdot^\circ C)$）为单位；</li><li class="lvl-2">**$C_h$：**感热通量的传输系数，通常为无量纲值；</li><li class="lvl-2">**$C_q$：**潜热通量的传输系数，通常为无量纲值；</li><li class="lvl-2">**$U_a$：**大气水平风速，通常以米每秒（m/s）为单位；</li><li class="lvl-2">**$\theta_g$：**海洋表面温度，通常以摄氏度（$^\circ C$）为单位；</li><li class="lvl-2">**$\theta_a$：**大气最低层温度，通常以摄氏度（$^\circ C$）为单位；</li><li class="lvl-2">**$L_v$：**恒压下水的蒸发潜热，通常以焦耳每千克（$J/kg$）为单位；</li><li class="lvl-2">**$q_g$：**海洋表面的比湿度，通常以千克水蒸气/kg干空气为单位；</li><li class="lvl-2">**$q_a$：**大气最低层的比湿度，通常以千克水蒸气/kg干空气为单位。</li></ul></blockquote><p>  海表通量的大小取决于近地面风速和大气层与海洋之间的热力学差异。本文所设置的两个敏感性试验如下：</p><ol><li class="lvl-3"><p>第一个敏感性试验中，上式中的 $U_a$ 在模式积分36小时后，即2010年10月9日18时被设为 $0m/s$。这意味着，9日18时之后，海表通量为零，即海洋不向大气提供水汽和热量。</p></li><li class="lvl-3"><p>第二个敏感性试验中，9日18时之后，如果上式中的 $U_a$ 大于 $5m/s$，则设为 $5m/s$。这意味着，9日18时之后，WISHE机制所描述的海气相互作用，反馈过程将不再发生。</p></li></ol><p>  这两个敏感性试验中，前者是分析海洋热量和水汽对台风形成的影响，后者是分析WISHE机制对台风形成的影响。下文中将分别用 <strong>OFF</strong> 和 <strong>CAP5</strong> 代表第一和第二个敏感性试验。</p><h4 id="扰动中心定义方法">扰动中心定义方法</h4><p>  不同于形成之后的热带气旋，在形成之前，热带气旋所对应的热带扰动强度较弱，环状结构不明显，中心气压场较为零散。所以这里我们采用涡度质心的方法定义“鲇鱼”形成之前的扰动中心：<br>$$<br>\bar{x} = \sum x_i \zeta_i / \sum \zeta_i \\<br>\bar{y} = \sum y_i \zeta_i / \sum \zeta_i<br>\tag{2}<br>$$</p><blockquote><p>其中， <strong>$\zeta$</strong> 表示相对涡度，下标 i 表示某个区域内的格点。这里我们取半径 200 km 的圆形区域，而涡度则取 1000-600hpa 的平均涡度。</p></blockquote><h4 id="涡度方程诊断">涡度方程诊断</h4><p>  为了更好地研究“鲇鱼”形成过程中中层涡旋的形成和发展过程，这里我们运用涡度方程诊断的方法，等压面上的涡度方程可以写为：<br>$$<br>\frac{\partial \eta}{\partial t} = -\nabla \bullet (V’ \eta) - \nabla \bullet (-\omega k \times \frac{dV}{dp}) + R<br>\tag{3}<br>$$<br>其中 $\eta$ 代表绝对涡度的垂直分量：<br>$$<br>\eta = f + \frac{\partial v}{\partial x} - \frac{\partial u}{\partial y}<br>\tag{4}<br>$$<br>$V’$ 代表相对速度：<br>$$<br>V’ = V - C<br>\tag{5}<br>$$</p><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**$\frac{\partial \eta}{\partial t}$：**表示绝对涡度的变化项，这是绝对涡度 $\eta$ 垂直分量随时间的变化率，表示了涡度的时间演化；</p></li><li class="lvl-2"><p>**$-\nabla \bullet (V’ \eta)$：**表示涡度通量的散度，包括了绝对涡度的水平平流以及拉伸项的影响。</p></li></ul><blockquote><ul class="lvl-2"><li class="lvl-2">**$V’$：**代表相对速度，即实际风速 $V$ 与背景流速 $C$ 之间的差异；</li><li class="lvl-2">**$\eta$：**代表绝对涡度的垂直分量；</li><li class="lvl-2">**$V’ \eta$：**表示相对速度和涡度的点乘，得到了涡度通量的水平分量；</li></ul></blockquote><ul class="lvl-1"><li class="lvl-2">**$- \nabla \bullet (-\omega k \times \frac{dV}{dp})$：**表示了这个垂直涡度输送的散度，考虑了涡度的产生或消耗机制，包括垂直涡度的输送和可能的倾斜效应。</li></ul><blockquote><ul class="lvl-2"><li class="lvl-2">**$- \omega$：**代表垂直速度，通常表示上升或下降的垂直运动；</li><li class="lvl-2">**$k$：**是单位矢量，垂直向上的向量；</li><li class="lvl-2">**$\frac{dV}{dp}$：**表示水平风速随压力的变化率。通常与垂直速度一起考虑；</li><li class="lvl-2">**$-\omega k \times \frac{dV}{dp}$：**表示了垂直速度、单位垂直向上矢量和水平风速梯度之间的叉积，代表了垂直涡度的输送。这一项同时也包含了倾斜项的影响，因为它考虑了垂直速度和水平风速的差异；</li></ul></blockquote><ul class="lvl-1"><li class="lvl-2">**$R$：**表示次网格项。通常情况下，$R$ 项的贡献很小，这里采取与前人相同的处理办法，对 $R$ 忽略不计。</li></ul></blockquote><h4 id="水汽方程诊断">水汽方程诊断</h4><p>  为了更好地分析“鲇鱼”台风形成过程中的水汽演变特征并揭示各物理过程的贡献，我们在数值模拟的基础上，对“鲇鱼”形成过程的水汽演变做诊断分析，所用的水汽方程如下：<br>$$<br>\int_{\tau} \frac{\partial \rho q}{\partial t} d\tau= - \frac{r_0}{g} \int_{P_2}^{P_1} \int_{0}^{2 \pi} qud\lambda dp + \int_{0}^{r_0} \int_{0}^{2 \pi} (r \rho qw)_{P_1} d\lambda dr \\<br>-\int^{r_0}<em>0 \int_0^{2\pi}(r \rho qw) <em>{P_2} d\lambda dr -\int</em>\tau \rho NCd\tau + \int</em>\tau \rho B_vd\tau<br>\tag{6}<br>$$</p><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**$\int_{\tau} \frac{\partial \rho q}{\partial t} d\tau$：**这一项表示在体积 $\tau$ 内水汽的时间变化率积分。它描述了在一定体积内水汽含量的变化趋势；</p></li><li class="lvl-2"><p>**$-\frac{r_0}{g} \int_{p_2}^{p_1} \int_{0}^{2 \pi} qud\lambda dp$：**这一项表示水汽的平流效应。它考虑了在不同压力水平 $(P_1, P_2)$ 上水汽的平流；</p></li></ul><blockquote><ul class="lvl-2"><li class="lvl-2"><strong>$u$：</strong> 是相对于扰动的径向速度，表示气流沿着气旋的半径方向的速度变化；</li><li class="lvl-2"><strong>$q$：</strong> 表示水汽混合比，表示单位质量空气中水汽的质量；</li><li class="lvl-2"><strong>$\lambda$：</strong> 是经度；</li><li class="lvl-2"><strong>$dp$：</strong> 是压力的微小变化；</li></ul></blockquote><ul class="lvl-1"><li class="lvl-2">**$\int_{0}^{r_0} \int_{0}^{2 \pi} (r \rho qw)_{P_1} d\lambda dr$：**这一项表示径向水汽输送到气柱底部（$P_1$ 处）的贡献。它考虑了径向距离 $r$ 内的水汽输送；</li></ul><blockquote><ul class="lvl-2"><li class="lvl-2"><strong>$r_0$：</strong> 是距台风前期扰动中心的距离，$r_0$ 为常数，这里取200km；</li><li class="lvl-2"><strong>$\rho$：</strong> 是空气密度；</li><li class="lvl-2"><strong>$w$：</strong> 是垂直速度；</li></ul></blockquote><ul class="lvl-1"><li class="lvl-2">**$-\int^{r_0}_0 \int_0^{2\pi}(r \rho qw) _{P_2} d\lambda dr$：**这一项表示径向水汽输送从气柱顶部（$P_2$ 处）的贡献。</li><li class="lvl-2">**$-\int_\tau \rho NCd\tau$：**表示在特定体积 $\tau$ 内的总净凝结量，这个量度考虑了液态水汽的净凝结（如果为正值则表示凝结大于蒸发，如果为负值则表示蒸发大于凝结）；</li></ul><blockquote><p><strong>$NC$：</strong> 表示净的凝结量，它表示在一定体积内水汽的凝结和蒸发的净效应。正值意味着水汽净凝结，而负值意味着水汽净蒸发；</p></blockquote><ul class="lvl-1"><li class="lvl-2">**$\int_\tau \rho B_vd\tau$：**表示在特定体积 $\tau$ 内来自底层海洋的水汽贡献；</li></ul><blockquote><ul class="lvl-2"><li class="lvl-2"><strong>$B_v$：</strong> 表示来自海洋的水汽；</li></ul></blockquote></blockquote><p>  $P_1$ 和 $P_2$ 分别表示气柱底部和顶部的气压。这个方程的目的是分析热带气旋形成期间水汽的运动、变化和平衡，考虑了平流、径向输送、凝结或沉降以及水汽的源项。通过分析这个方程，可以更好地理解水汽在热带气旋形成和发展中的作用，对于研究热带气旋的形成机制非常重要。</p><h3 id="台风“鲇鱼”形成过程中中层涡旋的演变及影响">台风“鲇鱼”形成过程中中层涡旋的演变及影响</h3><p>  本章利用高精度数值模式资料分析“鲇鱼”形成过程中中层涡旋的形成和发展机制，以及中层涡旋在形成过程中所伴随的热力学特征；最后讨论中层涡旋在“鲇鱼”形成过程中的作用。</p><h4 id="中层涡旋的整体演变">中层涡旋的整体演变</h4><p>  图2给出了“鲇鱼”形成过程中对流和涡度随时间，经度的演变。图3.2a 和图3.2d 显示，在形成之前，“鲇鱼”扰动经历了两次深对流的爆发。在两次深对流的间隔期间，很少有对流发展。由热带开尔文波触发的第一次对流爆发从10 月9 号06 号开始，第二次对流爆发从10 月10 号06 时开始，然后一直持续到结束。图3.2b-c 和3.2e-f 进一步显示，低层涡度的显著增强发生在第二次深对流爆发期间。而在第一次和第二次深对流爆发的间隔期间，中层涡旋显著增强。</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-09-24-16-36-20.png'/></div><font size = 2; color = natural>图2. （a）由 GFS 再分析资料导出的 $850\ hPa\ 8 ^\circ N - 16 ^\circ N$ 平均风场（矢量），黑体辐射温度（$^\circ C$；阴影）随经度，时间的演变。（b）与（a）类似，但是变量为由 GFS 再分析资料导出的 $850\ hPa\ 8 ^\circ N - 16 ^\circ N$ 平均涡度（$10^{-5} s^{-1}$）。（c）与（a）类似，但是变量为由 GFS 再分析资料导出的 $600\ hPa\ 8 ^\circ N - 16 ^\circ N$ 平均涡度（$10^{-5} s^{-1}$）。（d）-(f)与（a）-（c）类似，但是变量分别为模式导出的最大反射率（dbz）和 850 hPa 风场，（e）850 hPa 涡度（$10^{-5} s^{-1}$）和（f）600 hPa 涡度（$10^{-5} s^{-1}$）。</font><p><font size = 2; color = grey>PS：黑体辐射温度通常用来表示大气中的辐射热平衡，以及不同高度和时间的温度分布。黑体辐射温度随着高度、时间和地理位置的变化而变化.</font></p><blockquote><p>**GFS（Global Forecast System）再分析资料：**由美国国家海洋和大气管理局（NOAA）的国家中心为环境预报（NCEP）的全球模式系统生成的气象数据。这些数据用于分析和研究大气和气候现象，以改进天气预报和气候模型。以下是关于GFS再分析资料的一些关键信息：</p><ol><li class="lvl-3">**再分析数据：**GFS再分析数据是通过将观测数据与数值模型的输出进行融合，使用先进的数据同化技术，生成历史上的大气参数的连续记录。这些数据包括温度、湿度、风速、气压、降水等等，通常以多层次和多时间步骤的形式提供。</li><li class="lvl-3">**全球覆盖：**GFS再分析数据提供了全球范围内的气象信息，涵盖了地球的大气条件。这些数据在地球各个地区的气象研究和监测中非常有用。</li><li class="lvl-3">**时间分辨率：**GFS再分析数据通常以不同的时间分辨率提供，最常见的包括1小时、3小时、6小时和24小时等。这意味着您可以获取不同时间精度的数据，以满足特定研究或预测需求。</li><li class="lvl-3">**空间分辨率：**GFS再分析数据通常居勇不同的水平和垂直分辨率。水平分辨率表示数据在地球表面上的空间精度，通常以度数为单位。垂直分辨率表示数据在大气垂直上的分层情况，通常以压力层或高度层表示。</li><li class="lvl-3">**用途：**GFS再分析数据在气象学、气候学、环境科学和天气预报等领域中广泛应用于研究和建模。研究人员和气象学家使用这些数据来了解过去的气象事件、制作气象图表、验证模型、开展气候分析等。</li></ol><p>GFS再分析数据通常可以通过 NOAA 等气象机构的网站或数据存档中心获取，以支持各种研究和应用。这些数据对于改进天气预测、研究气候变化以及了解大气现象非常有价值。</p></blockquote><p>  根据以上所述的对流，中低层涡旋的演变，以及为了之后讨论的方便，这里我们把“鲇鱼”的形成过程分为3 个阶段：第一阶段为开尔文波带来的深对流的爆发阶段，时间段从10 月9 号06 时开始一直到10月10 号06 时；第二阶段为对流消散以及中层涡旋的增强阶段；第三阶段为深对流爆发，低层涡旋增强以及“鲇鱼”的形成阶段。</p><blockquote><p>**开尔文波（Kelvin wave）：**是一种大气和海洋中的波动现象，通常是指大气中的大尺度波动，特别是赤道附近的波动。开尔文波的名称来源于其发现者威廉 汤姆森（William Thomson），也称为开尔文勋爵。以下是有关开尔文波的一些关键特征和信息：</p><ol><li class="lvl-3">**波动类型：**开尔文波通常是一种大气中的波动，沿赤道附近传播。它们可以是大气中的大尺度波动，也可以是海洋中的波动，通常与赤道附近的温度、风场和海洋流动有关；</li><li class="lvl-3">**传播方向：**开尔文波的传播方向通常是东向（从东向西传播）或向西（从西向东传播），取决于波的类型。东向的开尔文波是一种大气波动，而西向的开尔文波是一种海洋波动；</li><li class="lvl-3">**与赤道交互：**开尔文波与赤道附近的克里奥利力相互作用，导致它们以东向或西向的速度传播。这种相互作用是由于地球自转引起的，并且在大气和海洋中都起作用；</li><li class="lvl-3">**气候和天气影响：**开尔文波对全球气候和天气系统产生影响。它们可以影响赤道地区的海洋温度和气候变化，并对厄尔尼诺和拉尼娜等大气现象产生影响；</li><li class="lvl-3">**研究和模拟：**开尔文波是大气和海洋研究的重要对象，科学家使用模型和观测数据来研究它们的特性和影响。这些波动对于气象学、气候学和海洋学等领域的研究具有重要意义。</li></ol><p>总之，开尔文波是大气和海洋中的一种波动现象，与赤道附近的物理过程紧密相关，对全球气候和天气系统产生影响。它们是气象和海洋研究中的重要主题之一。</p></blockquote><p>  中层涡旋的形成原因有两方面：一是层云引起的中层辐合；二是深对流向上的垂直涡度输送；在中层涡旋形成时，地面为反气旋性涡度，同时低层暖而干，动力学以及热力学条件都不利于对流活动的发展。但是，随着热力学场和动力学场的调整，浅对流在“鲇鱼”扰动中心爆发。一方面，浅对流向上输送水汽，增湿中层大气；另一方面，其引起的辐散也导致了中层涡旋强度的减弱。在第二次对流爆发期间，中层涡旋的强度随着对流的发展呈振荡式变化。在深对流期间以及层云期间，中层涡旋的强度增强；而在浅对流期间，其强度有所减弱。</p><p>  在“鲇鱼”的形成过程中，中层涡旋起到了双重作用。一方面，在中层涡旋的形成过程中，低层涡度的强度显著减弱，这对于低层气旋性环流强度的增强是不利的；另一方面，与中层涡旋耦合的冷心又有利于对流不稳定能量的累积，这对于对流活动而言是有利的。敏感性试验表面：中层涡旋的形成是不利于“鲇鱼”的形成的。</p><h3 id="台风“鲇鱼”形成过程中水汽变化特征">台风“鲇鱼”形成过程中水汽变化特征</h3><p>  在“鲇鱼”的形成过程中，台风前期扰动的对流呈准周期性变化，与之相对应，扰动中的总水汽含量呈现出振荡式增加的特征。当扰动中浅对流为主时，总水汽含量迅速增加，水汽主要来源于海洋蒸发和水汽通量的水平辐合。并且水汽通量的水平辐合的贡献远大于海洋蒸发的贡献。当扰动中水汽显著增加后，深对流开始大量爆发，与深对流伴随的强降水引起的水汽消耗不仅超过了水汽通量水平辐合的贡献，而且有时会大于水汽通量水平辐合和海洋蒸发的共同贡献，从而使得扰动中总水汽含量停止增加并略微下降。</p><p>  在分析台风前期扰动中总水汽含量的基础上，本文进一步探讨了大气不同高度层中水汽演变的特征。结果表面，由于水汽通量的水平辐合和海洋蒸发共同贡献的水汽含量大于边界层向上输送的水汽含量，大气边界层中的水汽在“鲇鱼”的形成过程中总体是呈上升趋势，仅在“鲇鱼”台风临近形成时刻出现短时急剧下降。与边界层相比，对流层低层的水汽含量远大于边界层和对流层高层。在浅对流期间，对流层低层的水汽含量由于浅对流不断地向上输送而增加，而深对流期间则由于净水汽垂直通量减弱，以及降水凝结增加而略有下降。对于对流层高层而言，水汽的主要来源是深对流向上的水汽输送，而水汽的汇则是深对流产生的强烈凝结。</p><blockquote><p>**水汽的汇：**指将大气中的水汽从气态状态转变为液态或固态状态的过程。这通常包括降水和云的形成。以下是一些与水汽的汇相关的主要过程：</p><ol><li class="lvl-3">**降水：**降水是最常见的水汽的汇过程。当大气中的饱和水汽含量超过了气温和气压条件下的饱和点时，水汽会凝结成水滴或冰晶，并从大气中降落到地面。降水包括雨、雪、冰雹和霰等形式。</li><li class="lvl-3">**云的形成：**云是由大气中的水汽凝结而成的微小水滴或冰晶的集合体。当空气中的水汽饱和时，水汽会凝结在微小的颗粒或气溶胶上，形成云滴。云的形成是水汽的一种汇。</li><li class="lvl-3">**降露和霜：**在夜间，当地面温度下降到露点以下时，大气中的水汽会凝结在地面上，形成露水。当温度下降到冰点以下时，水汽会直接从气态转变为冰晶，形成霜。</li><li class="lvl-3">**沉降和沉积：**在极端寒冷的条件下，水汽可以直接从气态状态转变为固态，而不经过液态。这种过程称为沉降，包括雪和冰的沉降。</li><li class="lvl-3">**冷凝核：**冷凝核是促使水汽凝结的微小颗粒或气溶胶，它们在云和雨滴的形成中起着关键作用。</li></ol><p>水汽的汇是大气中水循环的一部分，它有助于维持地球上的水资源平衡，并对气象和气候产生重要影响。不同的水汽汇过程可以导致不同形式的降水和云的形成，对地球的气候和生态系统产生深远的影响。</p></blockquote><p>  尽管总水汽含量以及边界层水汽含量的诊断分析均表明，在“鲇鱼”台风的形成过程中，扰动前期系统中心区域的海洋蒸发贡献的水汽含量远小于水汽通量的水平辐合贡献的水汽含量，但是海洋蒸发的贡献仍然是必不可少的。因为海洋蒸发可以通过增加扰动中心区域以外的水汽含量间接影响向内的水平水汽输送通量，从而影响扰动的增湿。因此对“鲇鱼”形成过程而言，海洋蒸发是不可或缺的。</p><p>  基于上述工作，我们发现“鲇鱼”形成过程中扰动的增湿并不是一直进行的，而是与对流活动密切相关：浅对流期间增湿、深对流期间增湿变缓甚至略微变干。通过一次次对流活动，“鲇鱼”前期扰动中的水汽振荡式增加，支持了“鲇鱼”的形成。在浅对流主导的增湿过程中，水汽水平辐合贡献的水汽远大于海洋蒸发贡献的水汽。但是进一步的分析和敏感性试验均显示，海洋蒸发和 WISHE 机制对于“鲇鱼”的形成都是必不可少的。</p><h3 id="初始水汽垂直分布对于热带气旋的影响">初始水汽垂直分布对于热带气旋的影响</h3><p>  上述研究结果表明，较高的大气水汽含量有利于深对流的发生，进而促进热带气旋的形成。但这些工作隐含了一个问题：<strong>如果大气中总水汽含量相同，一个主要集中在低层，一个主要集中在中层，哪种水汽的垂直分布更有利于热带气旋的形成？</strong></p><p>  通过本章设计的一组理想化试验得出：如果大气中总水汽含量相同，那么中层较湿的水汽垂直分布更有利于热带气旋的形成。</p><p>  在中层较湿的敏感性试验中，系统发展得更快，这是因为中层的相对湿度较高，有助于深对流的形成和发展。相比之下，控制试验中由于大气中层的相对湿度较低，深对流的发展受到限制。</p><p>  此外，在后期阶段，敏感性试验中深对流的发展较快，这也有助于热带气旋的形成。在敏感性试验中，大气中层得到了进一步的增湿，避免了边界层的快速冷却和干化现象，从而保持了边界层的高温高湿条件，有利于深对流的发展。</p><p>  因此，总的来说，中层较湿的水汽垂直分布更有利于热带气旋的形成，因为它有助于深对流的发展和系统的快速增强。这种分布可以提供更多的水汽和热能，促使热带气旋的发展。</p><blockquote><p>**对流抑制能量（CIN）：**指大气中抑制或减弱对流活动的能量或机制。对流是指大气中的上升气流和湿度结合，导致云的形成、降水和气象现象的发生。对流抑制是指某种因素或机制减弱或抑制了这种对流活动，通常表现为降水减少或停止、天空晴朗、气温升高等。以下是一些可能导致对流抑制的主要因素和机制：</p><ol><li class="lvl-3">**下沉气流：**从高层大气向地面方向下沉的气流。当大气中存在强烈的下沉气流时，它们会抑制上升气流的形成，从而减少对流活动。这种现象常见于高压系统的中心，导致晴天和干燥的天气；</li><li class="lvl-3">**大范围的高压系统：**通常会导致对流活动的减弱，因为它们通常与下沉气流相关联。这种天气模式可能会在一段时间内抑制降水和云的形成；</li><li class="lvl-3">**干空气质量：**干燥的空气质量通常会限制水汽的供应，从而减少了对流活动的潜力。干燥的空气能够抑制云的形成，并使降水变得不太可能；</li><li class="lvl-3">**大气不稳定性的减小：**大气中的不稳定性通常有助于对流活动的发生。当大气不稳定性减小时，上升气流的强度和高度会降低，从而抑制对流；</li><li class="lvl-3">**大气温度逆温：**逆温是指大气层中温度随高度上升而增加的情况。当存在逆温时，它可以阻止上升气流的形成，从而抑制对流。</li><li class="lvl-3">**大气动力学系统：**大气中的风场和气压系统也可以影响对流活动。例如，特定的大气环流模式可能会抑制或增强对流。</li></ol><p>对流抑制能量的理解对气象学和气候研究非常重要，因为他可以帮助科学家预测干旱、热浪、降雨不足等气象现象，并对农业、水资源管理和自然灾害预防产生影响。</p></blockquote><h3 id="本文存在的不足之处">本文存在的不足之处</h3><ol><li class="lvl-3"><p>本文说明中层涡旋对于热带气旋形成的作用，但是，实际大气中总是会存在一定程度的蒸发冷却，本文并没有说明；</p></li><li class="lvl-3"><p>在“鲇鱼”的形成过程中，对流呈现出明显的周期性特征，这个特点曾经出现在许多其他的热带气旋的形成过程中,中层涡旋的强度，以及水汽的变化都因对流的周期性而呈现出变化。但是本文并没有详细讨论对流周期性特征的原因，这是值得进一步讨论的问题；</p></li><li class="lvl-3"><p>关于不同高度的水汽垂直分布对于热带气旋形成的影响，本文只设计了两个试验，后续需要对其进行细分。</p></li></ol><br><font size=2; color=grey>[1]. How the ocean shapes weather and climate, World Meteorological Organization,2021.<br>[2]. 卓立. 热带气旋形成中中层涡旋与水汽的演变特征[D].南京大学,2021.DOI:10.27235/d.cnki.gnjiu.2020.002186.<br>[3]. National Center for Atmospheric Research (NCAR) (2019). WRF (the Weather Research and Forecasting model), Model Item, OpenGMS, https://geomodeling.njnu.edu.cn/modelItem/950852f9-bc9c-4092-9808-a36c4ae4d0c5</font>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
            <tag> Ocean </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>新手村任务1</title>
      <link href="/posts/20230914000000/"/>
      <url>/posts/20230914000000/</url>
      
        <content type="html"><![CDATA[<h2 id="海洋流场数据同化方法与应用的研究">海洋流场数据同化方法与应用的研究</h2><p><font size=2; color=grey>论文信息：马寨璞，浙江大学博士学位论文</font></p><h3 id="div-align-center-摘要-div"><div align="center">摘要</div></h3><p>  本文以三维陆架海模型（HAMSOM）作为数据同化系统的模型部分，深入研究了数据同化的理论方法和在海洋流场数据处理中的应用，对海洋场的数据同化方法提出了行之有效的改进，并将中国黄、东海区域内的TOPEX/POSEIDON（T/P）数据和理论模式的计算结果相结合，进行同化处理，获得了更接近于真实的结果。</p><blockquote><p>**三维陆架海模型（HAMSOM）**是一种用于研究海洋和海底地质的数学模型。这种模型被用来模拟和分析陆架海区域的各种物理和地质过程，包括海洋水流、海底地形、沉积物运转、生态系统动态等等。以下是关于三维陆架海模型的一些基本信息：</p><ol><li class="lvl-3">**物理过程模拟：**三维陆架海模型可以用来模拟海洋中的物理过程，如海水运动、温度和盐度分布、海洋循环等。这对于理解气候变化、海洋环境和天气模式等方面非常重要</li><li class="lvl-3">**地质过程模拟：**该模型也可用于模拟陆架海底地质过程，如地壳运动、海底地形的演变、地震和火山活动等。这对于理解板块构造和地球内部动力学有重要意义。</li><li class="lvl-3">**生态系统模拟：**三维陆架海模型可以用来模拟海洋生态系统的动态，包括生物群落的分布、物种互动、生态链的演变等。这对于海洋保护和资源管理非常有用。</li><li class="lvl-3">**环境影响评估：**该模型还可用于评估人类活动对陆架海环境的影响，如渔业、油气开发、海岸防护工程等。通过模拟，可以预测和减轻环境影响。</li><li class="lvl-3">**数据驱动：**三维陆架海模型通常依赖于大量的实测数据和卫星观测数据来验证和调整模型，以确保准确性和可靠性。</li><li class="lvl-3">**计算复杂性：**这种模型通常需要大规模的计算资源，因此要在三维空间中模拟多种复杂的物理和地质过程。</li></ol><p>这些模型的应用领域包括海洋科学研究、气候模拟、海洋资源管理、环境保护等。三维陆架海模型是一个强大的工具，有助于我们更好地理解和管理陆架海区域的复杂系统。</p></blockquote><blockquote><p>**TOPEX/POSEIDON（T/P）**是一颗美国-法国合作的卫星任务，旨在测量地球海洋表面的高度，并且用于研究海洋的动态、气候变化、海洋循环等。以下是关于T/P卫星的一些基本信息：</p><ol><li class="lvl-3">**任务目标：**T/P卫星任务的主要目标是测量全球海洋表面高度，这对于研究海洋动力学、洋流、海平面上升、气候变化等具有重要意义。卫星携带有高精度的雷达测高仪，可实现高度测量。</li><li class="lvl-3">**卫星启动：**T/P卫星于1992年8月10日由美国国家航空航天局（NASA）和法国国家空间研究中心（CNES）合作发射升空。</li><li class="lvl-3">**测量方法：**卫星通过发射雷达信号并测量信号返回的时间来测量海洋表面的高度。这种测高仪能够提供非常精确的海洋表面高度数据。</li><li class="lvl-3">**数据应用：**T/P卫星数据在气象学、海洋学、气候研究以及海洋资源管理等领域中被广泛应用。这些数据有助于监测全球海平面上升、研究洋流的变化、预测气象和气候事件等。</li><li class="lvl-3">**后续任务：**T/P任务之后，还有一系列类似的卫星任务，如Jason-1、Jason-2和Jason-3等，继续收集海洋表面高度数据，并持续对全球海洋的变化进行监测。</li><li class="lvl-3">**数据获取：**T/P卫星数据通常可以通过NASA、CNES以及其他相关机构的数据存档和分发渠道获得，以供科研和应用使用。</li></ol><p>这些卫星数据对于研究全球海洋和气候系统的变化非常重要，可以提供宝贵的信息，有助于科学家们更好地理解地球系统的复杂性。</p></blockquote><p>  对数据同化问题的研究，尤其针对目前我国海区的数据同化应用研究较少这一情况。本文在前人文献的基础上，进行了方法及应用上的研究。这些成果包括：</p><p>   - 建立考虑了时间相关的方差矩阵和时空相关的最优插值算法：</p><p>   <font size = 2; color = natural>时空相关的最优插值算法是一种用于从有限的空间和时间观测数据中估计或预测未来或未观测位置和时间点的数值方法。这些插值算法可用于多个领域，包括气象学、环境科学、地理信息系统（GIS）、地质学等，其中时空数据的插值和预测通常具有挑战性，因为它们需要考虑时空相关性和变化。以下是一些常见的时空相关的最优插值算法：<br>   - **Kriging：**Kriging是一种统计插值方法，广泛用于时空相关数据的插值。它考虑了数据点之间的空间和时间相关性，并利用半变异函数来模拟数据的空间和时间变异性。Kriging还提供了估计误差的信息，因此在估计不确定性时非常有用。<br>   - **Cokriging：**Cokriging是Kriging的扩展，它允许在插值时同时使用多个相关变量，例如，同时考虑空气温度和湿度的时空相关性。这可以提高插值的准确性。<br>   - **模型插值：**模型插值方法将时空数据建模为一组数学方程，这些方程可以捕捉到数据的时空关系。例如，趋势面模型可以用来建模数据的趋势，而周期性模型可以考虑数据的季节性变化。<br>   - **径向基函数插值：**径向基函数插值方法使用径向基函数来逼近时空数据。这些基函数的形状可以根据数据的时空特性进行调整。<br>   - **地统计学方法：**地统计学方法结合了地理信息系统（GIS）和空间统计学的原理，用于处理空间和时间数据的插值和分析。它们通常考虑地理上的特殊性，并尝试将这些特性纳入插值过程中。<br>   - **神经网络：**深度学习方法如卷积神经网络（CNN）和循环神经网络（RNN）也可以用于时空数据的插值。这些方法可以学习时空数据的复杂模式和关系。<br>   - **插值工具包：**有许多地理信息系统（GIS）和科学计算软件提供了各种插值工具包，例如ArcGIS中的插值工具箱、R中的gstat包等，这些工具包通常包括多种插值方法供用户选择。<br>  选择适当的时空插值方法取决于数据的性质、研究问题和可用的计算资源。通常，最优的方法是结合领域知识和实际数据特性来选择合适的插值方法。此外，考虑到时空数据的不确定性也是非常重要的，因此在插值时要估计和报告估计误差。<br></font><br>   - 对卡尔曼滤波算法进行了SVD简化以及建立了显式的状态转移矩阵；<br>   <font size = 2; color = natural>卡尔曼滤波（Kalman Filtering）是一种用于估计系统状态的递归迭代算法，特别适用于线性动态系统。它是由Rudolf E. Kálmán于1960年首次提出的，因此得名。卡尔曼滤波广泛应用于估计动态系统的状态，例如，飞行器导航、车辆定位、金融预测等领域。<br>  卡尔曼滤波的主要思想是通过融合系统的动态模型（通常表示为状态转移方程）和测量模型（通常表示为观测方程）来估计系统的状态，同时考虑了系统的不确定性。以下是卡尔曼滤波算法的基本步骤：<br>   - **初始化：**首先，需要初始化系统的状态估计和协方差矩阵。通常，这些初始值可以通过系统的先验知识或测量得到。<br>   - **状态预测：**根据系统的动态模型（状态转移方程），通过预测当前时刻的状态和状态协方差矩阵。这一步估计了系统在没有新测量数据的情况下的状态。<br>   - **测量更新：**接下来，使用测量模型（观测方程）将最新的测量数据与状态预测进行比较。通过卡尔曼增益（Kalman Gain），卡尔曼滤波器会根据测量的可信度来融合测量数据和状态预测，从而得到更精确的状态估计。<br>  <font color=grey>**卡尔曼增益（Kalman Gain）**是卡尔曼滤波算法中的一个关键概念，它用于将测量数据与状态估计进行融合，从而得到更精确的状态估计。<br>  卡尔曼增益的作用是根据系统模型和测量模型的不确定性来确定在状态更新中给予哪个模型更多的权重。具体来说，卡尔曼增益用于调整状态预测和测量更新之间的权衡，以便更好地估计系统的真实状态。<br>  卡尔曼增益的计算通常可以表示为以下的数学表达式：<br>$$ K = \frac {P^- H^T} {HP^- H^T + R} $$<br>  其中：<br>   - $K$ 是卡尔曼增益。<br>   - $P^-$ 是状态协方差矩阵的预测（先验）估计，表示状态预测的不确定性。<br>   - $H$ 是观测矩阵，用于将状态映射到测量空间。<br>   - $R$ 是测量噪声的协方差矩阵，表示测量的不确定性。<br>  卡尔曼增益 $K$ 的计算考虑了系统预测的不确定性 $P^-$、测量的不确定性 $R$，以及系统模型和测量模型之间的关系。它决定了在状态更新中，应该给予测量多大的权重，以便得到更准确的状态估计。<br>  在卡尔曼滤波算法中，卡尔曼增益的计算是迭代的过程，它在每个时间步都会根据当前的状态估计和测量数据进行更新，从而实现递归的状态估计。这样，卡尔曼滤波可以在不断获得新测量数据时，动态地调整状态估计，以适应系统的变化。<br></font><br>   - **状态估计更新：**使用融合后的测量数据更新状态估计和状态协方差矩阵。这一步会更新系统的状态估计，并考虑到新测量数据的影响。<br>   - **重复迭代：**卡尔曼滤波是一个递归算法，它会在每个时间步重复进行上述状态预测和测量更新的过程，以不断更新系统状态的估计。<br>  卡尔曼滤波的关键优点在于它能够在不确定性的环境中提供最优的状态估计，并且能够有效地处理动态系统的变化。然而，卡尔曼滤波的局限性在于它要求系统的动态和测量模型必须是线性的，且需要提前知道系统的统计特性（均值和协方差）。<br>  对于非线性系统，扩展卡尔曼滤波（Extended Kalman Filter，EKF）和粒子滤波（Particle Filter）等方法是卡尔曼滤波的扩展和变种，用于处理更复杂的系统模型。这些方法通过非线性状态转移和观测方程的线性化或蒙特卡洛采样等技术，使得卡尔曼滤波可以应用于更广泛的应用领域。<br></font><br>   - 将T/P实时卫星数据进行调和分析并与数值模型进行同化处理。</p><p>具体内容如下几个方面：</p><ol><li class="lvl-3"><p><strong>建立时间相关的协方差矩阵处理方法</strong><br>  在估值类的同化方法中，观测数据与理论模型相结合的桥梁是各自的协方差矩阵。在确定协方差矩阵的时候，以往的做法是将所有不同观测时刻的数据当作同一时刻的数据应用；本文在形成协方差矩阵时，不仅考虑空间相关，而且应用了时间相关，对观测数据的应用依照其得到时间的不同分别处理到协方差矩阵的建立中，并根据其在时间上的相关强弱给予不同的权重值，使得到观测数据的应用更接近实际情况。</p></li></ol><blockquote><p>**时间相关的协方差矩阵：**是一种用于描述时间序列数据中观测值之间的相关性随时间变化的矩阵。它通常用于分析和建模时间序列数据中的相关性结构，以便更好地理解数据的动态性质。</p></blockquote><ol start="2"><li class="lvl-3"><p><strong>应用动态最优插值算法进行渤海海表温度同化</strong><br>  传统的最优插值算法没有考虑观测数据的时间错位。本文首先推导了既考虑空间相关，又考虑时间相关的最优插值算法，由于应用了时间相关的协方差矩阵，就使这个算法具有动态处理时间错位的观测数据的能力。随后，本文应用理论模型数据和模拟观测数据进行了并行实验，将动态插值算法应用到渤海海表温度场的计算中，同化结果兼顾理论模型结果和模拟观测结果，在方差意义上显示出最优特性，验证了本文所提出的方法改进的正确性。</p></li><li class="lvl-3"><p><strong>应用SVD分解，推导了简约形式的卡尔曼滤波方法，并直接建立了显式的状态转移矩阵</strong><br>  卡尔曼滤波法无法直接应用于海洋，其主要原因是增益矩阵的计算量太大。本文根据“最大限度保留原来的主要信息，尽可能地简化计算”的原则，应用SVD分解推导了简约形式的卡尔曼滤波方法，得到了该方法的简约表达公式，同时，还得到了截断误差部分的伴随发展公式，它可用于探讨截差本身的动态发展。<br>  另外，本文成功应用反向量表述的方法将通常需要迭代得到的卡尔曼状态转移矩阵表述为可直接计算的显式表达形式。<br>  上述两个方面的改进节省了数据同化卡尔曼滤波法的计算量，提高了效率，对时效性很强的海洋预报计算很有意义。</p></li><li class="lvl-3"><p><strong>对T/P数据进行调和分析，并将其结果与理论模型数据进行同化处理，使结果更接近于真实值</strong><br>  对卫星数据如何进行处理和应用是一个重要的课题。本文首先使用黄、东海沿岸60个验潮站实际观测得到的调和常数进行同化处理，有效地改进了理论模式的结果。随后，本文将美国T/P卫星数据集的第1～第150周期的数据进行调和分析，获得了黄、东海区域的10条轨道撒花姑娘的M2分潮的调和常数。在此基础上，本文进一步应用最优插值法，将理论模型结果和卫星数据调和结果进行同化处理。获得了更接近于真实值的同化结果。</p></li></ol><p>**关键词：**数据同化，动态最优插值，卡尔曼滤波，T/P数据</p><h3 id="div-align-center-第一章-绪-论-div"><div align='center'>第一章  绪 论</div></h3><h4 id="1-1-本论文研究的重要意义">1.1 本论文研究的重要意义</h4><p>  海洋流场的研究有两种方式：a. 使用数值型模型进行研究；（缺点：只能近似的反映海洋流场规律性的特征）b. 对海洋流场进行直接观测。（缺点：由于观测设备的局限和观测点物理量的随机变动，因此观测结果具有不可避免的系统误差与随机误差）<br>  为了解决上述问题，采用数据同化方法，将观测数据与理论模型结果相结合，吸收两者的优点，以期得到更接近真实值的结果。<br>  为了充分利用温度数据，采用时间相关的数据同化方法来处理不同时刻的数据，使其更具有真实性。<br>  为了更好的将卡尔曼滤波算法应用到海洋上面，采用SVD简化卡尔曼方法和直接显式建立状态转移矩阵的方法，节省了卡尔曼滤波算法的计算量，提高了效率，对时效性很强的海洋预报计算很有意义。<br>  为了更好的将理论模型结果和卫星数据调和结果进行同化处理，使用最优插值算法，获得更接近于真实值的同化结果。这对于更准确的确定潮汐的等振幅线和等迟脚线分布具有重要意义。<br>  <strong>数据同化研究还具有很大的实际意义：</strong></p><blockquote><ol><li class="lvl-3"><p>通过数据同化可进行参数估计。区域性的场估计可通过边界条件估计而显著地改进。对于多学科的海洋科学，参数估计尤其充满希望，其对于理解海洋过程、监测环境变化、海洋资源管理以及气象和气候研究都至关重要。</p></li><li class="lvl-3"><p>当在有足够数据但动力模型有点欠缺的情形下进行流场估计时，同化的数据能够补偿动力模型的欠缺。因此它可以改进场估计，使之与客观自然相一致。</p></li><li class="lvl-3"><p>数据同化可用来进行海洋预报。通过持续的数据同化过程可以将可预见性误差控制在允许的范围内。这也是数据同化在海洋上的主要应用之一。</p></li></ol></blockquote><p>综上所述，对海洋流场数据同化方法及其应用的研究具有十分重要的意义。一方面不仅可以借用观测数据和模式两者各自的优势，得到更接近客观自然的结果。另一方面，可以加深对海洋运动状态的了解，掌握海洋运动更准确的规律，为人类社会的发展服务，推动社会进步和海洋科技进步。fdssdsdasdadas</p><h4 id="1-2-数据同化系统的结构及其方法分类">1.2 数据同化系统的结构及其方法分类</h4><h5 id="1-2-1-数据同化系统的结构">1.2.1 数据同化系统的结构</h5><p>  一般的状态过程与参数估计如图所示：</p><div align = 'center'><img src = 'https://pzxnys.github.io/images/2023-09-16-15-35-50.png'/></div><div align='center'><font size = 2>数据同化系统结构图</font></div><p>  上图所示为海洋观测与预报系统(简称OOPS)的示意性结构，在一般的非线性数据同化系统中，有许多的重要反馈机制，图中给出了两种反馈机制：（1）预报提供了改变到实时的结构、实例与误差的有效采样机会–自适应采样；（2）为了同化而收集的数据，可应用于后报模型的验证试验，这可界定模型的不足，从而将模型加以改进。一个完整的数据同化系统包括以下三个部分：<br>  （1）一系列的观测数据集；（2）一个动力模型；（3）数据同化的融合方案。<br>  现代的多学科OOPS一般都有与模型和采样相容的嵌套网络。在数据同化中，其核心的概念是：误差、误差的估计和误差模型。其中，观测误差包括：观测仪器误差；环境噪声；采样误差；传感仪器误差。动力模型误差：所有的海洋模型都不完善，误差多数来自对物理模型的逼近、尺度的大小、离散化方法。</p><h5 id="1-2-2-数据同化的方法与分类">1.2.2 数据同化的方法与分类</h5><p><font size=2; color=natural>PS：作者在论文中提供的分类概念为 Robinson 和 Pierre 提供的，然而随着科技的发展，如今的海洋数据同化方法已有所变化，故下面为较新的分类方法。</font><br>  海洋数据同化方法可以根据其基本原理和实现方式进行分类。以下是海洋数据同化方法的一些常见分类：<br>   1. **估值理论类方法：**估值理论类方法基于统计估计原理，使用卡尔曼滤波、扩展卡尔曼滤波（EKF）、四维变分数据同化（4D-Var）等技术，将观测数据与数值模型相结合。这些方法通常用于调整模型的初始条件和参数，以逼近观测数据。<br>   2. **粒子滤波和蒙特卡洛方法：**粒子滤波方法使用随机粒子集合来表示模型状态的分布，并通过重要性采样和权重更新来估计状态。蒙特卡洛方法基于随机采样和蒙特卡洛积分，用于估计状态和参数。<br>   3. **深度学习方法：**深度学习方法包括神经网络、卷积神经网络（CNN）、循环神经网络（RNN）等，用于从海洋观测数据中学习模型的状态和参数。深度学习方法可以用于非线性问题和大数据集。<br>   4. **集合方法：**集合方法使用一组不同的初始条件或模型参数来生成多个模型集成，然后使用统计技术（如：集合平均、集合方差）来融合这些模型结果。这可以提高对不确定性的估计。例：集合卡尔曼滤波（Ensemble Kalman Filter，EnKF）海洋数据同化、集合方法数据同化等。<br>   5. **贝叶斯方法：**贝叶斯方法基于贝叶斯统计理论，将观测数据和先验信息相结合，以估计模型状态和参数的后验分布。这些方法通常使用马尔科夫链蒙特卡洛（MCMC）技术来采样后验分布。</p><p>  这些分类方法有助于科学家和工程师根据其海洋数据同化问题的特点和可用的观测数据选择适当的方法。不同方法在处理非线性、高维度、大数据集和不确定性等方面具有不同的优势和限制。选择适合的方法需要考虑问题的复杂性和可行性。</p><h4 id="1-3-数据同化发展的现状">1.3 数据同化发展的现状</h4><p>  对数据同化问题的研究，和国外相比，国内的研究起步较晚，国外的研究起步早、发展快。无论是在利用常规观测资料方面，还是在利用卫星遥感资料方面，国外都已经做了大量的研究工作。为把最优秀的数据同化技术引入气象、海洋业务打下了坚实的基础。</p><h5 id="1-3-1-数据同化方法">1.3.1 数据同化方法</h5><p><font size=2; color=natural>PS:由于该篇论文较早，此处不再同步更新发展现状，而是介绍在海洋数据同化中使用的一些方法。</font><br><br></p><p><strong><div align = center><font color = green> 直接插入法或重新初始化法 </font></div></strong></p><p>  <strong>直接插入法或重新初始化法</strong>是一种简单的同化方法。</p><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**直接插入法：**是一种通过将观测数据直接嵌入到数值模型的初始条件中来进行数据同化的方法。这意味着模型的初始状态被观测数据所取代，从而使模型的输出更接近观测数据。这种方法通常用于短期预测或短期模拟，因为它可能会忽略模型内部的物理过程和演化。它在需要立即将模型输出与观测数据一致的情况下非常有用，例如天气预报中的现场初始化。</p></li><li class="lvl-2"><p>**重新初始化法：**是一种将观测数据与数值模型的初始条件相结合，但不是直接替换初始条件。相反，它通过在一段时间后重新设置模型的初始条件，使模型逐渐适应观测数据。这种方法通常用于长期模拟和预测，因为它更好地保留了模型的物理一致性。通过逐渐调整初始条件，模型可以在一段时间内逼近观测数据。</p></li></ul></blockquote><p><strong><div align = center><font color = green> 松弛法（Relaxation Method）</font></div></strong><br>  **松弛法（Relaxation Method）**是一种常用的数值技术，用于将观测数据与数值模型相结合以改进模型的状态或参数。松弛法通常用于寻找最优的模型状态或参数，使模型的输出与观测数据更加一致。以下是关于从松弛法在海洋数据同化的一些基本概念：<br><font size=2; color=natural>PS:此方法类似于模型调参工具。</font></p><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**基本原理：**松弛法的基本思想是通过迭代过程，逐渐调整模型的状态或参数，使模型输出与观测数据逼近。它通常使用一个称为&quot;松弛因子&quot;的参数来控制调整的幅度。这个因子可以是一个常数或随时间变化。</p></li><li class="lvl-2"><p>**状态调整：**在海洋数据同化中，松弛法可以用于调整模型的状态变量，如海洋温度、盐度、海流速度等。通过与观测数据进行比较，可以计算出如何调整模型的状态，以使其与观测数据更加一致。</p></li><li class="lvl-2"><p>**参数估计：**松弛法也可以用于估计数值模型的参数，例如模型的摩擦系数、混合参数等。通过调整这些参数，可以改进模型的性能，使其更好地拟合观测数据。</p></li><li class="lvl-2"><p>**迭代过程：**松弛法通常是一个迭代过程，其中模型的状态或参数在每个迭代步骤中根据松弛因子和观测数据进行调整。迭代过程会在模型输出与观测数据之间的误差足够小或达到一定的收敛条件时停止。</p></li><li class="lvl-2"><p>**松弛因子：**松弛因子是一个关键参数，决定了每个迭代步骤中的调整幅度。较小的松弛因子可能导致收敛较慢但更稳定，而较大的松弛因子可能导致快速收敛但不稳定。选择合适的松弛因子是一个重要的调整参数。</p></li><li class="lvl-2"><p>**应用：**松弛法在海洋数据同化中的应用范围广泛，可用于改进海洋模型的初始条件、参数估计以及模拟结果的调整。它通常与其他数据同化方法（如卡尔曼滤波、4D-Var等）结合使用，以提高模型的准确性和性能。</p></li></ul></blockquote><p>  总的来说，松弛法是海洋数据同化中的一种有效技术，可用于将观测数据与数值模型相结合，以改进模型的状态或参数，从而提高模型的准确性和可预测性。在实际应用中，选择合适的松弛因子和调整参数是关键，以确保收敛到合适的解。</p><p><strong><div align = center><font color = green> 伴随法（Adjoint Method）</font></div></strong><br>  **伴随法（Adjoint Method）**是一种常用的数值方法，用于计算模型参数的灵敏度以及用于优化目标函数的参数。其被认为是克服了最优插值法存在的问题，可以很好地适用于非线性问题，人们将其应用于多种观测数据与多类海洋数值模型的拟合中，显示了伴随数据同化方法在优化模型初始场、参数估计、开边界条件和外部强迫场方面广泛的应用前景。这些海洋模型包括：</p><ol><li class="lvl-3"><p><strong>原始方程模型</strong>用于描述海洋中物理过程的一组基本方程，这些方程基于物理定律和原理，通常包括质量守恒、动量守恒和能量守恒等。这些方程用来模拟海洋的运动、温度、盐度、悬浮物运输等重要参数的时空演化。最常见的海洋模型原始方程模型包括：</p></li></ol><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**质量守恒方程：**描述海水的质量守恒。它通常包括了关于海水的连续性方程，其中包括了海水的流入和流出，以及源和汇。这个方程用于描述海水的体积浓度的时空变化，通常用于模拟海水的盐度分布。</p></li><li class="lvl-2"><p>**动量守恒方程：**描述海洋流动的动量守恒。这个方程通常包括了关于流体速度的动量守恒方程，其中包括了各种外部力，如风、压强梯度力和克里奥利力。这个方程用于描述海洋的流速和流态的演化。</p></li><li class="lvl-2"><p>**热守恒方程：**描述海水的温度守恒，这个方程通常包括了关于海水温度的热守恒方程，其中包括了各种热通量，如太阳辐射、热通量和热传导。这个方程用于描述海水温度的时空变化。</p></li><li class="lvl-2"><p>**盐度守恒方程：**描述海水的盐度守恒。这个方程通常包括了关于海水盐度的盐。</p></li></ul></blockquote><p>  这些方程可以根据问题的具体性质和模型的复杂程度而有所变化。海洋模型的原始方程模型可以通过数值方法进行求解，通常使用有限元法、有限差分法或谱方法等。这些模型被广泛应用于研究海洋中的物理和生态过程，以及海洋气象和气候变化等重要领域。</p><ol start="2"><li class="lvl-3"><p>**准地转模型（Quasi-Geostrophic Model）**是一类用于描述大气或海洋中的运动的模型。它是在一种近似情况下，将运动方程简化而得到的模型。准地转模型通常应用于描述大尺度的大气或海洋运动，尤其是涉及到大范围的涡旋运动时。以下是关于准地转模型的一些基本信息：</p></li></ol><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**准地转近似：**准地转模型是基于准地转近似的。准地转近似是一种假设，它认为在大尺度运动中，克里奥利力和压强梯度力之间存在一个平衡，从而使得某些运动方程的项可以被忽略。</p></li><li class="lvl-2"><p>**运动方程：**准地转模型通常涉及一组动量守恒和热守恒方程，这些方程描述了大气或海洋运动中的涡旋运动和辐散运动等。</p></li><li class="lvl-2"><p>**模型应用：**准地转模型通常用于研究大尺度的大气或海洋现象，如高空气压系统、大气涡旋、海洋涡旋等。它可以用于预测和解释这些现象的运动和演变。</p></li><li class="lvl-2"><p>**数值求解：**准地转模型通常通过数值方法来求解，例如有限差分法、谱方法等。这些方法可以模拟大范围的运动，但通常不适用于描述小尺度的细节。</p></li><li class="lvl-2"><p>**适用范围：**准地转模型是一种近似模型，适用于大尺度和相对较缓慢的运动。它通常不适用于描述小尺度、高频率的运动。</p></li></ul></blockquote><p>  总的来说，准地转模型是一种在大气或海洋科学中常用的工具，用于研究大尺度的运动和涡旋现象。它提供了一种在物理定律的基础上进行简化建模的方式，从而使得我们可以更好地理解和预测大气和海洋中的运动特性。然而，需要注意的是，在应用准地转模型时，需要认识到其近似性质，以及适用范围的限制。</p><ol start="3"><li class="lvl-3"><p><strong>环流模型</strong>是用于模拟和研究海洋环流系统的数学模型。它们基于物理定律和实验观测，描述了海洋中的流动、变化和交换过程。环流模型在海洋科学研究中扮演者重要角色，用于理解海洋环境、预测海洋动态和探索海洋生态系统。以下是关于海洋环流模型的一些基本信息：</p></li></ol><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**基本方程：**海洋环流模型通常基于一组基本方程，包括质量守恒、动量守恒和能量守恒等方程。这些方程描述了海水的运动、温度、盐度等物理参数的时空演化。</p></li><li class="lvl-2"><p>**模拟尺度：**环流模型可以模拟不同尺度的海洋环流，从大尺度的大循环到局部区域的细节环流，甚至可以考虑较小尺度的涡旋运动。</p></li><li class="lvl-2"><p>**边界条件：**环流模型通常需要考虑边界条件，包括海洋边界和陆地边界，这些边界条件可以影响模型的模拟结果。</p></li><li class="lvl-2"><p>**外部驱动：**环流模型通常考虑外部驱动，如风场、太阳辐射、潮汐等，这些驱动因素可以影响海洋环流的形态和演变。</p></li><li class="lvl-2"><p>**数值求解：**环流模型通常通过数值方法来求解，包括有限元法、有限差分法、谱方法等。这些方法可以将模型方程离散化，以便在计算机上进行模拟。</p></li><li class="lvl-2"><p>**应用：**环流模型在海洋科学研究中应用广泛，包括研究海洋循环系统、探测温盐环流、模拟海洋风暴等。它们也在海洋资源开发、海洋环境保护等领域发挥着重要作用。</p></li></ul></blockquote><p>  环流模型的选择取决于研究问题的具体性质和尺度。大规模的全球环流模型可以用于研究全球尺度的海洋动力学，而区域环流模型则适用于研究特定区域的海洋环流特征。环流模型的发展也在不断推动着海洋科学的进步，为我们更好地理解和保护海洋环境提供了重要的工具。</p><ol start="4"><li class="lvl-3"><p><strong>简化重力浅水模型</strong>是一种用于描述海洋或大气中大尺度运动的数学模型，其核心假设之一是在水平方向上，流体的运动速度远小于重力波速度，因此可以将垂直方向的动力学效应忽略不计。这一模型适用于描述海洋或大气的低频运动和长波传播，如大尺度的海洋波动、大气气旋等。以下是关于简化重力浅水模型的一些基本信息：</p></li></ol><blockquote><ul class="lvl-1"><li class="lvl-2"><p>**基本方程：**简化重力浅水模型通常基于一维或二维的浅水方程（Shallow Water Equations）进行建模。这些方程包括连续性方程和动量守恒方程，描述了流体的质量和动量在水平方向上的传递。</p></li><li class="lvl-2"><p>**假设：**该模型的核心假设是忽略了垂直方向上的运动，即认为流体在垂直方向上是均匀分布的。这个假设使得模型的求解变得相对简单，适用于描述长波和大尺度运动。</p></li><li class="lvl-2"><p>**应用：**简化重力浅水模型广泛应用于研究大尺度的海洋或大气运动，包括大洋中的波动、海洋涡旋、大气气旋等，它们也用于气象学中的气旋和锋面的建模，以及海洋学中的海浪、潮汐和海洋涡旋的研究。</p></li><li class="lvl-2"><p>**数值求解：**通常，简化重力浅水模型通过数值方法求解，如有限差分法、有限元法或谱方法。这些方法可以模拟流体的时空演化，并生成模型的预测。</p></li><li class="lvl-2"><p>**模型扩展：**简化重力浅水模型可以扩展到包括地转效应、摩擦、边界条件等更复杂的情况。这些扩展模型通常用于更准确地描述特定地区或特定问题的运动。</p></li></ul></blockquote><p>  总的来说，简化重力浅水模型为研究大尺度海洋或大气运动提供了一个有用的数学框架。尽管它们是基于一些近似和简化，但它们对于理解和预测大尺度的运动和波动在海洋学和气象学中仍然具有重要价值。</p><p><strong><div align = center><font color = green> 模拟退火法</font></div></strong><br>  <strong>模拟退火法</strong>适合于大尺度最优问题。该法是基于缓慢冷却液体，从而使得液体自然结晶，使得全局的能量最小。该法用于温度方面的同化。在应用于最优方面时，代价函数在能量方面起决定性的作用，而温度由控制参数代替。模拟退火方案确定了控制参数如何以及以多大的速度下降。该法的优点是基础原理明确。缺点是计算量太大，要求计算机的性能太高（在计算机资源受限的环境或需要高效解决方案的问题中），且有时候收敛到的值不是全局最小。</p><p><strong><div align = center><font color = green> 遗传算法</font></div></strong><br>  <strong>遗传算法</strong>的基本原理是基于生物的遗传与进化。在每一次迭代寻求最优的过程中，该法保留许多解，解的进化是将过去的能够产生最小不适，以使得新解能够最大可能得适合于模型的优化的解保留。因此，代价函数越复杂，计算量就越大。该法允许非局部最优，但不保证收敛于全局最优。该法的主要缺点是缺乏理论基础，并且和模拟退火一样，对计算机的性能要求太高。总的来讲，和模拟退火一样，是直接下降法中的一种方法。<br><font size = 2; color = natural>PS：直接下降法（Direct Descent Method）通常不是用于解决海洋模型的问题。直接下降法通常用于数学优化问题，其主要目标是寻找一个函数的最小值或最优解。在某些情况下，为了改进海洋模型的性能或优化模型参数，可以使用数学优化算法，例如遗传算法、粒子群优化、梯度下降等。这些算法通常被用于调整模型参数，以使模型模拟与观测数据更好地吻合。但直接下降法在这种上下文中并不常见，因为海洋模型通常不是一个单一的数学函数，而是一个包含多个参数和物理方程的复杂模型。因此，在海洋科学中，直接下降法不是常见的工具，而更常见的是数值模拟方法和其他优化算法，以改进海洋模型的性能和准确性。</font></p><p><strong><div align = center><font color = green> 杂交算法</font></div></strong><br>  **杂交算法（Hybrid Algorithms）**是一种将不同的优化和模拟方法组合在一起，以改善算法的性能和鲁棒性的方法。在海洋模型中，杂交算法可以用于改进模型的性能、提高模拟结果的准确性，以及解决特定的复杂问题。</p><p>  随着卫星遥感数据的大量获取以及精度的提高，人们更感兴趣的是把实际的卫星测量数据结合常规的数据和模型相结合。</p><h5 id="1-3-2-数据同化模型">1.3.2 数据同化模型</h5><p><font size=2; color=natural>PS:由于该篇论文较早，此处不再同步更新作者观点，而是介绍海洋数据模型相关知识。</font><br>  除了同化方法外，构成同化系统的另一个基础 – 模型 – 也在不断地发展。一个优秀的海洋系统的预报模型是建立模型体系的必要一步，该模型体系要能够准确的合并观测数据与预报模型，并可应用于预报目的。描述海洋基本环流的数值模型是一个重要的科研工具，它能够帮助我们理解海洋的环流、海洋在天气变化中所扮演的角色以及在海洋内部的生物化学的产生、发展过程。<br>  基于涡及非涡的模型广泛而活跃地表述了涉及海洋环流的各种时间尺度的问题。好、一个基础性的物理模型的质量保证是成功同化试验的前提。对物理系统的动力、热力过程的充分理解是最终准确预报海洋（或天气）变化的必要条件。</p><h4 id="1-4-论文的内容和创新点">1.4 论文的内容和创新点</h4><p>  针对我国海区的应用研究较少，本文在前人文献的基础上，进行了方法及应用上研究。这些研究内容包括以下几个方面：</p><blockquote><ol><li class="lvl-3"><p>本文建立观测场与时间和空间相关的协方差矩阵，并根据时间相关强弱给予不同的权重值，使得对观测数据的应用更接近实际情况。本文还详细研究了渤海温度场的水平相关和垂向相关，得到了渤海温度场的相关特性。</p></li><li class="lvl-3"><p>将时间相关引进最优插值算法，解决了观测数据使用时间错位的问题，从而得到了动态处理协方差矩阵的动态最优插值方法。不仅改善了空间分布数据处理的准确性，而且也改善了在时间过程上数据处理的准确性。</p></li><li class="lvl-3"><p>针对卡尔曼滤波与平滑无法直接应用在海洋数据同化问题，针对其计算量过大的问题，提出了SVD简化原则，将状态空间向量进行改写，获得了用主要成分误差和次要成分误差表述原状态向量误差的表达形式，从而将原预报误差协方差阵降维，简化了增益矩阵的求解计算。另外，应用反向量表述方法，将半隐式离散格式转换为可直接计算状态转移矩阵的显式格式。上述两个计算方面的改进，节省了计算量，提高了计算效率，这对有时间性要求的预报计算很有意义。</p></li><li class="lvl-3"><p>本文首先对T/P实时卫星数据进行了调和分析，并在此结果的基础上，进一步结合理论模型的结果进行同化数据处理。这使得得到的结果更加符合真实情况。</p></li></ol></blockquote><p>  除此之外，本文还扩展推导了融合方法的公式，将数据同化公式推广到观测与模式数据不一致情况下进行应用，并以并行试验做了检测。丰富了同化方法的应用。<br>  本文的创新处有以下几点：</p><blockquote><ol><li class="lvl-3"><p>在确定协方差矩阵时首次应用时间相关，这可将数据根据其获取时间的不同分别进行权重处理。推导了时间相关的动态最优插值算法，并应用到渤海海表温度场的数据同化处理中。解决了观测数据使用时，时间错位的问题，使结果更加符合实际情况。</p></li><li class="lvl-3"><p>提出了使用SVD简化卡尔曼增益矩阵计算的新方法；应用反向量表述方法，将半隐式离散格式转换为可直接计算状态转移矩阵的显式离散格式；将卡尔曼方法成功应用到温度场的同化中。这两个改进简化了计算，极大地节省了计算量，提高了计算效率，对有时效性要求地海洋流场计算具有直接意义。</p></li><li class="lvl-3"><p>对黄、东海区域内的卫星数据进行调和分析，并结合理论模式计算，进行最优插值同化处理，获得了更接近真实值的结果。</p></li></ol></blockquote><h3 id="div-align-center-第二章-模式介绍-div"><div align='center'>第二章  模式介绍</div></h3><p>  本文所采用的模式是德国的汉堡陆架模式 HAMSOM（Hamburg Shelf Ocean Model），HAMSOM 是一个三维斜压原始方程模式。HAMSOM 具有以下方面的主要特征：</p><blockquote><ol><li class="lvl-3"><p>对运动方程中的正压梯度力项($ g\rho_{1}\zeta $)、连续方程中的散度项，采用半隐式的差分格式，以克服由外重力波所引起的对稳定性的限制。</p></li><li class="lvl-3"><p>对运动方程中的垂向粘性项和温度、盐度方程中的垂向扩散项，采用半隐式的差分格式，以克服垂向粘性项和垂向扩散项引起的对稳定性的限制。</p></li><li class="lvl-3"><p>为克服在时间向前积分过程中，因科氏力项而引起的线性不稳定，在运动方程中，对科氏力项引入一个稳定的二阶旋转矩阵。</p></li><li class="lvl-3"><p>其差分处理的主要特点是：对层积分方程组进行差分，在时间域里引入两个时间步长，它们分别用上指标 $n$ 和 $n+1$ 来代表当前和将来时间步。在这一差分格式中，进入半隐式格式的所有预报量是定义在这一交叉的时间步上的。对于运动方程、温度方程中的水平粘性（扩散）项，及这些方程中的水平平流项，都采用显式差分格式。</p></li></ol></blockquote><h4 id="2-1-海洋流动的基本方程">2.1 海洋流动的基本方程</h4><p>  描述流体水动力和热力系统的基本方程为：关于<strong>运动的动量方程</strong>，描述<strong>质量守恒的连续方程</strong>，<strong>状态方程</strong>，<strong>温度和盐度的守恒方程</strong>。为了把这些方程应用到海洋中，针对海洋的特性，对这些方程作了一些假定和近似：</p><blockquote><ol><li class="lvl-3"><p>在动力海洋学研究中，因为海水运动的速度远远小于声速，常把海水作为不可压缩流体来处理的，即在流动过程中海水微团的形状可以变化，但其体积不会发生变化，从而海水微团的密度（质量）不会发生变化，即 $\frac {D_{\rho}} {D_t} = 0$ ;</p></li><li class="lvl-3"><p>海洋中垂向尺度与水平尺度的型比数远小于 1，根据量纲分析，运动的垂向速度分量远远小于水平速度分量，那么垂向的运动方程可用静力平衡方程来近似，即重力加速度与垂向压力梯度相平衡。在右手笛卡儿坐标系（东向为X轴方向，北向为Y轴方向，垂直向上为Z轴方向，Z轴的零面取在水平位势面上）中， 基本方程有：</p></li></ol></blockquote><h5 id="2-1-1-连续方程">2.1.1 连续方程</h5><p>由质量守恒定律在流体中的应用可得连续方程：<br>$$\frac{D_\rho}{D_t} + \rho\nabla \cdot \vec{V} = 0 $$<br>由海水为不可压缩流体，在上述坐标中连续方程被简化为：<br>$$\frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} + \frac{\partial w}{\partial z} = 0$$<br>其中：$u,v,w$ 分别为$X,Y,Z$方向的速度分量；</p><h5 id="2-1-2-运动方程">2.1.2 运动方程</h5><p>  研究海洋，必须考虑地球的自转效应，或称为科氏（Coriolis）效应。由于地球不停地以平均角速度。$ \omega = 7.292 \times 10^{-5}  rad/s $ 绕轴线自西向东自转，而参照坐标也都取在固定的地表，这样参照坐标系也在不停地旋转，因此它是一个非惯性系统，由于地球自转而引起的惯性力也就要考虑进去，这个力即称为科氏力。在上述直角坐标系中，科氏力可表示为：<br>$$-2 \vec{\omega} \times \vec{V} = (2 \omega sin \varphi \cdot -2 \omega cos \varphi \cdot w) \vec{i} + (-2 \omega sin \varphi \cdot u) \vec{j} + (2 \omega cos \varphi \cdot u) \vec{k}$$<br>式中： $\omega$ 地球自转的角速度矢量； $\varphi$ 流体微团所在纬度；<br><font size = 2; color = natural>PS:上述公式中，第一项为科氏力在 $X$ 轴方向上的分量，第二项为科氏力在 $Y$ 轴方向上的分量，第三项为科氏力在 $Z$ 轴方向上的分量</font><br><font size = 2; color = natural>PS：科氏力方程描述了地球自转引起的科氏力对海洋中流体运动的影响。</font><br>  由于海水运动的速度远小于声速，所以把海水看作是不可压缩流体，而且假定 $w &lt;&lt; u、v$ ,垂向的运动方程可用静力平衡来近似。如果海水运动处于层流状态，则由 Navier-Stokes 运动方程可得海水的运动方程为：<br>$$\frac{D\vec{V}}{Dt} = −\frac{1}{\rho} \nabla p + \mu \nabla^2 \vec{V} + \vec{F}$$</p><blockquote><p><strong>$\frac{D\vec{V}}{Dt}$：</strong> 表示速度矢量 <strong>$\vec{V}$</strong> 的拉格朗日导数，表示速度随时间的变化率；<br><strong>$−\frac{1}{\rho} \nabla p$：</strong> 表示压力梯度力，描述了压力如何影响流体的运动，其中 <strong>$\nabla p$</strong> 表示压力梯度矢量；<br><strong>$\mu \nabla^2 \vec{V}$：</strong> 表示粘性项，描述了粘性如何影响速度场，其中 <strong>$\nabla^2$：</strong> 是拉普拉斯算子，表示速度场的散度。<br><strong>$\vec{F}$：</strong> 表示外部力，可以包括重力、电磁力等其他外部力。</p></blockquote><p>在上述直角坐标系中，上式的分量形式为：</p><p>$$<br>\left\{\begin{matrix}<br>\frac{\partial u}{\partial t} + u\frac{\partial u}{\partial x} + v\frac{\partial u}{\partial y} + w\frac{\partial u}{\partial z} - fv = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \mu(\frac{\partial^2u}{\partial x^2} + \frac{\partial^2u}{\partial y^2} + \frac{\partial^2u}{\partial z^2}) + F_x \\<br>\frac{\partial v}{\partial t} + u\frac{\partial v}{\partial x} + v\frac{\partial v}{\partial y} + w\frac{\partial v}{\partial z} + fv = -\frac{1}{\rho}\frac{\partial p}{\partial x} + \mu(\frac{\partial^2v}{\partial x^2} + \frac{\partial^2v}{\partial y^2} + \frac{\partial^2v}{\partial z^2}) + F_y  \\<br>\frac{\partial p}{\partial z} = - \rho g<br>\end{matrix}\right.<br>$$</p><blockquote><p>**t：**时间；<br>**f：**科氏参量，且 $f = 2 \omega sin \varphi$；<br>**g：**重力加速度；<br>**$p(z)$：**水深 $z$ 处的压力；<br>**$F_x, F_y$：**分别为 $X$ 和 $Y$方向上的外力；</p></blockquote><br><font size=2; color=grey>马寨璞. 海洋流场数据同化方法与应用的研究[D]. 浙江大学,2002.</font>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
            <tag> Ocean </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>海洋的世界</title>
      <link href="/posts/20230913134031/"/>
      <url>/posts/20230913134031/</url>
      
        <content type="html"><![CDATA[<h2 id="数据同化"><a href="#数据同化" class="headerlink" title="数据同化"></a>数据同化</h2><p>数据同化是一种数值模型和实际观测数据相结合的过程，旨在提高模型对系统状态的估计或预测的准确性。这个过程通常应用于气象学、海洋学、环境科学、地球科学等领域，以改善对自然系统行为的理解和预测。以下是关于数据同化的一些关键概念和步骤：  </p><ol><li><strong>模型：</strong>数据同化通常涉及使用数学或物理模型来描述和模拟系统的行为。这些模型可以是气象模型、海洋模型、气候模型、生态模型等，取决于研究的领域和目标。</li><li><strong>观测数据：</strong>观测数据是从现实世界中采集的实际测量数据，包括传感器、卫星、测量设备等。这些数据提供了对系统状态的直接测量或观察。</li><li><strong>模型数据：</strong>模型数据是由数学或物理模型生成的数据，用于模拟系统的状态。这些数据是根据模型方程和初始条件计算的。</li><li><strong>数据同化方法：</strong>数据同化方法用于将观测数据与模型数据相结合，以改进对系统状态的估计。常用的数据同化方法包括卡尔曼滤波法、四维变分法（4D-Var）、集合卡尔曼滤波（EnKF）等。这些方法考虑了观测数据的权重和误差，并将他们融合到模型中，已更新系统的状态。</li><li><strong>初始条件和边界条件：</strong>数据同化通常用于改进系统的初始条件和边界条件。这些条件对于模型的运行和预测至关重要，因此通过同化观测数据来改进它们可以提高模型的准确性。</li><li><strong>迭代过程：</strong>数据同化是一个迭代过程，多次应用数据同化方法，不断更新模型和观测数据，以逐步减小模型与观测之间的差异。</li><li><strong>应用领域：</strong>数据同化在气象预测、海洋模型、空气质量预测、气候建模、生态系统建模等领域都有广泛应用。它有助于提高对自然系统行为的理解，以及对未来情景的预测。</li></ol><p>总的来说，数据同化是一种强大的工具，可以帮组科学家和研究人员更准确地理解和预测复杂的自然系统。通过将观测数据与模型相结合，数据同化有助于优化模型的性能，提高对系统行为的认识，并支持决策制定。</p><h3 id="海洋数据同化"><a href="#海洋数据同化" class="headerlink" title="海洋数据同化"></a>海洋数据同化</h3><p>海洋数据同化是一种用于改进海洋模型的技术，通过将观测数据与模型数据相结合，以提高海洋环境的模拟和预测的准确性。这个过程涉及将不同来源的海洋观测数据整合到数值模型中，以更准确地描述海洋的当前状态和未来变化。以下是有关海洋数据同化的关键概念和步骤：</p><blockquote><ol><li><strong>观测数据收集：</strong>首先，需要从不同的观测平台收集海洋数据，包括卫星观测、浮标、海洋探测器、船只观测和潜水器等。这些数据可以包括海温、海表高度、海洋盐度、海洋流速、海洋色素浓度等多种参数。</li><li><strong>数据预处理：</strong>在将观测数据与模型相结合之前，需要对数据进行预处理，包括校正、插值、去噪和数据格式转换等操作，以确保数据的质量和一致性。</li><li><strong>数值模型：</strong>海洋数据同化通常使用数值海洋模型来模拟海洋的物理和化学过程。这些模型基于物理方程，以模拟海洋的动态行为。</li><li><strong>数据同化方法：</strong>数据同化方法用于将观测数据与数值模型数据相结合，已更新模型的初始条件和边界条件，以反映实际观测。常用的数据同化方法包括卡尔曼滤波法、四维变分法（4D-Var）、集合卡尔曼滤波（EnKF）等。</li><li><strong>模型更新：</strong>一旦观测数据与模型数据同化，模型的状态将得到更新，从而更准确地反映了当前的海洋条件。这可以提高海洋模型的准确性，包括海洋洋流、海温分布、潜在涡旋等。</li><li><strong>预测和决策支持：</strong>通过改进海洋模型的准确性，海洋数据同化有助于提供更可靠的海洋预测和决策支持。这对于海洋航行、气象预测、海洋资源管理和灾害预警等方面都具有重要意义。</li><li><strong>实时数据同化：</strong>一些应用需要实时更新模型以反映最新的观测数据，这被称为实时数据同化。这对于气象预测、船舶导航和海洋环境监测等应用非常重要。</li></ol></blockquote><p>总的来说，海洋数据同化是将观测数据与数值模型相结合，以改进对海洋环境的理解和预测。它在海洋科学、气象学、气候研究和海洋资源管理等领域都有广泛的应用。</p><h2 id="数据反演"><a href="#数据反演" class="headerlink" title="数据反演"></a>数据反演</h2><p>数据反演是一种科学技术过程，用于从观测数据中推导或推断出系统或过程的参数、特性或状态。这个过程通常涉及使用数学模型来模拟系统的行为，并通过与观测数据的比较来估计模型参数或状态。数据反演在科学研究、工程应用和决策制定中有广泛的应用，以下是一些关键方面：</p><ol><li><strong>观测数据：</strong>数据反演的第一步是获取或收集观测数据，这些数据是从实际观测或测量中获得的。观测数据可以包括传感器、卫星、实验室测量、地面观测等。</li><li><strong>数学模型：</strong>为了进行数据反演，通常需要使用数学模型来描述系统或过程的行为。这个模型可以是物理模型、统计模型、计算机模拟模型等，具体取决于研究问题的性质。</li><li><strong>目标参数：</strong>数据反演的目标是推导或估计与模型相关的参数或状态，这些参数或状态通常无法直接观测。这些参数可能是系统的特性，如地下水位、大气温度、污染物浓度等。</li><li><strong>优化算法：</strong>数据反演通常涉及使用优化算法来寻找最佳的模型参数或状态，以使模型的输出与观测数据尽可能匹配。常用的优化算法包括梯度下降、遗传算法、蒙特卡罗方法等。</li><li><strong>误差估计：</strong>在数据反演中，需要考虑观测数据和模型之间的误差，以确定参数或状态的不确定性。误差估计有助于确定估计的可信度。</li><li><strong>迭代过程：</strong>数据反演通常是一个迭代过程，通过多次比较模型输出和观测数据，并调整模型参数或状态，以逐渐提高反演的准确性。</li><li><strong>应用领域：</strong>数据反演在地球科学、环境科学、物理学、医学成像、机器学习等领域都有广泛应用。例如，地球物理学家可以使用数据反演来估计地下岩石的属性，医学成像中可以用于重建体内器官的结构。</li></ol><p>总的来说，数据反演是一种强大的工具，可用于从观测数据中获取有关系统或过程的有用信息，以支持科学研究、工程设计和决策制定。它的应用范围非常广泛，可用于解决各种复杂问题。</p><h3 id="海洋数据反演"><a href="#海洋数据反演" class="headerlink" title="海洋数据反演"></a>海洋数据反演</h3><p>海洋数据反演是一种科学技术过程，旨在从海洋观测数据中推导出有关海洋环境的参数、状态或特性。这个过程通常涉及使用数学模型来模拟海洋的物理、化学和生物过程，并将观测数据与模型相结合，以推断或估计模型参数或海洋状态的值。以下是有关海洋数据反演的一些关键概念和步骤：</p><blockquote><ol><li><strong>观测数据：</strong>海洋数据反演的第一步是获取或收集海洋观测数据，这些数据可以包括卫星遥感数据、海洋传感器数据、潜水器和浮标数据、船只观测数据等。这些数据提供了对海洋特性的实际测量或观察。</li><li><strong>数学模型：</strong>为了进行海洋数据反演，通常需要使用数学模型来描述海洋的物理、化学和生物过程。这些模型可以包括大气海洋循环模型、海洋温度-盐度模型、生态系统模型等，具体取决于研究问题的性质。</li><li><strong>目标参数：</strong>海洋数据反演的目标是推导或估计与模型相关的参数或状态，这些参数可能包括海洋表面温度、盐度、流速、生物生产力等。这些参数通常无法直接观测，需要通过反演来估计。</li><li><strong>数据同化方法：</strong>海洋数据反演通常使用数据同化方法来将观测数据与模型数据相结合，以更新模型的初始条件和边界条件，以反映实际观测。常用的数据同化方法包括卡尔曼滤波、四维变分法（4D-Var）、集合卡尔曼滤波（EnKF）等。</li><li><strong>模型参数调整：</strong>在海洋数据反演中，模型参数可能需要调整，以使模型的输出与观测数据尽可能匹配。这包括考虑观测数据的误差和不确定性。</li><li><strong>迭代过程：</strong>海洋数据反演通常是一个迭代过程，通过多次应用数据同化方法，不断更新模型的状态和参数，以逐渐提高反演的准确性。</li><li><strong>应用领域：</strong>海洋数据反演在海洋科学、气象学、海洋资源管理、环境监测等领域有广泛应用。它有助于提高对海洋环境的理解，以及对海洋变化和生态系统的预测。</li></ol></blockquote><p>总的来说，海洋数据反演是一种强大的工具，可用于从观测数据中获取有关海洋环境的有用信息，以支持科学研究、资源管理和决策制定。它有助于提高对海洋系统行为的理解，并改进海洋模型的性能。</p>]]></content>
      
      
      <categories>
          
          <category> Initial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
            <tag> Ocean </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>进阶的科研</title>
      <link href="/posts/20230909133718/"/>
      <url>/posts/20230909133718/</url>
      
        <content type="html"><![CDATA[<h2 id="Unmanned-Surface-Vehicles-USV"><a href="#Unmanned-Surface-Vehicles-USV" class="headerlink" title="Unmanned Surface Vehicles(USV)"></a>Unmanned Surface Vehicles(USV)</h2><h3 id="1-MMG模型"><a href="#1-MMG模型" class="headerlink" title="1. MMG模型"></a>1. MMG模型</h3><p>分离型船舶运动模型（Maneuvering Motion Model for Ships，简称MMG模型）是一种数学模型，用于描述船舶在水中的运动行为和操纵特性。这个模型旨在模拟船舶的运动响应，以便在航海、船舶操纵、自动导航和仿真等领域中进行研究和应用。</p><p>MMG模型通常包括以下几个关键方面的参数和子模型：</p><ol><li><p>静力稳定性：这部分模型考虑了船舶在平稳状态下的受力和力矩平衡，包括浮力、重力和浸入的变化。这有助于描述船舶的平稳漂浮状态。  </p><blockquote><p>船舶在平稳状态下的受力和力矩平衡是描述船舶静力稳定性的重要方面。在平稳状态下，船舶既不加速也不旋转，因此各个受力和力矩之间必须达到平衡，以维持其当前状态。以下是描述船舶在平稳状态下受力和力矩平衡的基本原理：  </p><ol><li>浮力与重力平衡：在平稳状态下，船舶所受的浮力（Buoyant Force）必须与其所受的重力（Gravity Force）平衡。浮力是由于船舶在水中部分或完全浸没而产生的，其大小等于被排斥水的重量。重力则是由于船舶的质量而产生的，其大小等于船舶的质量乘以地球上的重力加速度（通常为9.81 m/s²）。 </li></ol><p> *<font color = natural; size = 2>浮力 = 重力</font>* </p><ol start="2"><li>推进力与阻力平衡：如果船舶在平稳状态下航行，那么所受的推进力（Propulsive Force）必须与所受的水动力阻力（Hydrodynamic Resistance）平衡。推进力是由船舶的推进装置（通常是螺旋桨）提供的，用于推动船舶前进。水动力阻力是船舶在水中运动时所面临的阻力，它包括摩擦阻力和波浪阻力等。  </li></ol><p> *<font color = natural; size = 2>推进力 = 水动力阻力</font>* </p><ol start="3"><li>动力与反作用力平衡：根据牛顿第三定律，船舶的推进力必须与产生该推进力的反作用力平衡。这意味着如果船舶在一个方向上受到推进力，它将在相反方向上受到一个等大但方向相反的反作用力。  </li></ol><p> *<font color = natural; size = 2>推进力 = 反作用力</font>*   </p><ol start="4"><li>舵力与转向力矩平衡（如果适用）：如果船舶需要改变方向，舵的操作将产生一个舵力（Rudder Force），以及一个与之相对应的转向力矩（Yawing Moment）。这个转向力矩必须与任何其他力矩平衡，以保持平稳状态。  </li></ol><p> *<font color = natural; size = 2>舵力 = 其他力矩引起的力矩</font>*   </p></blockquote><blockquote><p>综上所述，船舶在平稳状态下的受力和力矩平衡是一个复杂的静力学问题，需要考虑多个因素，包括船舶的形状、质量分布、浸没情况、速度等。确保这些力和力矩之间的平衡非常重要，以维持船舶的稳定状态，防止倾覆或其他不稳定的情况发生。这也是船舶设计和运营中的关键考虑因素。</p></blockquote></li><li><p>动力学模型：这一部分考虑了船舶的加速度和速度响应。它通常包括了船舶的质量和惯性特性，以及操纵装置（如舵）的影响。动力学模型描述了船舶如何响应不同类型的操纵输入。  </p><blockquote><p>船舶的惯性特性是指船舶在运动和操纵时对外部力和力矩的响应速度和程度，通常包括质心位置、质量分布、质量惯性矩、质心高度等参数。这些特性对于船舶的稳定性、操纵性和性能有着重要影响。以下是一些船舶的惯性特性的重要参数：  </p><ol><li><strong>质心位置（Center of Gravity，CoG）</strong>：质心是船舶的质量集中点，通常以长、宽、高坐标系中的坐标表示。质心位置的高度和水平位置对于船舶的稳定性至关重要。较低的质心有助于提高稳定性。  </li><li><strong>质心高度（Metacentric Height，GM）</strong>：GM是一个衡量船舶稳定性的关键参数，它是船舶的重力中心与浮力中心之间的垂直距离。较大的GM值通常表示较好的稳定性。</li></ol></blockquote></li><li><p>横向稳定性：这一部分关注船舶在横向方向上的稳定性，包括侧倾稳定性和横摇稳定性。这些特性影响了船舶的侧向运动和稳定性。  </p><blockquote><p>船舶的侧倾稳定性和横摇稳定性是两个关键的稳定性概念，涉及到船舶在侧向运动和横摇运动时的稳定性表现。以下是关于这两种稳定性的详细解释：</p><ol><li><strong>侧倾稳定性（Heeling Stability）</strong>：<ul><li><strong>定义</strong>：侧倾稳定性是指船舶在侧向运动（侧倾或倾斜）时的稳定性。当船舶受到外部力或力矩作用，试图将其倾斜至一侧时，侧倾稳定性决定了船舶是否会自动回复到垂直位置。</li><li><strong>稳定性表现</strong>：较好的侧倾稳定性意味着船舶倾斜后具有回复到垂直位置的趋势。这通常是通过具有低质心、宽船体、稳定的船体形状以及压载水线的设计来实现的。</li><li><strong>影响因素</strong>：侧倾稳定性受到质心高度、重力中心位置、船体形状、防侧倾设备（如侧装舱）等因素的影响。  </li></ul></li><li><strong>横摇稳定性（Roll Stability）</strong>：<ul><li><strong>定义</strong>：横摇稳定性是指船舶在横摇运动（摇晃或左右摆动）时的稳定性。当船舶受到外部力或力矩作用，试图将其摇晃时，横摇稳定性决定了船舶是否会自动回复到稳定的状态。</li><li><strong>稳定性表现</strong>：较好的横摇稳定性意味着船舶在摇晃后具有回复到平稳状态的趋势。这通常是通过合适的质心高度、质量分布、船体形状以及稳定装置（如阻尼舱或抗横摇翼）来实现的。</li><li><strong>影响因素</strong>：横摇稳定性受到质心高度、质量分布、船体宽度、阻尼装置、风力、海浪等多种因素的影响。  </li></ul></li></ol></blockquote><blockquote><p>总的来说，侧倾稳定性和横摇稳定性都是关于船舶的稳定性和安全性非常重要的概念。合理的设计和操作可以确保船舶在侧向运动或横摇运动中具有良好的稳定性，减少事故和危险。船舶设计师和船舶操作员需要密切关注这些稳定性因素，并采取适当的措施来维护和提高船舶的稳定性。</p></blockquote></li><li><p>纵向稳定性：这一部分关注船舶在纵向方向上的稳定性，包括纵倾稳定性和纵摇稳定性。这些特性影响了船舶的前后运动和稳定性。  </p><blockquote><p>船舶的纵倾稳定性和纵摇稳定性是两个重要的稳定性概念，涉及到船舶在纵向运动中的稳定性表现。以下是这两种稳定性的详细解释：</p><ol><li><strong>纵倾稳定性（Pitch Stability）</strong>：<ul><li><strong>定义</strong>：纵倾稳定性是指船舶在纵向运动中的稳定性。当船舶受到外部力或力矩作用，试图使其在前后倾斜时，纵倾稳定性决定了船舶是否会自动回复到水平状态。</li><li><strong>稳定性表现</strong>：较好的纵倾稳定性意味着船舶在前后倾斜后具有回复到水平状态的趋势。这通常是通过合适的质心高度、重力中心位置、船体形状、舵的设置等因素来实现的。</li><li><strong>影响因素</strong>：纵倾稳定性受到质心高度、船体形状、船舶速度、纵向稳定装置（如配重、水密舱）等因素的影响。</li></ul></li><li><strong>纵摇稳定性（Yaw Stability）</strong>：<ul><li><strong>定义</strong>：纵摇稳定性是指船舶在纵向运动中的稳定性，特别是与船舶的偏航运动有关。当船舶受到外部力或力矩作用，试图使其旋转或偏航时，纵摇稳定性决定了船舶是否会自动回复到直线行驶状态。</li><li><strong>稳定性表现</strong>：较好的纵摇稳定性意味着船舶在发生偏航运动后具有回复到直线行驶状态的趋势。这通常是通过合适的船舶外形设计、舵的设置、自动操纵系统等因素来实现的。</li><li><strong>影响因素</strong>：纵摇稳定性受到船舶外形、船首和船尾的形状、舵的设计和操作、风力和海浪等因素的影响。 </li></ul></li></ol></blockquote><blockquote><p>纵倾稳定性和纵摇稳定性都是关键的船舶稳定性特性，对船舶的安全性和操纵性具有重要影响。合理的设计和操作可以确保船舶在纵向运动中具有良好的稳定性，减少事故和危险。船舶设计师和船舶操作员需要密切关注这些稳定性因素，并采取适当的措施来维护和提高船舶的稳定性。</p></blockquote></li><li><p>融合模型：最终，MMG模型将这些不同的子模型融合在一起，以模拟整个船舶的运动响应。这可以通过微分方程或其他数学方法来实现。</p></li></ol><p>MMG模型的精度和复杂程度可以根据具体应用的需要进行调整。这种模型在船舶设计、航海训练、自动驾驶系统开发以及海事仿真等领域都具有广泛的应用。通过模拟船舶的运动行为，研究人员和工程师可以更好地了解船舶在不同条件下的性能，并开发出更安全和高效的船舶操作和控制方法。</p><h3 id="2-USV旋转角"><a href="#2-USV旋转角" class="headerlink" title="2. USV旋转角"></a>2. USV旋转角</h3><p>USV的旋转矩阵通常用来描述其姿态（航向、俯仰和横滚）的变化。USV的姿态通常由旋转矩阵、四元数或欧拉角等方式表示。这里，我将为你提供一个描述USV姿态的旋转矩阵的简单示例。</p><p>USV的姿态通常使用一个3x3的旋转矩阵R来表示，这个矩阵描述了USV坐标系与世界坐标系之间的旋转关系。矩阵的元素可以表示如下：</p><pre class="line-numbers language-none"><code class="language-none">R &#x3D; |  R11  R12  R13  |    |  R21  R22  R23  |    |  R31  R32  R33  |<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>其中，R11、R12、R13表示USV坐标系的x轴在世界坐标系中的方向；R21、R22、R23表示y轴的方向；R31、R32、R33表示z轴的方向。</p><p>如果你有USV的欧拉角（Yaw、Pitch、Roll），你可以使用以下方法构建旋转矩阵：</p><ol><li>计算Yaw、Pitch、Roll的弧度值。</li><li>构建绕z轴（Yaw）、y轴（Pitch）、x轴（Roll）的旋转矩阵。</li><li>将这些旋转矩阵相乘以获得最终的旋转矩阵。</li></ol><p>具体的数学计算可能需要根据你的USV的坐标系约定和数学库来进行调整，但这个基本思路可以帮助你构建无USV的旋转矩阵。</p><p>需要注意的是，USV的姿态控制是一个复杂的问题，涉及到传感器测量、控制算法等多个因素。实际应用中，你可能需要使用专门的USV控制库或工具来处理姿态信息。</p><h3 id="3-USV的运动和姿态相关概念"><a href="#3-USV的运动和姿态相关概念" class="headerlink" title="3. USV的运动和姿态相关概念"></a>3. USV的运动和姿态相关概念</h3><ol><li><p>纵向位移、横向位移和艏摇角度  </p><blockquote><ul><li><strong>纵向位移：</strong>纵向位移指船舶在前后方向上相对于其平衡位置的移动，即船头向前或向后的移动距离。正值表示船头向前移动，负值表示船头向后移动。</li><li><strong>横向位移：</strong>横向位移指船舶在左右方向上相对于其平衡位置的移动，即船舶侧向的移动距离。正值表示船舶向右移动，负值表示船舶向左移动。</li><li><strong>艏摇角度：</strong>艏摇角度表示船舶的艏部相对于其平衡位置的偏航角度。正值表示船舶艏部朝向右侧，负值表示朝向左侧。</li></ul></blockquote><blockquote><p>这三个概念描述了船舶相对于其平衡位置的位移和姿态变化。</p></blockquote></li><li><p>纵荡运动、横荡运动和艏摇运动</p><blockquote><ul><li><strong>纵荡运动：</strong>纵荡运动是指船舶在前进和后退方向上的周期性运动，即船头在前后摆动的运动。</li><li><strong>横荡运动：</strong>横荡运动是指船舶在左右方向上的周期性运动，即船体在左右摆动的运动。</li><li><strong>艏摇运动：</strong>艏摇运动是指船舶艏部（前部）相对于水平面的偏航运动，描述了船头在水平面上的摆动。</li></ul></blockquote><blockquote><p>这三个概念描述了船舶在水中运动时可能发生的周期性运动。  </p></blockquote></li></ol><p>总的来说， _<font color = green>纵向位移、横向位移和艏摇角度</font>_ 描述了船舶的位移和姿态变化，而 _<font color = blue>纵荡运动、横荡运动和艏摇运动</font>_ 描述了船舶在水中运动时可能发生的周期性运动方式。这两组概念描述了船舶运动和姿态的不同方面。</p><h3 id="4-惯性质量矩阵（Inertia-Matrix）"><a href="#4-惯性质量矩阵（Inertia-Matrix）" class="headerlink" title="4. 惯性质量矩阵（Inertia Matrix）"></a>4. 惯性质量矩阵（Inertia Matrix）</h3><p>船舶的惯性质量矩阵（Inertia Matrix）是描述船舶在运动和旋转过程中对惯性力和惯性力矩的响应的重要概念。这个矩阵包含了关于船舶的质量分布和转动惯量的信息，对于分析船舶的运动和稳定性非常重要。  </p><p>惯性质量矩阵通常表示为一个3 X 3 的矩阵，包含以下元素：  </p><ol><li><strong>质量（Mass）：</strong><blockquote><ul><li>在对角线上，通常有三个元素，分别是船舶绕三个坐标轴的质量：纵向轴（X轴）、横向轴（Y轴）和垂直轴（Z轴的质量）。</li><li>这些元素代表了船舶在运动时的质量分布，通常以吨（或其他适当的质量单位）表示。</li></ul></blockquote></li><li><strong>横滚惯性矩量（Rolling Moment of Inertia）：</strong><blockquote><ul><li>这是描述船舶绕横向轴（Y轴）旋转的性质。</li><li>它反映了船舶在横滚运动时的抵抗程度，通常以吨米²表示。<br><font size=2; color=netural>PS:吨米²是一个表示物体惯性矩量的单位。表示的是质量和长度单位的组合，用于描述物体对绕特定轴旋转的惯性矩量。在船舶动力学和物理学中，这个单位通常用于描述船舶或其他物体在不同轴上的转动惯性。</font></li></ul></blockquote></li><li><strong>纵倾惯性矩量（Pitching Moment Inertia）：</strong><blockquote><ul><li>这是描述船舶绕纵向轴（Y轴）旋转的性质。</li><li>它反映了船舶在纵倾运动时的抵抗程度，通常以吨米²表示。</li></ul></blockquote></li><li><strong>艏摇惯性矩量（Yawing Moment of Inertia）：</strong><blockquote><ul><li>这是描述船舶绕垂直轴（Z轴）旋转的性质。</li><li>它反映了船舶在艏摇运动时的抵抗程度，通常以吨米²表示。</li></ul></blockquote></li></ol><p>这个矩阵的具体数值由船舶的设计和几何特性以及质量分布决定。它对于分析船舶的稳定性、响应以及控制系统的设计都非常重要。通常，惯性质量矩阵会在船舶设计和模拟中用于预测船舶在不同条件下的运动行为。</p><h3 id="5-科里奥利向心力矩阵（Corioliscentripetal-matrix）"><a href="#5-科里奥利向心力矩阵（Corioliscentripetal-matrix）" class="headerlink" title="5. 科里奥利向心力矩阵（Corioliscentripetal matrix）"></a>5. 科里奥利向心力矩阵（Corioliscentripetal matrix）</h3><p>船舶的科里奥利向心力矩阵是用于描述船舶在运动中受到科里奥利力（Coriolis Force）或向心力（Centripetal Force）的影响的矩阵。科里奥利力是一种由于物体在旋转坐标系中运动而产生的力，它会影响物体的运动轨迹，特别是在地球上的运动。</p><p>在船舶动力学中，科里奥利向心力矩阵通常是一个复杂的矩阵，用于描述船舶在不同运动状态下受到科里奥利力矩的影响。这个矩阵的具体形式会受到船舶的运动特性和坐标系定义的影响。</p><p>科里奥利力和向心力的作用可以影响船舶的运动，尤其是在船舶进行曲线运动、转弯或变速运动时。这些力会导致船舶发生横向偏转和旋转运动，因此在船舶动力学和控制系统设计中，科里奥利向心力矩阵是一个重要的概念。</p><p>具体的科里奥利向心力矩阵的计算和表达通常需要考虑船舶的运动状态、速度、坐标系以及物体相对于地球旋转的影响。这需要复杂的数学建模和分析，通常在船舶动力学研究和控制系统设计中使用。这个矩阵的形式和数学表达可能因船舶类型和问题而异。</p><h3 id="6-阻尼矩阵（damping-matrix）"><a href="#6-阻尼矩阵（damping-matrix）" class="headerlink" title="6. 阻尼矩阵（damping matrix）"></a>6. 阻尼矩阵（damping matrix）</h3><p>船舶的阻尼矩阵是一个用于描述船舶在运动中受到的阻尼力影响的矩阵。阻尼力是指障碍船舶在水中运动时产生的速度和姿态变化的力，它通常与船舶的流体动力学特性和水动力特性有关。  </p><p>阻尼矩阵是一个关于船舶运动状态和速度的函数，通常以矩阵的形式表示，用于描述不同运动状态下的阻尼效应。具体来说，阻尼矩阵包含了以下信息：</p><blockquote><ol><li><strong>线性速度阻尼（Linear Velocity Damping）：</strong>这包括船舶在纵向、横向和垂直方向上的线性速度阻尼，即船舶在不同方向上的线性速度变化所受到的阻尼力影响。</li><li><strong>角速度阻尼（Angular Velocity Damping）：</strong>这包括船舶绕纵向、横向和垂直轴的角速度阻尼，即船舶在不同轴上的角速度变化所受到的阻尼力影响。</li></ol></blockquote><p>阻尼矩阵的具体数值收到船舶的几何形状、流体动力学特性、表面粗糙度以及船舶在水中的速度等多种因素的影响。通常，为了得到阻尼矩阵的数值，需要进行复杂的水动力实验或者数值模拟。</p><p>阻尼矩阵在船舶动力学和控制系统设计中起到重要作用，因为它影响着船舶的运动响应和稳定性。通过考虑阻尼矩阵，可以更好地了解船舶在不同状态下的动态行为，以便进行航行控制，操作和船舶设计方面的优化。</p><h3 id="7-USV的PD控制器"><a href="#7-USV的PD控制器" class="headerlink" title="7. USV的PD控制器"></a>7. USV的PD控制器</h3><p>USV的PD控制器是一种用于控制USV姿态和位置的控制器。USV通常需要在水中精确控制其姿态（如横摇、纵荡、艏摇等）和位置（如横向位移、纵向位移）以完成各种任务，例如海洋勘测、水下探测、货物运输等。</p><p>以下是USV的PD控制器的一般步骤和要点：</p><blockquote><ol><li><strong>定义控制目标</strong>：首先，需要明确定义USV的控制目标，包括期望的姿态和位置。这些目标通常由任务需求和导航任务决定。</li><li><strong>姿态控制</strong>：PD控制器通常用于姿态控制，以确保USV保持期望的姿态。姿态通常包括横摇、纵荡和艏摇。对于每个姿态，您需要定义期望姿态和当前姿态之间的误差。</li><li><strong>位置控制</strong>：PD控制器也可用于位置控制，以确保USV达到期望的位置。位置通常包括横向位移和纵向位移。对于每个位置，您需要定义期望位置和当前位置之间的误差。</li><li><strong>编写PD控制器</strong>：根据姿态和位置误差，编写PD控制器的控制算法。控制输出通常是USV需要采取的行动，例如舵角或推进力的调整。</li><li><strong>调整PD参数</strong>：PD控制器的性能通常受到比例增益（Kp）和微分增益（Kd）的影响。根据实际系统的响应，需要进行参数调整，以使控制系统稳定且具有所需的性能。</li><li><strong>实时控制</strong>：USV通常配备传感器来测量当前的姿态和位置。PD控制器会根据传感器数据实时计算控制输出，并将其应用于USV的执行器，例如舵或推进器。</li><li><strong>反馈控制</strong>：PD控制器通过不断反馈和调整控制输出，使USV保持在期望的姿态和位置。这个过程在船舶运动中不断迭代，以响应外部扰动和任务需求。</li></ol></blockquote><p>PD控制器是一种常见的控制策略，用于实现USV的精确姿态和位置控制。但要注意，实际应用中可能需要更复杂的控制策略和方法，以应对不同的任务和环境条件。因此，控制器的设计和参数调整通常需要根据具体应用进行定制。</p><h3 id="8-USV的VO"><a href="#8-USV的VO" class="headerlink" title="8. USV的VO"></a>8. USV的VO</h3><p>USV的VO是一种用于USV避免与其他物体碰撞的方法。它借鉴了VO的原理，但针对水上环境和船舶特定需求进行了定制化。</p><p>以下是USV的VO的关键要点：</p><ol><li><strong>感知和预测：</strong>首先，USV需要具备感知和预测其他物体的能力。这通常通过传感器系统（如雷达、摄像头、LIDAR等）来实现，以获取周围环境的信息。同时，需要根据其他物体的运动状态和轨迹预测模型来估计其他物体未来的位置和速度。</li><li><strong>速度空间：</strong>速度障碍区域通常定义在速度空间中，这个空间包括USV的速度向量以及其他物体的速度向量。在二维情况下，速度空间通常包括USV的水平速度和垂直速度，以及其他物体的水平速度和垂直速度。在三维情况下，还需要考虑垂直方向的速度。<br><br><font size=2; color=natural>PS:垂直速度通常指的是垂直于重力方向的速度，而垂直方向速度则可以相对于任何垂直方向来定义，具体取决于上下文和参考坐标系的选择。因此，在具体应用中，需要根据上下文和参考坐标系来理解这两个术语。</font></li><li><strong>计算碰撞检测：</strong>在速度空间中，通过计算USV的速度向量与其他物体的速度向量之间的关系，可以确定可能导致碰撞的速度组合，这通常涉及一下计算：<blockquote><ul><li>计算速度向量之间的相对速度。</li><li>计算碰撞时间：即在哪个时间点，两个物体的最近距离达到最小值。</li><li>确定碰撞时间下两个物体的位置。</li></ul></blockquote></li><li><strong>速度障碍区域的计算：</strong>一旦计算出碰撞检测，可以将这些信息用于构建速度障碍区域。速度障碍区域包括USV可能的速度组合，通常以多边形或集合的形式表示，这些速度组合会导致在碰撞时间点附近与其他物体相撞。</li><li><strong>自适应速度调整：</strong>如果当前USV的速度位于速度障碍区域内，那么速度障碍法会触发自适应速度调整。这意味着USV需要选择一个可行速度，以避免与其他物体碰撞。这个可行速度通常是速度障碍区域内的一个安全区域。</li><li><strong>路径规划：</strong>一旦选择了可行速度，USV会使用路径规划算法来确定如何调整速度以避开障碍物。这可能涉及到修改航线或路径，以确保USV在考虑到速度障碍区域后仍然能够到达目标。</li><li><strong>实时控制：</strong>速度调整和路径规划是在实时中进行的，以持续检测和响应周围环境的变化。USV的控制系统需要能够快速适应新的情况，以确保安全导航。</li></ol><p>USV的VO是一种关键的碰撞避免策略，可用于各种水上任务，如海洋勘测、巡逻、救援操作等。通过结合感知、预测、速递障碍区域计算和路径规划，USV可以在复杂的水上环境中自主、安全地导航，避免与其他船只或障碍物发生碰撞。</p>]]></content>
      
      
      <categories>
          
          <category> Initial </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dr. </tag>
            
            <tag> USV </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>橙啦-颉斌斌老师 阅读课</title>
      <link href="/posts/20221112095354/"/>
      <url>/posts/20221112095354/</url>
      
        <content type="html"><![CDATA[<h2 id="阅读低分思维和满分思维的区别："><a href="#阅读低分思维和满分思维的区别：" class="headerlink" title="阅读低分思维和满分思维的区别："></a>阅读低分思维和满分思维的区别：</h2><h3 id="低分思维："><a href="#低分思维：" class="headerlink" title="低分思维："></a>低分思维：</h3><ul><li>定位：题干中有什么就去定位什么</li><li>内容：把每个单词都读懂，翻译成中文</li><li>做题：答案见过，求证 100% 正确</li><li>已知信息：原文</li></ul><p>结果：</p><ol><li>定位不准</li><li>低消耗时</li><li>出错率高<span id="more"></span></li></ol><h3 id="正确的做题方式-–-即满分思维："><a href="#正确的做题方式-–-即满分思维：" class="headerlink" title="正确的做题方式 – 即满分思维："></a>正确的做题方式 – 即满分思维：</h3><ul><li>定位：回答题干问题所问</li><li>内容：逻辑判断</li><li>做题：比出出错概率较小</li><li>已知信息：原文 + 题干 + 选项</li></ul><h3 id="传统老师的定位方法"><a href="#传统老师的定位方法" class="headerlink" title="传统老师的定位方法"></a>传统老师的定位方法</h3><ol><li>先看题干，从题干中找定位词：大写字母 &#x2F; 专有名词 &#x2F; 数字 &#x2F; 人名 &#x2F; 地名 &#x2F; 关键词</li><li>带着这些定位词到原文中去定位，找到出题句</li><li>精读出题句，对比选项看有没有同义词替换或同义改写</li><li>如果没有答案，就去看上一句或下一句，最多三句</li></ol><h3 id="怎样去避免干扰？"><a href="#怎样去避免干扰？" class="headerlink" title="怎样去避免干扰？"></a>怎样去避免干扰？</h3><p>一定要学会精准定位</p><p>题干的问题决定了精准定位，而不是题干有什么就定位什么</p><p>定位的内容一定要回答题干问题所问</p><p>题干问题所问需要深度理解问题：题干结合选项  才能对问题深度把握</p><h3 id="对比选项"><a href="#对比选项" class="headerlink" title="对比选项"></a>对比选项</h3><ol><li><p>客观接收信息</p><p>每个考生面前的信息是一样的，但读完之后会有不一样的解读！所以，如何做到对信息真实的接受，不能失真！</p><h4 id="客观"><a href="#客观" class="headerlink" title="客观"></a>客观</h4><ul><li>不加任何生活背景，不看暗含</li><li>不加自己的解释</li><li>不做主观式的推测</li></ul></li><li><p>比出出错概率最小：</p><h4 id="传统的阅读思维"><a href="#传统的阅读思维" class="headerlink" title="传统的阅读思维"></a>传统的阅读思维</h4><ol><li><p>求证正确答案的正确性：</p><p><font color='red'> 同义替 &#x2F; 同义改写 &#x2F; 逻辑高度概括 </font></p></li><li><p>求证错误选项的错误性：</p><p><font color='red'> 张冠李戴 &#x2F; 无中生有 &#x2F; 逻辑颠倒 </font></p></li></ol><h4 id="真实的考试状态"><a href="#真实的考试状态" class="headerlink" title="真实的考试状态"></a>真实的考试状态</h4><ol><li>有时间压力 - 读不懂或读不透</li><li>有心理压力 - 各种应试能力全面下降</li></ol><p>PS：在考场上大多数考生没有能力判断哪个正确</p><p>PS：选出正确选项是培训老师最大的谎言！</p><h4 id="选择题的特点"><a href="#选择题的特点" class="headerlink" title="选择题的特点"></a>选择题的特点</h4><ol><li><p>答案的唯一性  </p><p>先把错误选项干掉，再把比较不对的选项干掉（选项是比出来的）</p><ol><li>有比较对象 </li><li>选项相对正确</li></ol></li><li><p>比出一个出错概率较小的选项（必要性思维 – 前提思维）</p><p>a. 排除不沾边的，留下沾点边的</p><p>b. 只有一个沾边，就选它</p><p>c. 如果有两个沾边，比出一个出错概率较小的选项</p></li></ol><p>​         PS： 用“出错概率较小”代替“正确选项”的思维</p><h4 id="选择题答案的特点（排除法）"><a href="#选择题答案的特点（排除法）" class="headerlink" title="选择题答案的特点（排除法）"></a>选择题答案的特点（排除法）</h4><ul><li>没有对的定义，只有完全错的定义或相对不好的定义！</li><li>选项之所以选它，不是你想选它，而是被逼的不得不选它！因为别的没法选！</li></ul><h4 id="什么是评估选项"><a href="#什么是评估选项" class="headerlink" title="什么是评估选项"></a>什么是评估选项</h4><ol><li>根据题干中的问题所问到原文中定位</li><li>根据定位到的信息，对选项做出评估</li></ol><p><font color='blue'>PS: 意思一样的可以评估，意思不一样的也可以评估</font></p><p><font color='red'>评估：在这个定位得到的信息存在之下，谁的出错概率更小！</font></p><p><font color='yellowgreen'>答案具有唯一性，A能推出B，则答案一定选B！！！</font></p><p><b><font color='green' size='6px'>阅读理解可以利用的宝藏</font></b></p><h4 id="选择题无法避开的固有缺陷"><a href="#选择题无法避开的固有缺陷" class="headerlink" title="选择题无法避开的固有缺陷"></a>选择题无法避开的固有缺陷</h4><ol><li>问题的暗示</li><li>选项的暗示</li><li>原文的暗示</li><li>一致性（前后题）的暗示</li></ol><h3 id="阅读做法"><a href="#阅读做法" class="headerlink" title="阅读做法"></a>阅读做法</h3><p>先读五个题干后最后一题的4个选项（若最后一题为主旨。）</p><p>画出具体信息：</p><ul><li>名词</li><li>该名词涉及文章具体信息</li><li>词组优先</li></ul><p>PS：选项的区别是思考的角度</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> CET-6 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Reading Comprehension </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Welcome to My Blog</title>
      <link href="/posts/20221111111111/"/>
      <url>/posts/20221111111111/</url>
      
        <content type="html"><![CDATA[ <h3 id="一条没有任何思想的臭咸鱼"><a href="#一条没有任何思想的臭咸鱼" class="headerlink" title="一条没有任何思想的臭咸鱼"></a>一条没有任何思想的臭咸鱼</h3> <img src="https://pzxnys.github.io/images/lash.png">]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Sentiment analysis using deep learning architectures: a review</title>
      <link href="/posts/20221008095023/"/>
      <url>/posts/20221008095023/</url>
      
        <content type="html"><![CDATA[<p><font size="2" color="grey">Author: Ashima Yadav, Dinesh Kumar Vishwakarma</font></p><p>A significant goal of sentiment analysis is to classify and analyze the reviews related to products, hotels, online  booking sites, e-commerce sites, social media, etc.</p><span id="more"></span><p>Singla et al. (2017) They have categorized text into positive and negative polarity, and have also include sentiments of anger, anticipation, fear, joy, sadness, disgust, surprise, and trust. The classification is done through SVM resulting in an accuracy of 84.85%. These results are useful for manufacturers as they can work on the feedback to improve the quality of product.</p><p>Different  from  these  surveys, this review aims to cover the significant and widespread approaches which are introduced recently in the field of sentiment analysis using deep learning.</p><p>This survey provides a comprehensive review of the existing literature on sentiment analysis with deep learning architecture. The significant contribution of this survey can be summarized as:</p><ul class="lvl-0"><li class="lvl-2"><p>Outlined a taxonomy for sentiment classification (Fig. 3), which includes methods  using handcrafted and machine-learned feature-based approaches.</p></li><li class="lvl-2"><p>Discuss the architecture of various deep learning-based approaches to summarize  the notable work and highlight the popular deep learning-based architecture used  by various researchers for sentiment analysis.</p></li><li class="lvl-2"><p>Present the vital sentiment analysis tasks and identify why deep learning models  are increasingly applied to them.</p></li><li class="lvl-2"><p>Identify the popular sentiment analysis datasets, the accuracy obtained on them,  and discuss the need for creating own corpus for sentiment analysis.</p></li></ul><div align = 'center'><img src="https://pzxnys.github.io/images/211112163624.png"/></div><ul class="lvl-0"><li class="lvl-2"><p>•Outlined a taxonomy for sentiment classification (Fig.3), which includes methods using</p></li><li class="lvl-2"><p>handcrafted and machine-learned feature-based approaches.</p></li><li class="lvl-2"><p>•Discuss the architecture of various deep learning-based approaches to summarize the</p></li><li class="lvl-2"><p>notable work and highlight the popular deep learning-based architecture used by various</p></li><li class="lvl-2"><p>researchers for sentiment analysis.</p></li><li class="lvl-2"><p>•Present the vital sentiment analysis tasks and identify why deep learning models are</p></li><li class="lvl-2"><p>increasingly applied to them.</p></li><li class="lvl-2"><p>•Identify the popular sentiment analysis datasets, the accuracy obtained on them, and discuss</p></li><li class="lvl-2"><p>the need for creating own corpus for sentiment analysis.</p></li></ul><p>The organization of the survey is shown in Fig. 2.</p><div align="center"><img src = "https://pzxnys.github.io/images/211112194433.png"/></div><p>The sentiment analysis tasks can be categorized into two parts: core(or major) tasks which are referred as the basic sentiment analysis tasks, and second category includes the sub-tasks that are called sub-categories of the major tasks.</p><h2 id="Document-level-sentiment-classification">Document-level sentiment classification</h2><p>This level of classification takes the whole document as a primary unit of information focusing on one topic or object. The document is further categorized into positive polarity or negative polarity . Thus, an overall sentiment of text can be generated.</p><h3 id="Disadvantage">Disadvantage</h3><p>Disadvantage is difficult to extract the different polarity or sentiment about distinct entities separately .</p><h2 id="Sentence-level-sentiment-classification">Sentence-level sentiment classification:</h2><p>A sentence is classification into subjective type or objective type.</p><h3 id="Subjective">Subjective</h3><p>Express an opinion towards an entity. Hence, it is considered as a subjective statement that can be further classified into different polarities.</p><h3 id="Objective">Objective</h3><p>Factual statement</p><h2 id="Aspect-level-sentiment-classification">Aspect-level sentiment classification</h2><p>(feature-based sentiment analysis, entity-based sentiment analysis) This sentiment analysis task includes the identification of features or aspects in a sentence (which is a user-generated review of an entity) and categorizing the features as positive or negative. The sentiment-target pairs are first identified, then they are classified into different polarities, and finally, sentiment values for every aspect are clubbed.</p><h2 id="Multi-domain-sentiment-classification">Multi-domain sentiment classification</h2><p>The word $ domain $ is referred as a set of documents that are related to a specific topic. Multi-domain sentiment classification focuses on transferring information from one domain to the next domain. The models are first trained in source domain; the knowledge is then transferred  and explored in another domain.</p><h2 id="Multimodal-sentiment-classification">Multimodal sentiment classification</h2><p>Different people express their sentiments or opinions in different ways.  Earlier, the text was considered as the primary medium to express an opinion.  This is known as a unimodal approach. With the advancement of technology and  science, people are now shifting towards visual (videos, images, or clips) and  audio (speech) modalities to express their sentiments. Combining or fusing more  than one modalities for detecting the opinion is known as multi-modal sentiment  analysis. Hence, researchers are now focusing on this direction for improving  the sentiment classification process.</p><p>Due to the enormous data available on social media in different forms like videos, audios, photos for expressing sentiment on social media platforms, the conventional approach for text-based sentiment analysis was progressed into compound models of multimodal sentiment analysis. Hence, mining the opinions expressed in different modalities became a crucial approach.</p><p>The popular models applied to sentiment analysis (SA) tasks can be summarised as:</p><ul class="lvl-0"><li class="lvl-2"><p>For document-level sentiment classification, CNN followed by LSTM has shown the highest on the various dataset.</p></li><li class="lvl-2"><p>For sentence-level sentiment classification and aspect-level sentiment classification,researchers have majorly focused on RNN(Particularly LSTM).</p></li><li class="lvl-2"><p>For multi-domain sentiment classification, LSTM has given good results, and for multi-modal sentiment classification, CNN and RNN are popular deep learning models. Hence, RNN models are the most sought-after and popular choice for sentiment analysis among researchs.</p></li><li class="lvl-2"><p>Further, we can see that LSTM is popular applied for text-based sentiments, and CNN models have shown good results for image sentiment. For multimodal data, CNN+LSTM followed by fusion becomes the desired approach.</p></li></ul><p>However, the choice of a specific deep learning model may still depend on the various number of factors like the amount of data available, the number of hidden units (nodes) required for the problem, etc.</p><h2 id="Future-extraction">Future extraction</h2><p>including handcrafted features and machine-learned features.</p><h2 id="Machine-learned-features">Machine-learned features</h2><p>can be categorized into traditional machine learning-based approaches and deep learning-based approaches.</p><h3 id="Machine-learning-based-methods">Machine learning-based methods</h3><p>include Support Vector Machine (SVM), Naive Bayes (NB), Maximum Entropy (ME), Decision tree learning, and Random Forests. They are further categorized into supervised and unsupervised learning methods.</p><p>It becomes evident that the number of established approaches for supervised learning is more as compound to unsupervised learning-based approaches.</p><h3 id="Deep-learning-based-approaches">Deep learning-based approaches</h3><p>include Convolution Neural Network, Recursive Neural Network, Recurrent Neural Network (which includes LSTM and GRU), Deep Belief Networks, Attention-based networks, Bi-directional Recurrent Neural Network, and Capsule Network.</p><p>Deep Learning reduces the burden of design as when the network learns, it automatically creates the required features for the classification process.</p><p>At present, a massive amount of data is being generated. traditional machine learning-based approaches fail to perform. On the contrary, deep learning models outperform the machine learning approaches as they can be trained to learn more features with large datasets. This justifies the fact that deep learning models show improved performance than traditional machine learning models.</p><h2 id="Convolutional-neural-networks-CNNs">Convolutional neural networks(CNNs)</h2><p>belong to the class of neural networks and have shown significant success and innovation in computer vision and image processing. The fundamental architecture of CNN is displayed in Fig. 4.</p><div align='center'><img src="https://pzxnys.github.io/images/211118151133.png"/></div><h3 id="Embeddings">Embeddings</h3><p>It can be obtained using Skip Gram model and Common Bag of words(CBOW).</p><h4 id="CBOW">CBOW</h4><p>The model predicts the current word from surrounding context words.</p><h4 id="Skip-Gram">Skip Gram</h4><p>The model predicts the surrounding context words from the current word.</p><h2 id="Recursive-neural-networks-RecNNs">Recursive neural networks (RecNNs)</h2><p>It belongs to the category of the network, that learns a directed acyclic graph structure (e.g., tree structure ).</p><p>Figure 6 shows a Rec NN in which whenever a sequence of n-gram (e.g., This Bag  has Beautiful color), is fed into the model, each word of n-gram sequence is  represented as a d-dimensional vector.</p><div align='center'><img src="https://pzxnys.github.io/images/211123100936.png"/></div><h2 id="Recurrent-neural-networks-RNNs">Recurrent neural networks (RNNs)</h2><p>It is a variant of Rec NN and is used for modeling the sequential data. Sequential data is applied in a variety of applications.</p><p>RNN considers the time factor for processing the elements in a sequence.</p><p>Figure 9a shows an RNN with a loop that preserves all the information, whereas,  in Fig. 9b, the unrolled version indicates that multiple copies of RNN are  connected, and they communicate by passing information from one state to another</p><div align='center'><img src="https://pzxnys.github.io/images/211123140003.png"/></div><p>The commonly used variants of RNNs are LSTM, GRU, bi-directional RNNs, and deep  RNNs.</p><h3 id="Long-short-term-memory-LSTM">Long short-term memory(LSTM)</h3><p>It is one of the most popular variants of RNN, which possesses the capability to handle the vanishing gradient problem in standard RNN and can catch long-term dependencies. This makes them more powerful and flexible. The architecture of LSTM is shown in Fig. 10.</p><div align='center'><img src="https://pzxnys.github.io/images/211124155129.png"/></div><h3 id="Gated-Recurrent-units-GRUs">Gated Recurrent units (GRUs)</h3><p>GRUs are variants of LSTM and are considered as LSTM without an output gate. The architecture of GRU is shown in Fig. 12.</p><div align='center'><img src="https://pzxnys.github.io/images/211124201654.png"/></div><h3 id="Deep-belief-networks-DBNs">Deep belief networks (DBNs)</h3><p>DBNs emanate under the type of unsupervised pre-trained networks, which also includes autoencoders and Generative Adversarial Networks. DBNs are composed of multiple layers of unsupervised networks like Restricted Boltzmann Machines (RBMs) or autoencoders as shown in Fig. 13a.</p><div align='center'><img src="https://pzxnys.github.io/images/211124203545.png"/></div><h2 id="Drawbacks-of-deep-learning-approaches-in-sentiment-analysis">Drawbacks of deep learning approaches in sentiment analysis</h2><p>Although, deep learning algorithms have shown excellent outcomes and significant evolution in sentiment analysis, yet there exist some drawbacks of applying these algorithms which are stated as follows:</p><ul class="lvl-0"><li class="lvl-2"><p>Most deep learning techniques require a lot of labeled data for training to make sure that machine delivers the desired results. Hence, for sentiment analysis, we require a large corpus to properly train the deep learning model for correct prediction of class labels. Gathering and labeling large amounts of data can be very difficult and tedious.</p></li><li class="lvl-2"><p>Unlike traditional machine learning or lexical methods where we know what features are selected for predicting a particular sentiment, it is hard to figure out what is the actual reason for the neural network to predict a specific to get an intuition about the prediction process of the neural networks, and they behave like a “black box” to many researchers.</p></li><li class="lvl-2"><p>Deep learning techniques like CNN requires tuning of initial parameters as a  starting point. This can be seen in Stojanovski et al. (2015). Thus, the  performance of the network depends upon the values of the hyperparameters of the  network. Hence, deciding the optimal hyperparameter values is a challenging task</p></li><li class="lvl-2"><p>Due to a large number of parameters present in the deep learning models, the  time taken to train them is often very large (Dufourq and Bassett 2017).  Moreover, they need high performing hardware like GPUs and large RAM for better  efficiency.</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sentiment Analysis </tag>
            
            <tag> Review </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Anaconda环境配置</title>
      <link href="/posts/20211229133032/"/>
      <url>/posts/20211229133032/</url>
      
        <content type="html"><![CDATA[<h4 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h4><h5 id="新建环境"><a href="#新建环境" class="headerlink" title="新建环境"></a>新建环境</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda create -n NAME python&#x3D;&#x3D;xxx<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="将环境添加到jupyterLab"><a href="#将环境添加到jupyterLab" class="headerlink" title="将环境添加到jupyterLab"></a>将环境添加到jupyterLab</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda activate NAMEconda install ipykernelpython -m ipykernel install --user --name NAME --display-name NAME<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><h5 id="将环境从jupyterLab中删除"><a href="#将环境从jupyterLab中删除" class="headerlink" title="将环境从jupyterLab中删除"></a>将环境从jupyterLab中删除</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">jupyter kernelspec remove NAME<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h5 id="删除环境"><a href="#删除环境" class="headerlink" title="删除环境"></a>删除环境</h5><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda remove -n NAME --all<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="TensorFlow安装"><a href="#TensorFlow安装" class="headerlink" title="TensorFlow安装"></a>TensorFlow安装</h4><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda activate NAME<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>（Version &gt; 2.4  2021年12月29日18:37:18）</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">pip install tensorflow&#x3D;&#x3D;xxxconda install cudaToolkitconda install cudnn<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>(Version &lt;&#x3D; 2.4 2021年12月29日18:39:26)</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">conda install tensorflow&#x3D;&#x3D;xxx    &#x2F;&#x2F;conda 自动将对应的版本的 cuda 和 cudnn 安装完成。<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><h4 id="PyTorch安装"><a href="#PyTorch安装" class="headerlink" title="PyTorch安装"></a>PyTorch安装</h4><p> 参见官网<a target="_blank" rel="noopener" href="https://pytorch.org/get-started/locally/">https://pytorch.org/get-started/locally/</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> Anaconda </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Data processing (Tourism )</title>
      <link href="/posts/20211115100205/"/>
      <url>/posts/20211115100205/</url>
      
        <content type="html"><![CDATA[<p><a name="97buO"></a></p><h3 id="①-jieba分词"><a href="#①-jieba分词" class="headerlink" title="①. jieba分词"></a>①. jieba分词</h3><p>使用jieba分词工具，对马蜂窝爬取数据进行简单处理<br /><br>首先，去除停用词、表情符号，英文等字符，避免干扰<br /><br>PS：只保留中文字符（if word &gt;&#x3D; u’\u4e00’ and word &lt;&#x3D; u’\u9fa5’:）(此数据采用中文’utf-8’编码)<br /></p><span id="more"></span><p>去除停用词（if word not in stopwords:）（stopwords为预加载的中文停用词表）<br />其次，采用jieba分词的精确分词模式，对预处理过的数据进行分词<br /><br>最后，将266个景点评论合并到同一个文档中，其中每一行的头部为景点名称，后面为其评论<br /></p><p><a name="e6Cwh"></a></p><h3 id="②-计算TF-IDF"><a href="#②-计算TF-IDF" class="headerlink" title="②. 计算TF-IDF"></a>②. 计算TF-IDF</h3><p>TF-IDF——词项在向量中的权重方法：表示TF(词频)和IDF(倒文档频率)的乘积：<br /><br>$tf-idf_{i, j} &#x3D; tf_{i, j} * idf_i$<br /><br>其中 TF 表示某个关键词出现的频率，IDF 为所有文档的数目除以包含该词语的文档数目的对数值。<br /><img src="https://pzxnys.github.io/images/1607666893076.png"><br />|D|表示所有文档的数目，|w∈d|表示包含词语w的文档数目。<br />使用 scikit-learn 工具调用CountVectorizer()和TfidfTransformer()函数计算 TF-IDF 值<br />CountVectorizer()：通过 fit_transform 函数将文本中的词语转换为词频矩阵<br />矩阵元素 weight[i][j] 表示 j 词在第 i 个 文本下的词频，即各个词语出现的次数<br />通过 get_feature_names() 可看到所有文本的关键字，通过 toarray() 可看到词频矩阵的结果<br /><br><br />TfidfTransformer 也有个 fit_transform 函数， 它的作用是计算 tf_idf 值。<br /><br><br />输出 93244 维特征，其中共266个景点<br />故构建的矩阵为：[266][93244]<br />或许特征值较大，下一步考虑降维<br /></p><p><a name="7QXfF"></a></p><h3 id="③-K-Means-聚类"><a href="#③-K-Means-聚类" class="headerlink" title="③. K-Means(聚类)"></a>③. K-Means(聚类)</h3><p><br />首先，理解一下什么是聚类。<br />聚类：它的目的也是把数据分类，却与分类不同。事先不知道如何去分，完全是算法自己来判断各条数据之间的相似性，相似的就放在一起。<br />在聚类的结论出来之前，完全不知道每一类有什么特点，一定要根据聚类的结果通过人的经验来分析，看看聚成的这一类大概有什么特点。<br /><br><br />其次，聚类和分类有什么不同。<br />分类的目标是事先已知的，而聚类则不一样，聚类事先不知道目标变量是什么，类别没有像分类那样被预先定义出来。<br /><br><br />最后，重头戏登场。<br />K-Means：聚类算法有很多种(几十种)，K-Means 是聚类算法中的最常用的一种。<br />特点：简单、好理解、运算速度快<br />缺点：只能应用于连续型的数据，并且一定要在聚类前手动指定要分成几类。<br />算法思想：求加权均值，大概需要迭代3~5步<br /></p><p><a name="nePuH"></a></p><h3 id="④-特征提取"><a href="#④-特征提取" class="headerlink" title="④. 特征提取"></a>④. 特征提取</h3><p><br />1、使用 WordCloud 对特征进行提取，以及生成词云图，由于为旅游景点的游客评价，因此特征提取效果甚是不好，需要融入其它因素<br />2、使用 tfidf，进行权重计算，但是主要用于聚类，未应用到实际特征提取，需要进一步了解<br />3、使用 embedding 进行特征提取，需要进一步了解<br />4、引入评分，做一个新的建模，进行权重加持，需要进一步思考（急）<br />5、引入历史天气信息，暂时考虑<br /><br><br /></p><p><a name="lMaPM"></a></p><h3 id="⑤-数据清洗"><a href="#⑤-数据清洗" class="headerlink" title="⑤. 数据清洗"></a>⑤. 数据清洗</h3><p><br />1、抽取爬虫数据时，自动去除非中文、数字、英文(暂时考虑保留)的字符，可以解决数据非正常换行，制表符等转义字符问题，造成字典异常<br />ps: 地名包含的数字和英文：0123589    M SKY RING O I · ,暂时考虑只保留这些数字和英文，<br />2、将列表文件转存为字典文件，会自动去重，可以降低数据冗余<br />3、由于生成字典格式，每写入一个 key-value，均需插入’,’ ，使得最后写出的文件多一个逗号，需手动删除。可以考虑进行优化(已优化，具体测试代码如下：)<br /></p><pre class="line-numbers language-none"><code class="language-none">import jsonlist &#x3D; [&#123;&#39;color&#39;: &#39;greefja放假啊的说法\nnnfhasjkfhajk话费卡技术复核hell&#39;, &#39;point&#39;: 5&#125;, &#123;&#39;color&#39;: &#39;yellow&#39;, &#39;point&#39;: 10&#125;,&#123;&#39;color&#39;: &#39;green\nhell&#39;, &#39;point&#39;: 5&#125;,&#123;&#39;color&#39;: &#39;green\nhell&#39;, &#39;point&#39;: 5&#125;, &#123;&#39;color&#39;: &#39;red&#39;, &#39;point&#39;: 15&#125;]dict &#x3D; &#123;&#125;for l in list:    outstr &#x3D; &#39;&#39;    for g in l[&#39;color&#39;]:     # 数据清洗        if g &gt;&#x3D; u&#39;\u4e00&#39; and g &lt;&#x3D; u&#39;\u9fa5&#39;:     #保留中文字符(utf-8)            outstr +&#x3D; g        elif g &gt;&#x3D; u&#39;\u0030&#39; and g &lt;&#x3D; u&#39;\u0039&#39;:     # 保留阿拉伯数字(utf-8)            g +&#x3D; g        elif g &gt;&#x3D; u&#39;\u0041&#39; and g &lt;&#x3D; u&#39;\u007a&#39;:     # 保留英文大小写(utf-8)           outstr +&#x3D; g    dict[outstr] &#x3D; str(l[&#39;point&#39;])    # 生成一个新字典<p>print(dict)with open('a.txt', 'w', encoding='utf-8') as c:c.write(json.dumps(dict, ensure_ascii=False))     将字典原样写入文件 (其中，ensure_ascii = False 为了保证中文不乱码)</p><p>#读取上面保存的文件with open('a.txt', 'r', encoding='utf-8') as test:dict = json.loads(test.readline())</p><p>print(dict)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p><a name="cFdKQ"></a></p><h3 id="⑥-仿真用户行为日志数据（MongoDB）"><a href="#⑥-仿真用户行为日志数据（MongoDB）" class="headerlink" title="⑥. 仿真用户行为日志数据（MongoDB）"></a>⑥. 仿真用户行为日志数据（MongoDB）</h3><p><a name="zhjyP"></a></p><h4 id="1、-json格式数据集导入"><a href="#1、-json格式数据集导入" class="headerlink" title="1、  json格式数据集导入"></a>1、  json格式数据集导入</h4><p>向 MongoDB 导入 json 格式的数据集，用 Navicat 15 ，提示 Not a valid JSON。<br />索性自己使用命令行，向 MongoDB 导入数据集。<br />sudo mongoimport –db newdb –collection newcoll –file primer-dataset.json<br />其中，newdb为数据库名字，newcoll为导入的数据集名字<br /></p><p><a name="UAwlA"></a></p><h4 id="2、清理数据"><a href="#2、清理数据" class="headerlink" title="2、清理数据"></a>2、清理数据</h4><p>按条件删除多组mongo数据库中数据：<br /><code>collection.delete_many(&#123;条件对&#125;)</code><br /><code>输出删除的总计: result.deleted_count</code><br />​<br /><br><a name="YYrC8"></a></p><h4 id="3、增加天气因素。"><a href="#3、增加天气因素。" class="headerlink" title="3、增加天气因素。"></a>3、增加天气因素。</h4><p>字符串截取：将字符串按某一特定字符截取n段，并转为数组。<br /><code>str.split(&#39;/&#39;, n)</code><br />判断字典中是否存在某个key：<br /><code>&#39;xxx&#39; not in dict.keys()</code><br />按条件插入或修改多组mongo数据库中的某字段数据：<br /><code>collection.update_many(&#123;条件对&#125;,&#123;&#39;$set&#39;:&#123;修改对&#125;&#125;)</code><br /></p><p><a name="hrhxV"></a></p><h4 id="4、模拟用户旅游时长"><a href="#4、模拟用户旅游时长" class="headerlink" title="4、模拟用户旅游时长"></a>4、模拟用户旅游时长</h4><p>调整 random 概率，预先设置一个集合，则会按该集合各数字所占比列进行random：<br /><code>b = (1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 3, 3, 3, 4, 5, 6, 6, 6)</code><br /><code>num = random.sample(b, n)</code><br />其中n为随机生成的数组长度<br />​<br /><br><a name="xZBco"></a></p><h4 id="5、模拟景区拥挤度"><a href="#5、模拟景区拥挤度" class="headerlink" title="5、模拟景区拥挤度"></a>5、模拟景区拥挤度</h4><p>安装插件 chinesecalendar。<code>pip install chinesecalendar</code><br />将日期转为 date 型：<br />保留时分秒：<code>datetime.strptime(date, &#39;%Y-%m-%d&#39;)</code> PS: Y, m, d 顺序根据需要进行调整<br />不保留时分秒：datetime.strptime(date, ‘%Y-%m-%d’).date()<br />调用插件判断该日期是否为工作日：<br /><code>from chinese_calendar import is_workday</code><br /><code>is_workday(date)</code>  返回值为 boolean 类型。<br><a name="ABKtZ"></a></p><h3 id="⑧-Mysql"><a href="#⑧-Mysql" class="headerlink" title="⑧.Mysql"></a>⑧.Mysql</h3><p><a name="WogJB"></a></p><h4 id="1、-json数据拆分"><a href="#1、-json数据拆分" class="headerlink" title="1、 json数据拆分"></a>1、 json数据拆分</h4><p>虽然 MySQL 数据库的查找、更新速度比 MongoDB 快的多(实测情况，MySQL 与 MongoDB 的速度差不太多，最后直接使用 json 文件，进行数据清洗)<br />但是使用 Python 向其导入 json 文件的速度，相形之下要慢的多，因此需对超大数据集进行拆分<br />多线程，同步插入数据，更有效率<br />PS：MySQL 写入，并不会占用 CPU 线程达100%<br /></p><pre class="line-numbers language-none"><code class="language-none">import json# 读取大json文件N &#x3D; []with open(&#39;..&#x2F;data&#x2F;review.json&#39;, &#39;r&#39;, encoding&#x3D;&#39;utf-8&#39;) as f1:    for line in f1.readlines():        N.append(line.strip())print(len(N))# 转存略显繁琐，但为导入做准备i &#x3D; 0co &#x3D; 0f &#x3D; open (&quot;..&#x2F;data&#x2F;review_&quot; + str(i) + &quot;.json&quot;, &#39;w&#39;, encoding&#x3D;&#39;utf8&#39;)for li in N:    co +&#x3D; 1    f.write(str(li) + &#39;\n&#39;)    if co &#x3D;&#x3D; 600000:        co &#x3D; 0        i +&#x3D; 1        f.close()        print(str(i) + &#39; File close!!!&#39;)        f &#x3D; open (&quot;..&#x2F;data&#x2F;review_&quot; + str(i) + &quot;.json&quot;, &#39;w&#39;, encoding&#x3D;&#39;utf8&#39;)        continue <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a name="tBJQH"></a></p><h4 id="2、-json-数据导入"><a href="#2、-json-数据导入" class="headerlink" title="2、 json 数据导入"></a>2、 json 数据导入</h4><p>大部分 json 文件不能直接通过 Navicat 导入到 MySQL</p><pre><code>  - 有一个插件：mysqljsonimport，但是一直没能成功使用， 不知道是 MySQL 版本问题，还是安装时的配置问题，未解决  - 有一个工具，成功导入了 1000 条，但是收费不低，而且破解版一直未找到，记录一下工具名称：JSONtoMySQL。后期可继续寻找  - 通过 python，先将 json 文件读出，然后写入 MySQL，具体代码如下：</code></pre><pre class="line-numbers language-none"><code class="language-none">import jsonimport pymysqlconn &#x3D; pymysql.connect(    # 服务器地址    host &#x3D; &#39;192.168.3.78&#39;,    # 端口号    port &#x3D; 3306,    # 用户名    user &#x3D; &#39;root&#39;,    # 密码    passwd &#x3D; &#39;123456&#39;,    # 数据库名称    db &#x3D; &#39;yelp&#39;,    # 字符编码格式    charset &#x3D; &#39;utf8&#39;,    )# 设置游标，进行数据库操作cur &#x3D; conn.cursor()# open filepath &#x3D; &#39;..&#x2F;data&#x2F;review.json&#39;<p>with open(path, 'r', encoding='utf-8') as f:ln = 0for line in f.readlines():ln += 1dic = json.loads(line)# 一逗号进行key拼接，对应json中的字段keys = ','.join(dic.keys())# print(keys)# 将字典value信息存储成listvaluesList = [dici for dici in dic.values()]# 进行List列表的遍历for index1, value1 in enumerate(valuesList):# 如果是list,将其以str类型存储if isinstance(value1, list):valuesList[index1] = str(value1)# 将str类型转化成元组形式存储valuesTuple = tuple(valuesList)# 将value值进行拼接values = ', '.join(['%s']*len(dic))# print(values)# 设置表名称table=&quot;review&quot;#构造sql插入语句sql = 'INSERT INTO &#123;table&#125;(&#123;keys&#125;) VALUES (&#123;values&#125;)'.format(table=table, keys=keys, values=values)<br># 执行sql语句cur.execute(sql,valuesTuple)conn.commit()if ln%10000 == 0:print(str(ln) + ' End!')conn.close()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></p><p><a name="toRp0"></a></p><h3 id="⑨-评价指标"><a href="#⑨-评价指标" class="headerlink" title="⑨. 评价指标"></a>⑨. 评价指标</h3><p>1、NDCG</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">r&#x3D;np.array([1,0,0,1,0])dcg &#x3D; r[0] + np.sum(r[1:] &#x2F; np.log2(np.arange(2, r.size + 1)))r_s &#x3D; sorted(r,reverse&#x3D;True)r_s &#x3D; np.array(r_s)dcg_max &#x3D; r_s[0] + np.sum(r_s[1:] &#x2F; np.log2(np.arange(2, r_s.size + 1)))print(dcg,dcg_max)dcg&#x2F;dcg_max<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br /><br />]]></content>
      
      
      <categories>
          
          <category> ML &amp;&amp; DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dataset </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DBSCAN_Yelp</title>
      <link href="/posts/20211115095724/"/>
      <url>/posts/20211115095724/</url>
      
        <content type="html"><![CDATA[<h3 id="DBSCAN"><a href="#DBSCAN" class="headerlink" title="DBSCAN"></a>DBSCAN</h3><p>利用 DBSCAN 聚类算法，对经纬度进行聚类<br>​</p><p>代码如下：</p><span id="more"></span><pre class="line-numbers language-python" data-language="python"><code class="language-python">import pandas as pdimport numpy as npfrom sklearn.cluster import DBSCANfrom sklearn import metricsimport osdef dbscan(input_file):    columns&#x3D;[&#39;lon&#39;,&#39;lat&#39;]    in_df &#x3D; pd.read_csv(input_file, sep&#x3D;&#39;,&#39;, header&#x3D;1, names&#x3D;columns)    print(in_df)    coords &#x3D; in_df.values     kms_per_radian &#x3D; 6371.0086       epsilon &#x3D; 0.4 &#x2F; kms_per_radian     db &#x3D; DBSCAN(eps&#x3D;epsilon, min_samples&#x3D;10, algorithm&#x3D;&#39;ball_tree&#39;, metric&#x3D;&#39;haversine&#39;).fit(np.radians(coords))    cluster_labels &#x3D; db.labels_     num_clusters &#x3D; len(set(cluster_labels) - set([-1]))     print( &#39;Clustered &#39; + str(len(in_df)) + &#39; points to &#39; + str(num_clusters) + &#39; clusters&#39;)     for n in range(num_clusters):        #print(&#39;Cluster &#39;, n, &#39; all samples:&#39;)        one_cluster &#x3D; coords[cluster_labels &#x3D;&#x3D; n]        print(len(one_cluster))        #clist &#x3D; one_cluster.tolist()        #print(clist[0])        def main():    path &#x3D; &#39;.&#x2F;data&#39;    f &#x3D; &#39;placell.csv&#39;    datafile &#x3D; os.path.join(path,f)    print(datafile)    dbscan(datafile)    if __name__ &#x3D;&#x3D; &#39;__main__&#39;:    main()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>利用此算法，将 12094 家店铺聚类为 163 类，每一类至少有 10 家店铺。<br>并存储。<br>重新做数据，将聚类标签添加至数据集中。<br>创建 dqn_coords，训练不同地理位置所适应的店铺。<br>将其作为参数引入 YELP 的推荐中。<code>​</code><br>获得新的推荐结果。<br>​</p><h3 id="数据模拟"><a href="#数据模拟" class="headerlink" title="数据模拟"></a>数据模拟</h3><p>对用户的 70W+ 记录进行完全随机模拟生成用户所在地理位置，或许，模拟出的位置分类与其真实所到的位置相距很远，<br>但是在后期推荐的时候，由于推荐结果的某些特性，在一定程度上来说，提高了对于分类的准确性，综合结果有待评价。<br>​</p><p>若利用聚类的结果，对用户的 70W+ 记录进行随机模拟生成用户所在地理位置，其模拟出的位置与实际位置相距很近，<br>但在后期推荐的时候，对于根据地理位置进行推荐的准确率有所偏低，综合结果有待评价。</p>]]></content>
      
      
      <categories>
          
          <category> ML &amp;&amp; DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Cluster </tag>
            
            <tag> Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>记录一次磁盘爆炸血泪史</title>
      <link href="/posts/20211115095547/"/>
      <url>/posts/20211115095547/</url>
      
        <content type="html"><![CDATA[<p><a name="fMQD6"></a></p><h3 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h3><p>这是最初建立 ubuntu + Windows 10 留下的一个诟病。<br />由于网上大部分教程，及之前个人实验的影响。在建立 Ubuntu 系统时，根目录仅分配了 40 G 的磁盘容量。<br />本想着就只是存储一些代码，和少许的数据集，不可能把根目录撑爆，奈何大意失荆州啊！！！</p><span id="more"></span><p><a name="Wj4s6"></a></p><h3 id="问题出现"><a href="#问题出现" class="headerlink" title="问题出现"></a>问题出现</h3><p>2021.07.07 下午，如往常一样，“开心”地做实验。<br />由于对比实验的需求，在多如牛毛的数据集中(其实也就3个)，找到了比较适合的数据集 YELP。<br />同之前操作，开始向 mongodb 导入这个“高达” 12 G 的数据集合。<br />把最大的一个约 6 G 大小的用户评论表导入成功之后，一切还是波澜不惊(主要是没有查看磁盘容量的习惯)<br />接下来开始导入用户注册表，本以为它是正常导入，结果没想到，mongodb 突然无法远程连接，我简直是大吃一惊，<br />以为和苹果连接特定名称WiFi，导致WiFi永久不能使用一样。我导入的用户表中，也有这样的字符串嘛？简直是吓破胆啊！<br />于是开始疯狂找解决办法，我还是很天真的想着，如何把刚导入的那个表删除。但是 mongodb 就是不给你连接，你有什么办法。哎！<br />就这样，经过一个多小时的挣扎，试了百度、博客、csdn等各路大神的指导，问题仍在哪里，纹丝不动。（内心：我到底做错了什么）<br />高潮来了，本想着 linux 的“稳定性”(再也不信了)重启解决所有问题，我按下了这该死的重启键。<br />问题并没有想象中那么愉快的解决，反而系统进入了无限输入密码的阶段（内心已经完全崩溃），难道这就要重新搭建系统了嘛？我拒绝！！！<br><a name="rjqYC"></a></p><h3 id="寻找问题症结"><a href="#寻找问题症结" class="headerlink" title="寻找问题症结"></a>寻找问题症结</h3><p>“程序员干的最 sb 的一件事就是：修改前辈们的代码，你本想着只是把整体结构梳理清晰，结果弄成了山体坍塌”<br />我本想着把 MongoDB 的服务打开，没想到，系统就这样崩了，崩了，崩了！！！<br />我有继续在百度、博客、csdn等各大网站畅游，试过无数方法，他仍旧不能进入桌面（马上要疯。。。）<br />直到一句话，“你的磁盘满了，登录信息无法写入，所以无法进入桌面”，哇，悟了。<br><a name="Yk3I6"></a></p><h3 id="先修房子"><a href="#先修房子" class="headerlink" title="先修房子"></a>先修房子</h3><p>天真的我，开启 Windows 系统，使用系统磁盘管理，将一块基本不用的盘（大概 605 G，简直是暴殄天物）格式化，为 Ubuntu 的扩容<br />本想着，分区工具（DiskGenius）是神一般的存在，所有的硬盘问题，交给他就是洒洒水的事。没想到，所托非人。连续两次的扩容尝试，让我意识到，他不行了！<br />接下来，继续开启百度、博客、csdn等各大网站(身边有一个 linux 大神，该有多好)。一款闻所未闻的分区工具(gparted)出现在了我的眼前<br />但，大部分都是在系统正常的时候，使用其对根目录进行扩容。难道我又失败了？真的要重做系统吗？不要这样折磨我好吗？<br />突然有句话出现了，它可以烧录到 u 盘上，作为镜像启动。天呐，太牛了。就 u 盘多<br />进入官方网站<a target="_blank" rel="noopener" href="https://gparted.org/download.php">下载</a>，随手翻篇帖子。将U盘格式化为 FAT 格式（之前为了方便存大文件，都是 NTFS 格式的）。经压缩包解压到 U 盘根目录（官方要求）<br />进入  ‘utils&#x2F;win32&#x2F;‘ 文件夹下，右键管理员运行 makeboot.bat (官方真的有够细心)<br />开始常规 u 盘启动，经过一系列胡乱操作之后，进入到了硬盘管理界面。重新调配硬盘大小，执行。。。<br />………………………………………………………………………………………waiting…………………………………………………………………………………………<br />就这样，一个半小时过去了。硬盘完全调配好了，还等什么，麻利拔 U 盘，赶紧开机<br />果真没让我失望，他开了，他终于开了（内心可喜，结果发现高兴过早了！！！）<br><a name="HwEhA"></a></p><h3 id="再补漏洞"><a href="#再补漏洞" class="headerlink" title="再补漏洞"></a>再补漏洞</h3><p>经过了近三个小时的挣扎，系统算是成功打开了。<br />本想着，系统都能正常运行了，你 MongoDB 就别在那拘着了，有什么好傲娇的呢？可是他就是不顺你的心意，这就是我刚说的高兴太早了<br />为了能把 MongoDB 打开，我搜索其反馈的各种错误代码，以及查看运行日志，甚至联系 DBA 大神 – 东东(身边真的没什么玩数据库的，<br />奈何他只搞 Oracle 和 MySQL，而且还说了一句话，生产的数据库是不会挂的，如果没问题，找你干嘛)<br />修改配置文件，删除锁文件，修改权限，等等。网络“大神”给出的方案真的是五花八门，不过我早就料到回是这样，于是就一个个的开始尝试，<br />最后，不出所料，我以失败而告终，已经晚上9点多了，好饿。。。<br />以后有问题，一定要先看官方文档（为什么我就不看呢，服了自己了。）<br />MongoDB 有一个很牛的功能，即使你不能打开服务，也能使用其提供的函数 mongodump，将数据库完整的备份出来。<br />然后，等数据库修复好之后，再用函数 mongorestore，将其恢复。(可能是我太天真了，一切都不是那么顺利。)<br />数据备份还是比较轻松的，先在根目录创个文件夹，用来存备份文件， mkdir -p &#x2F;remote_dir&#x2F;mongo_dump_dir<br />开始备份数据库：  mongodump -d tourism -o &#x2F;remote_dir&#x2F;mongo_dump_dir<br />       接下来就不担心数据问题了，明天早点来搞时间： 21:44<br />………………………………………………………………………………………………手动分割线……………………………………………………………………………………………<br />2020.07.08<br />今天早上来了之后，不用想其它了，直接重装数据库吧。(面对疾风吧！！！)<br />经过网上一系列卸载 MongoDB 的教程之后，我发现重装的数据库仍然不能打开，这不是欺人太甚嘛！<br />反反复复折腾了小两个小时，我还是失败了。（真的抓狂）<br />最后，走了一条十分绝的道路，直接搜索，凡是和 MongoDB 有关，且和 Anaconda 无关的所有，全部彻底删除，然后重启机器(我命由我)<br />经过大海捞针式的搜索之后，我终于找到了一个不错的帖子（其它都还好，只是这个把问题解决了）<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/ae77f6473250">Ubuntu 安装 MongoDB</a><br />经过系列疯狂操作之后，他活了，终于又活过来了<br />开始修复 bug：<br />①. 为了能够远程访问，&#x2F;etc&#x2F;mongodb.conf 中加一句：bind_ip&#x3D;0.0.0.0<br />②.   解决mongod: 找不到命令：vim ~&#x2F;.bashrc<br />到配置最后，加入以下内容<br />export mongodb&#x3D;&#x2F;usr&#x2F;local&#x2F;mongodb<br />export PATH&#x3D;$mongodn&#x2F;bin:$PATH<br />保存，退出编辑，重置环境变量：source ~&#x2F;.bashrc<br />③.   解决sudo: mongod: 找不到命令:  sudo visudo<br />找到secure_path,  最后添加:     :&#x2F;usr&#x2F;local&#x2F;mongodb&#x2F;bin<br />④.   关闭mongod<br />连接： mongo<br />     use admin<br />     db.shutdownServer()<br />⑤.   MongoDB 服务重启：sudo mongod –config &#x2F;etc&#x2F;mongodb.conf<br />至此，MongoDB重装完毕！！！<br />开始恢复数据库： mongorestore -d  tourism  &#x2F;remote_dir&#x2F;mongo_dump_dir&#x2F;tourism<br><a name="Vers1"></a></p><h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>数据不易，且行且珍惜！！！<br />以后再不注意磁盘容量，把磁盘撑爆！！！！！！我是猪！！！！！！！！！！1</p>]]></content>
      
      
      <categories>
          
          <category> Ubuntu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Issues </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Extracting Keywords from Short Government Documents Using Reinforcement Learning</title>
      <link href="/posts/20211112094131/"/>
      <url>/posts/20211112094131/</url>
      
        <content type="html"><![CDATA[<h3 id="摘要">摘要</h3><p>在本文中，我们提出了一种新的基于强化学习的方法来从大量未标注的政府短文档中提取关键词。引入平均速率正则化，作为模型损失函数的稀疏约束，引导策略网络保留重要词汇。对实验结果的分析表明，该模型在处理大量未标注的政府公文标题时，优于传统的无监督关键词提取方法。</p><span id="more"></span><h3 id="引文">引文</h3><p>随着中国大数据应用的发展，政府公文数字化在政府相关领域日益普遍。特别是，从用户输入的短文本中提取重要信息是计算机理解和匹配这些短文本的关键步骤。然而，大多数政府文件都没有正确地贴上标签，因此可能无法通过有监督的学习方法从政府文件中提取重要信息。因此，本文引入了适用于处理大型无标记数据集的无监督学习方法来解决这些问题。</p><p>一种最流行的无监督关键词提取方法是术语频率倒置文档频率(TFIDF)。尽管TFIDF在很多领域都很流行，但它不能捕获语义。另一种流行的无监督学习方法是延迟狄利克雷分配(LDA)。在L D A中，每个文档都可以看作是各种主题的混合体。然而，当信息量很小时，LDA也可能表现不佳，特别是对于较短的文本。基于图形的方法，如TextRank，也被认为是信息抽取领域的热门方法。TextRank本质上是一种基于递归地从整个图中提取的全局信息来确定Word重要性的方法。然而，对于简短的文本，构建的“图”有时过于简单，无法评估单词的重要性。因此，对于较短的政府文档，传统的无监督关键词提取模型如TF-IDF、LDA和基于图的TextRank等都存在局限性。</p><p>近年来，深度学习算法极大地加速了人工智能在自然语言处理(NLP)领域的发展。特别是，递归神经网络(RNN)、长短期记忆(LSTM)及其变种门式递归单元(GRU)可以有效地从原始文档中提取文本特征。例如，中可以通过序列标注来提取关键词，但这种方法属于有监督学习的范畴，不适合于大型的未标注文本数据集。另一方面，强化学习现已被应用于信息抽取任务，基于强化学习的结构化表示也被引入文本分类。但是上述模型需要大量的文本分类标签，这使得我们很难将这种结构化的表示方法应用到标签较少的政府文档上。受这些方法的启发，我们提出了一种基于强化学习的关键字抽取方法，该方法主要针对较短的政府文档。该方法不需要大的标注数据集，能够自适应地从特定主题的短文本中提取关键词。这种方法也可以作为文本匹配、文本检索和信息提取等进一步任务的基础。</p><h3 id="模型"><strong>模型</strong></h3><h4 id="模型架构">模型架构</h4><p>我们提出的基于强化学习的关键词抽取模型由三部分组成：1)策略网络：策略网络通过强化学习算法学习单词的取舍策略。2)特征表示和匹配：通过嵌入每个被接受的词来获得文本的语义特征向量。然后计算输入文本和候选文本之间的相似度，得到基于相似度的候选文本排序列表。3)奖励反馈：根据奖励函数和候选文本排序列表，获取奖励并反馈给策略网络。</p><h4 id="策略网络">策略网络</h4><p>策略网络用于学习有用的策略，以确定文本中的单词是否重要。这一过程可以看作是一项序列标记任务。我们引入了 Bi-LSTM 神经网络来构建这样的策略网络，如图1所示。在该网络中，输入层用于接受经过预处理的短文本序列。输入层的最大时间步长设置为30，每个时间步长对应的词嵌入向量的维数设置为300。考虑到我们的大多数短文本都有不同的长度，我们通过 Masking Layer 来掩蔽多余的时间步长。此外，我们还采用了 Bi-LSTM，其单元数设置为64，用于提取文本的序列特征。然后引入具有64个单元的致密层来结合这些序列特征，并且每个单元通过一个 tanh 激活函数。最后，通过 Softmax layer 得到了策略网络的可能分布。动作空间的大小为2。</p><div align = 'center'><img src = "https://pzxnys.github.io/images/1111_1.png"/></div><p>在此基础上，设计了策略网络的损失函数。损失函数 Loss 由两部分组成：第一部分根据相应的 $R_{i}$ 赋予较高奖励更大的权重。这一部分的损失函数由$Loss_{1}$表示。损失函数的第二部分由$Loss_{2}$表示，通过将单词被选择的可能性的平均值限制为 $\gamma$ 来指导策略网络选择单词。损失函数的两个部分的定义如公式(1)所示。</p><div align = 'center'><img src = "https://pzxnys.github.io/images/1111_2.png"/></div><p>其中，超参数 $\lambda$ 是权重系数，N代表样本总数，$T_{i}$ 是文本 $i^{th}$ 的长度，$R_{i}$ 是文本 $i^{th}$ 获得的回馈奖励，$\pi_{\Theta}(a_t| s_t)$ 表示在 t 时刻的状态 $s_t$ 下，选择 $a_t$ 的条件概率，特别的 $\pi_{\Theta}(a_t = 1| s_t)$ 表示在 t 时刻，状态为 $s_t$ 的状态下，当前词被选为关键词的概率，ReLu(x) 是线性整流函数，当 $x &gt; 0$ 是输出想， 否则输出0，参数$\gamma$ 表示一个词预期被选中的可能性。</p><h4 id="特征表示与匹配">特征表示与匹配</h4><p>经过策略网络选择后，需要将关键词转换为特征向量。我们引入了有较大的预训练的嵌入模型 Word2Vec 来获得每个提取关键词的语义特征向量。然后，通过对所有对应关键字的特征向量求平均来获得文本表示。利用短文本对应的特征向量之间的余弦距离来计算短文本之间的相似度。然后，我们可以通过选择相似度最高的候选文本来获得当前短文本最相似的候选文本。</p><h4 id="回馈奖励">回馈奖励</h4><p>策略网络需要奖励信号才能知道其学习的关键词提取策略是否足够好。我们注意到，如果策略网络提取的关键词包含短文本的要点，则可以从候选文本中找到相似度较高的短文本。因此，奖励信号是根据短文本与相应候选人之间的相似度列表来设计的。假设在策略网络的每一批训练中，需要匹配的候选集被标注为 C，那么候选集的数量就是 C 的大小，可以表示为 |C|(|C|&gt;10)。为了获得短文本与候选文本之间的排序相似度的对应列表，需要根据计算出的相似度将每个样本与候选集中的每个文本进行匹配。假设 x 为 $t_i$ 的推荐等级，即样本 $d_i$ 的对应标签，则奖励金额计算如下：</p><div align = 'center'><img src = "https://pzxnys.github.io/images/1111_3.png"/></div><p>然后，这种奖励 $R_i$ 被反馈到损失函数中，如公式 (1)，用来训练策略网络。</p><h3 id="实验和结果">实验和结果</h3><h4 id="实验数据">实验数据</h4><p>为了训练这个模型，我们爬行了大量的政府文档，并提取了每个文档的标题。爬行的文本涵盖了农业、文化、旅游、扶贫和其他政府事务的主题。爬行的标题分为训练集、验证集和测试集，分别有12925个样本、1,024个样本和2,048个样本。为了自动生成标题相关对，我们首先计算训练集中所有标题对之间的Rouge分数，其中Rouge分数被设置为Rouge-1和Rouge-2分数的平均值。对于每个标题，它都会将 Rouge 得分最高的标题配对。但是，我们不会在验证和测试集中生成标题对。为了选择超参数并量化所提出的模型的性能，我们在验证和测试集中手动选择并标注了所有标题关键词。我们首先对标题进行预处理，排除所有数字和英文部分，但仍保留停用词。然后，我们利用开源的 jieba 库对所有预处理后的标题进行标记化。通过预先训练好的词嵌入模型，将每个时间步对应的词嵌入到300维的特征向量中，作为策略网络的输入。我们计算并绘制了验证集标签标题中关键词的比例直方图，如图2所示，标题中关键词的平均比例为0.5。因此，为了使策略网络排除无关或不重要的信息，我们将等式(1)中的超参数 $\gamma$ 设置为0.5。</p><div align = 'center'><img src = "https://pzxnys.github.io/images/6d7b080cdeaeb401.png"/></div><h4 id="结果分析">结果分析</h4><p>我们在测试集上对该模型和其他传统的非监督方法如TF-IDF、LDA和TextRank的性能进行了评估。从图2中我们注意到，验证集中每个标题中关键字的平均比率为0.5，因此上述传统方法提取的关键字数量被设置为标记化标题中所有单词的一半大小。此外，通用硬件环境包括：1) CPU: Intel® Core™ i5-7500 @3.4GHz. 2) RAM: 8GB.<br>从表I可以看出，采用平均速率正则化的模型在所有评价指标上都优于TF-IDF、LDA和TextRank等传统方法。该模型的平均准确率达到0.740，平均召回率达到0.769，平均F1得分达到0.731。总的来说，该模型对于从大型无标签政府文档的标题中提取关键词是可行的，该方法为政府文档数字化领域提供了一种新的思路。</p><div align = 'center'><img src = "https://pzxnys.github.io/images/d1718610c814ddb9.png"/></div><h3 id="结论">结论</h3><p>本文提出了一种利用强化学习从大量未标注的政府短文档中提取关键词的模型。为了引导策略网络保留重要词汇，引入平均速率正则化作为模型损失函数的稀疏约束。该模型的平均准确率达到0.740，平均召回率达到0.769，平均F1得分达到0.731。通过对实验结果的分析，我们得出结论：该模型在政府文档标题关键词提取方面的性能优于传统的无监督方法。提取的关键词还可以进一步应用于文本匹配、文本检索和信息提取等任务。</p>]]></content>
      
      
      <categories>
          
          <category> Paper-Reading </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Extracting Keywords </tag>
            
            <tag> Paper </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MovieLens 1M Introduction</title>
      <link href="/posts/20211109093909/"/>
      <url>/posts/20211109093909/</url>
      
        <content type="html"><![CDATA[<p>Total：1000209<br />Movies: 3883<br />Users: 6040<br />稀疏比约为：95.7%<br /></p><span id="more"></span><p><a name="KAv6J"></a></p><h1 id="ratings-dat"><a href="#ratings-dat" class="headerlink" title="ratings.dat"></a>ratings.dat</h1><p>UserID::MovieID::Rating::Timestamp<br /><br><br />UserID: 在 1 到 6040 之间<br />MovieID: 在 1 到 3952 之间(存在缺省值)<br />Rating: 在 1 到 5 之间(采用整数制)<br />Timestamp: 从 1970 开始的秒数<br /><br><br />PS:  每个用户至少有20个评分<br /></p><p><a name="6qZGV"></a></p><h1 id="users-dat"><a href="#users-dat" class="headerlink" title="users.dat"></a>users.dat</h1><p>UserId::Gender::Age::Occupation::Zip-code<br /><br><br />Age: <br />1: 18-<br />18: 18 - 24<br />25: 25 - 34<br />35: 35 - 44<br />45: 45 - 49<br />50: 50 - 55<br />56: 56+<br />Occupation:<br />0: 其它或未说明<br />1: 学术&#x2F;教育工作者<br />2: 艺术家<br />3: 办事员&#x2F;行政<br />4: 大学&#x2F;研究生<br />5: 客户服务<br />6: 医生&#x2F;保健<br />7: 行政&#x2F;管理<br />8: 农民<br />9: 家庭主妇<br />10: k - 12 学生<br />11: 律师<br />12: 程序员<br />13: 退休人员<br />14: 销售&#x2F;营销<br />15: 科学家<br />16: 自由职业者<br />17: 技术员&#x2F; 工程师<br />18: 商人&#x2F;手艺人<br />19: 失业人员<br />20: 作家<br /></p><p><a name="Hrcni"></a></p><h1 id="movies-dat"><a href="#movies-dat" class="headerlink" title="movies.dat"></a>movies.dat</h1><p>MovieId::Title::Genres<br /><br><br />Genres:<br />Action: 动作 <br />Adventure: 冒险<br />Animation: 动画<br />Children’s: 儿童<br />Comedy: 喜剧<br />Crime: 犯罪<br />Documentary:  纪录片<br />Drama: 戏剧<br />Fantasy: 魔幻<br />Film-Noir: 黑色电影<br />Horror: 恐怖<br />Musical: 音乐剧<br />Mystery: 推理<br />Romance: 浪漫爱情<br />Sci-Fi: 科幻<br />Thriler: 惊悚<br />War: 战争<br />Western: 美国西部片<br /><br><br />PS：一些MovieID可能不对应，由于电影是手工录入，故存在误差</p>]]></content>
      
      
      <categories>
          
          <category> ML &amp;&amp; DL </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Dataset </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python 基础</title>
      <link href="/posts/20211108205633/"/>
      <url>/posts/20211108205633/</url>
      
        <content type="html"><![CDATA[ <p>写在最初，终端中，输入  import   this   了解Python之禅的魅力</p><span id="more"></span><pre class="line-numbers language-none"><code class="language-none">The Zen of Python, by Tim PetersBeautiful is better than ugly.Explicit is better than implicit.Simple is better than complex.Complex is better than complicated.Flat is better than nested.Sparse is better than dense.Readability counts.Special cases aren&#39;t special enough to break the rules.Although practicality beats purity.Errors should never pass silently.Unless explicitly silenced.In the face of ambiguity, refuse the temptation to guess.There should be one-- and preferably only one --obvious way to do it.Although that way may not be obvious at first unless you&#39;re Dutch.Now is better than never.Although never is often better than *right* now.If the implementation is hard to explain, it&#39;s a bad idea.If the implementation is easy to explain, it may be a good idea.Namespaces are one honking great idea -- let&#39;s do more of those!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p> <a target="_blank" rel="noopener" href="https://www.python.org/dev/peps/pep-0008/">PEP8编码规范</a><br> <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/news/332042">中文版</a></p><p>1、终端写python程序，直接键入python(python3版本，一般需要键入python3)，退出时，可以使用代码段：exit(),  也可以使用快捷键Crtl + D<br> （打开终端的快捷键：Ctrl + Alt + T   目前仅测试Ubuntu）</p><p>2、定义变量不需要考虑类型，其会自动匹配对应类型</p><p>3、变量命名规则：<br>      ①. 变量名只能包含字母、数字和下划线。变量名可以字母或者下划线打头，但不能以数字打头<br>      ②. 变量明不能包含空格，但可使用下划线来分割其中的单词<br>      ③. 不要将Python关键字和函数名用作变量名，即不要使用Python保留用于特殊用途的单词。<br>      ④变量名应既简短又具有描述性<br>      ⑤慎用小写字母l和大写字母O，因为它们可能被人错看成数字1和0<br>ps：就目前而言，应使用消息网的Python变量名</p><p>4、字符串<br>      Python中，无论用单引号还是双引号括起来的，都是字符串，虽然更加人性化但也应该注意 避免混淆<br>      ①. Function: title()  作用是将所有单词的首字母都大写<br>      ②. Function: upper()  作用是将所有字母都改成大写<br>      ③. Function: lower()  作用是将所有字母都改成小写<br>      ④. 合并（拼接）字符串： 用 “+”<br>      ⑤. 换行符用\n， 添加制表符用\t<br>      ⑥. 删除空白行<br>            空白很重要，特别是在做字符串比对的时候，尤为明显。但是在一些简单的情形下，额外的空白也可能令人迷惑<br>             ⅰ、Function：rstrip()  作用是删除字符串末尾的空白<br>            ⅱ、 Function：lstrip()   作用是删除字符串开头的空白<br>            ⅲ、 Function： strip()   作用是删除字符串两端的空白<br>ps：特别注意，引号不能混用<br>pps：编写程序时，编辑器的语法突出功能可帮助你快速找出某些语法错误。看到Python代码以普通句子的颜色显示，或者普通句子以Python代码的颜色显示时，就可能意味着文件中存在引号不匹配的情况。</p><p>5、Python2 与 Python3 的区别<br>      ①. Python2 中的 print 语句，可以用括号，可以不用。而 Python3 中，由于 print 变为了 Function，因此必须用括号。<br>      ②. Python2 中整数除法的结果只包含整数部分，使用去尾法。而 Python3 中，会自动输出浮点数</p><p>6、数字类型<br>ps：python 部分代码在编译器和终端，输入输出有些许差异<br>      ①. 整数   基本不需要太注意什么，<br>ps：Python使用两个乘号（**） 表示乘方。其还可以使用括号来改变运算次序<br>      ②. 浮点数  基本无需考虑 其行为<br>ps：结果包含的小数位可能不是很确定，Python 会尽力找到一种方式，以尽可能精确地表示结果，暂时忽略多余的小数位即可，后续慢慢研究<br>       ③. Function：str()  作用将非字符串值表示为字符串  避免类型错误<br>ps：大多数情况下，Python中使用数字非常简单。若结果出乎意料，就检查一下，是否出现Python无法理解的类型错误！</p><p>7、列表<br>      ①. 列表和C语言中的数组基本相同，索引 (下标) 同样从一开始。特别的，Python的列表可以从后往前用下标，最后一个元素的下标为 -1，以此类推<br>      ②. 修改列表元素，直接给列表中对应元素进行赋值即可<br>      ③. 添加列表元素：<br>            Function：append()  作用直接向列表末尾添加元素<br>            Function：insert(下标，‘元素’)  作用向列表对应下标插入对应元素<br>      ④. 删除列表元素：<br>           ⅰ、使用 del 语句删除元素，必须知道该元素所对应的下标，该语句直接将该元素彻底删除，无法继续访问<br>          ⅱ、Function： pop()  作用将元素从列表中删除，并将其存储到某一变量。pop(下标)，删除对应下标的元素，并将其存储到某一变量<br>          ⅲ、Function：remove()  作用  只知道要删除元素的值，使用该方法。亦可将其存储到某一变量，为我所用<br>ps：remove()只删除第一个指定的值。如果删除的值可能多次存在，须使用循环判断</p><p>8、组织列表<br>      ①. Function：sort() 作用对列表进行永久性排序，不能再改回原排序方式。其中sort(reverse &#x3D; True)，列表元素反向排列。<br>      ②. Function：sorted()  作用对列表进行临时排序，反向排列用法同上<br>      ③. Function：reverse()  作用将列表元素反向排列，也为永久性排序，但是可随时恢复到原排列。再调用一次 reverse() 即可<br>      ④. Function：len()  作用快速获悉列表的长度<br>ps：列表元素下标从0开始，不要犯越界错误，下标-1元素一直输出最后一个，仅当列表为空时，这种访问方式才会错误</p><p>9、循环遍历<br>      ①.  语法 for   A    in   B:     把B中的每一个数值单独提出来，赋值给A<br>      ②.  在 for 循环中，想包含多山行代码都可以，每个缩进的代码行 都是循环的一部分<br>      ③.  代码没有缩进便自动跳出循环，和之前的{}循环体不太一样， 请注意<br>      ④.  由于 python 以缩进来区分代码块，因此，一定要保持一个良好的缩进风格<br>      ⑤.  千万不能忘记 for 循环语句后面的 “ : “</p><p>10、创建数字列表<br>      ①.  Function：range(a, b)  作用打印从 a 开始到 b 结束，之间的数字<br>      ②.  Function：list(range(a, b))  作用 将range() 打印出来的一系列数字转换为一个列表<br>      ③.  Function：range(a, b, c) 作用 打印从 a 到 b 的数字， 每次打印在前一次的基础上 + c   ，即 指定步长</p><p>PS：在编写代码时，首先应该编写清晰易懂且能完成所需功能的代码；等待审核代码时，再考虑采用更高效的方法</p><p>PS：处理数字列表时有几个特殊函数，能帮助找出数字列表的最大值、最小值和总和：max()    min()    sum()</p><p>11、处理部分元素 – python 称之为切片<br>      ①.  Function：List(a : b)   作用 处理列表 List 从 a 开始终于 b 的列表元素<br>      ②.  若没有指明 a，则从头开始执行。若没有指明 b， 则执行到末尾<br>      ③.  若 a 为负数，则执行最后几个 </p><p>PS：列表可以直接赋值，但是一定要用切片，a 和 b 都为空。否则的话，连个列表会指向同一片内存，而不是赋值类似对比指针</p><p>12、元组<br>      ①.  Python将不能修改的值称为不可变的，而不可变的列表被称为元组。定义元组用 “( )”<br>      ②.  遍历元组中的所有值和遍历列表一样<br>      ③.  虽然不能修改元组的元素，但是可以直接对其进行重新赋值</p><p>13、if 相关<br>      ①.  Function：lower()  作用在判断两变量是否相等时，忽略大小写的影响。且不改变原变量的值<br>      ②.  编写的大多数条件表达式都检查两个值是否相等，但有时检查两个值是否不等的效率更高<br>      ③.  在 python 中，同时判断多个条件，直接使用 and 或者 or 即可<br>      ④.  Function：A in (not) B  作用是判断A是否(不)在B中</p><p>PS：else if 在 python 中简写为 elif</p><p>14、字典基础<br>      ①.  字典与c语言中的结构体相似，可对应理解相关概念<br>      ②.  获取字典中的值：aaa[‘…’]  ，其中 aaa 对应的是字典名称， … 对应的是想要访问的字典对应的键值<br>      ③.  由于字典是一种动态结构，故对其添加新的键-值对，只需依次指定字典名和键及相关联的值：aaa[‘…’] &#x3D; bbb<br>      ④.  打印整个字典，只需要 print(aaa)<br>      ⑤.  修改字典中的键值，只需要给对应的键值重新赋值即可<br>      ⑥.  Function： del aaa[‘…’]  作用是删除某键值对</p><p>PS：… 可以为变量，不过此时不需要加  ‘   ’</p><p>15、遍历字典<br>PS：遍历字典时，键-值对的返回顺序也与存储顺序不同。Python不关心键-值对的存储顺序，而只跟踪键和值之间的关联关系。<br>      ①.  遍历字典的所有键-值对： （for …, … in aaa.items() ）<br>      ②.  遍历字典的所有键： ( for … in aaa.keys() )<br>      ③.  方法 keys() 并非只能用于遍历，实际上，还可以判断某键是否存在于字典中<br>      ④.  Function：sorted()    作用获得按特定顺序排列的键列表副本<br>      ⑤.  遍历字典的所有值：  ( for … in aaa.values())<br>      ⑥.  可使用集合（set）对遍历字典的所有值进行去重</p><p>16、嵌套<br>      ①.  在列表中嵌套字典：a_1 &#x3D; {…}   a_2 &#x3D; {…} …     a &#x3D; [a_1,  a_2, ……]<br>      ②.  Function：range(n)  作用自动创建 n 个对象<br>      ③.  在字典中嵌套列表：a &#x3D; {… ,   ‘b’: [‘…’, ‘…’, ‘…’]}<br>      ④.  字典中嵌套字典： a &#x3D; {‘b’: {…}, ‘c’: {…}} </p><p>PS：列表和字典的嵌套层级不应太多。如果嵌套层级比前面的示例多得多，很可能有更简单的解决问题的方案<br>PS：字典之间的嵌套，最好保持嵌套内字典结构相同，这样能使得字典处理起来更容易</p><p>PS：每当使用 input () 输入函数时，都应当指定清晰且易于明白的提示<br>PS：有时候，提示信息可能超过一行，可将提示存储在一个变量中，再将其传递给函数 input()<br>PS：python 默认输入格式为字符串，若要使用数字，需用强制转换，as：int()</p><p>PS：python中数字类型是不可变数据。也就是数字类型数据在内存中是不会发生改变的，当变量值发生改变时，会新申请一块内存赋值为新值，然后将变量指向新的内存地址<br>PS：由于部分整数使用频繁，为了提升性能避免浪费，python提供了一个整数池，默认 [-5, 256]的数字都属于这个整数池，每次赋值都是取得池中的对象。</p><p>17、循环<br>      ①.  break 可以用于 python 的各种循环之中，作用就是结束循环<br>      ②.  continue 结束本次循环，直接跳到下一次循环</p><p>PS：确认每个循环都有有一个属于自己的ending，若程序陷入无限循环，可按 Ctrl + C，或直接关闭终端窗口来终结该bug。</p><p>18、无返回值函数<br>      ①.  python 中定义函数，用关键字 def<br>      ②.  定义需传参的函数 def aaa (bbb) :<br>      ③.  形参  实参 注意区分。若实在很难记，统称参数<br>      ④.  向形参传递实参的方法有两种，位置传参，关键字传参。对标C<br>      ⑤.  编写函数时，可以预先指定形参的默认值，若调用函数，没有给定实参，则使用形参的默认值<br>PS：使用哪种调用函数并不重要，使用自己顺手的调用方式才重要!<br>PS：使用关键字传参时，务必准确地指定函数定义中的形参名</p><p>PS：python 中亦可用 “”” … “”” 对代码进行注释</p><p>19、有返回值函数<br>      ①.  同样用 def 来定义函数，这有别于 C 等，对逻辑要求严格的语法。<br>      ②.  有些形参不是必须的，可以在定义时，为该形参赋值为空字符串，只有在需要的时候，才会启用该形参，并为其赋值<br>PS：在定义函数时，对于给定默认值的形参，一定要放在未给定默认值的形参的后面<br>      ③.  函数返回值不只是变量，还可以是字典等<br>      ④.  实参不只是变量，定量，还可以是列表等<br>      ⑤.  在函数中对列表所做的任何修改都是永久性的<br>      ⑥.  若不想让函数修改列表，可使用切片法[ ：]，创建列表副本，供函数使用，且并不改变函数原列表</p><p>20、传递任意数量的实参<br>      ①.  使用形参名 *aaa (类比 c 语言中的指针)，创建一个空元组。Python 将实参封装到这个元组中<br>      ②.  使用形参名 **aaa，创建一个空字典。 Python 将从实参接收到的键-值对封装在这个元组中</p><p>21、函数模块化<br>      ①.  导入模块：import  qqqqqq<br>      ②.  导入特定的函数：from aaa import f_1, f_2, …   只导入某模块中自己想用的函数<br>      ③.  给导入的函数起别名：from aaa import f_1 as f<br>      ④.  给导入的模块七别名：import dddd as d<br>      ⑤.  (慎用) 导入模块中的所有函数： from ffff import *，不需要在使用 . 调用，可直接使用模块中的所有函数<br>PS：最好不要采用导入模块中的所有函数，因为 Python 在遇到多个同名的函数或变量时，并不是分别调用，而是暴力覆盖</p><p>PS：（特别注意）给形参指定默认值时，等号两边不要有空格。</p><p>22、类<br>      ①.  Python 要求， 类名首字母需要大写，使用驼峰规则命名<br>      ②.  类中的函数叫做方法，<code>__init__</code> 是一个特殊的方法(init前后各两个下划线)，Python 类中，会自动运行它<br>      ③.  方法<code>__init__</code> 中，第一形参必须是 self<br>      ④.  在方法中定义的每一个属性，都应该赋初值，且形参自动为空。<br>      ⑤.  在类中定义的其它方法，调用 <code>__init__</code>方法总的属性，必须用  self.***<br>      ⑥.  在类外调用属性或者方法，只需要用 aaa(表示实例化对象).bbb(表示方法或者属性)即可<br>PS：在 Python2.7 中创建类时，应在括号内加object，as：class  ClassName (object):</p><p>23、继承<br>      ①.  class Ass(Bvv) 子类 Ass 继承父类Bvv，继承之后需初始化，对应代码：<br>             <code>def __init__ (self, ..., ..., ...):</code><br>                       <code>super().__init__ (..., ..., ...)</code><br>      ②.  在 Python2.7 版本中，代码有所区别：<br>              <code>def __init__ (self, ..., ..., ...):</code><br>                         <code>super(Ass, self).__init__ (..., ..., ...)</code><br>      ③.  重写父类方法，将该父类方法在子类中重新定义，并给出子类对该方法的使用即可<br>PS：重写父类，可以使继承做到：取其精华去其糟粕<br>      ④.  当一个大类过于繁杂时，我们可以把它拆分成若干个协同工作的小类，此小类不需做继承，在大类中，若用到该小类只需：self.××× &#x3D; xxx() 声明一下即可，实例化对象调用该小类的某个方法时，只需要：obj.xxx.fun () 即可。(obj: 实例化对象)<br>PS：这样做，使得模块化越来越细化，后期维护较方便<br>PS：注意导入整个模块和导入模块函数的区别</p><p>PS：若某条语句未按照自己的想法执行，且没有报错，请检查自己调用函数的语句是否忘加括号<br>PS：在类中，可使用一个空行来分隔方法，而在模块中，可用两个空行来分隔类</p><p>24、读取文件<br>      ①.  Function：open(‘xxx’) 作用是打开文件，并返回一个表示文件的对象<br>      ②.  关键字 with 在不再需要访问文件后将其关闭。改关键字特别重要，可以让你省去很多烦恼<br>PS：使用 with 时，open() 返回的文件对象只在 with 代码块内可用<br>      ③.  读取整个文件：<code>xxx = file_object.read()</code><br>      ④.  逐行读取文件：<code>for line in file_object:</code><br>      ⑤.  Function：readlines() 从文件中读取每一行，并存储到列表中<br>PS：读取文本文件时，Python 默认将其中的所有文本都解读为字符串。如果你读取的是数字，且想要将其作为数值使用，就必须使用函数 int() &#x2F; float() 将其转化为整数或浮点数去使用</p><p>25、写入文件<br>保存文件最简单的方式之一就是将其写入到文件中<br>      ①. 深入理解Function：open(xxx, ‘…’),上面已经提到，xxx为文件名变量，…为指定打开方式，<br>            其中：指定读取模式 ‘r’<br>                       指定写入模式 ‘w’<br>                       指定附加模式 ‘a’<br>                       指定读取和写入模式 ‘r+’<br>PS：如果省略了模式实参，Python将以默认的只读模式打开文件<br>PS：若作为写模式打开，而该文件夹下并没有该文件，则自动创建它。然而，若已存在，Attention please！Python 将在返回文件对象前清空该文件<br>PS：Python 只能将字符串写入文本文件。要将数值数据存储到文本文件中，必须先使用 Function：str() 将其转换为字符串格式<br>      ②.  若写入的为多行时，一定要加入换行符，因为 Function：write() 不会在你写入的文本末尾添加换行符<br>PS：除换行符外，还可以使用空格，制表符，空行等，来设置这些输出格式<br>      ③.  附加模式 ‘a’, 不会清空之前的内容，而是在原文件的末尾继续添加</p><p>26、异常<br>有效的采用异常机制，可以避免系统崩溃</p><pre class="line-numbers language-none"><code class="language-none">处理异常代码块：try:    ......except xxx:    ......else:    ......对某块代码执行异常处理，其中“xxx”为处理那种异常，若出现该异常，则执行 except xxx: 后的代码块，若未出现该异常，则执行 else<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>PS：通过预测可能发生错误的代码，可编写健壮的程序，它们即便面临无效数据或缺少资源，也能继续运行，从而能够抵御无意的用户错误和恶意攻击<br>      ①.  ZeroDivisionError，处理被除数为 0 的异常<br>      ②.  FileNotFoundError，处理文件不存在异常<br>      ③.  Function：split()  作用是以空格为分隔符将字符串分拆成多个部分。(文本处理常用 Function)<br>      ④.  若你不想让异常显示给用户，可以用 pass 语句，让 Python 遇到异常后，什么都不做</p><p>27、存储数据<br>需要导入  json包，即： <code>import json</code><br>PS：JSON 格式最初是为 JavaScript 开发的，但随后成了一种常见格式，被包括 Python 在内的众多语言采用。<br>      ①.  Function：json.dump(aaa, bbb)  作用是将 aaa 的数据存储到 bbb 中<br>      ②.  Function：json.load(xxx)  作用是将 xxx 这个文件读取到内存</p><p>28、重构<br>对正确的代码进一步的改进，将代码划分为一系列完成具体工作的函数</p>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python Code </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信小程序开发问题解决</title>
      <link href="/posts/20211108205633/"/>
      <url>/posts/20211108205633/</url>
      
        <content type="html"><![CDATA[ <p>写在最初 </br><br>半年有余的小程序前端开发，踩坑无数，在此记录！！！<br></br><span id="more"></span><br>1、读取数据库内容，含有HTML标签。解析这些标签使用：<br /><br><code>&lt;rich-text nodes=&quot;&#123;&#123;Notice.content&#125;&#125;&quot;&gt;&lt;/rich-text&gt;</code><br /><br>2、将常使用数据存放到storage，读取时，应在page中的onload使用：<br />onLoad(){<br />    this.setData({<br />       userInfo: wx.getStorageSync(‘userInfo’)<br />    })<br /> },<br />否则无法实时读取storage信息。<br /><br><br />3、照片上传问题</p><p>url: ‘<a target="_blank" rel="noopener" href="http://127.0.0.1:8088/management/image/upload">http://127.0.0.1:8088/management/image/upload</a>‘,  &#x2F;&#x2F;图片上传接口，本地调试用<br />header: {‘cookie’: wx.getStorageSync(‘sessionid’)},<br />formData:{                  <br />     eventId: 124,   &#x2F;&#x2F;事件id，暂时写死，int形式<br />     eventStatus: 1       &#x2F;&#x2F;事件状态值，暂时写死，int形式             <br />},<br />method: ‘POST’,     <br />dataType: ‘json’,<br />filePath: tempFilePaths[i],<br />name: ‘file’,<br />其中，formData中的参数，是随图片一起传回后台的数据<br /><br><br />4、小程序添加背景图片<br />使用 background-image 这个属性，后面需用url，且既不能用绝对路径，又不能用相对路径，需将整张图片转成base64编码的数据<br />转换网址：<a target="_blank" rel="noopener" href="https://www.zhangxinxu.com/sp/base64.html">https://www.zhangxinxu.com/sp/base64.html</a><br />使用方法：background-image: url(“……”)</p><p>5、安卓登录，shiro权限认证失败(解决方案)<br />1、问题描述<br />最近有用户反馈，小程序登陆有问题<br />小程序成功登陆后，部分安卓用户经常会出现登陆异常情况。而 iPhone 用户从未出现此种状况<br />2、问题分析<br />a. 前期猜测，安卓用户授权问题，在进入登录页面的同时，调取获取位置接口，解决部分手机用户，但是治标不治本<br />b. 怀疑是缓存问题，毕竟iPhone没问题，安卓也有登录成功的情况出现，故改用globalData，结果，然并卵，发病率更改<br />c. 基本确认是 shiro 权限认证问题，但是大部分情况，都没有出现任何问题，那么问题出在哪里呢。感谢 <a target="_blank" rel="noopener" href="https://blog.csdn.net/czx0132/article/details/110101854?utm_source=app&app_version=4.5.3">csdn 四袋粉博主</a>文章<br />该死的安卓系统，不按标准化程序来，获取后台输出也能随机来。<br />（苹果手机获取Set-Cookie顺序是严格一致的，安卓手机Set-Cookie顺序是随机的。）<br /><img src="https://pzxnys.github.io/images/IGImjJ.png" alt="image.png"><br />当返回结果的header有多个Set-Cookier时，微信小程序获取res.header[‘Set-Cookie’]，已经是将Set-Cookie用逗号拼接好的字符串。<br />如果使用简单的逗号分割，Expires时间也含有逗号，Cookie结果是错误的。<br />3、问题解决<br />Cookie正则分割，分号重新拼接<br />简单的逗号无法分割，可以使用正则表达式去分割Cookie字符串，<br />需要被分割的逗号，后继字符串是含有&#x3D;<br /><img src="https://pzxnys.github.io/images/IGIlAx.png" alt="image.png"><br />重新编译后，JSSIONID被整体分割处理，问题解决。perfect<br />上代码：<br />     &#x2F;&#x2F; Set-Cookie字符串获取<br />            var cookie &#x3D; res.header[‘Set-Cookie’]<br />            <br />            &#x2F;&#x2F; 字符串分割成数组<br />            var cookieArray &#x3D; cookie.split(&#x2F;,(?&#x3D;[^,]*&#x3D;)&#x2F;)<br />            &#x2F;&#x2F; 分号拼接数组<br />            var newCookie &#x3D; cookieArray.join(‘;’)<br />            &#x2F;&#x2F; 存储拼接后的cookie<br />            wx.setStorageSync(‘sessionid’, newCookie)<br /></p>]]></content>
      
      
      <categories>
          
          <category> WeChat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 小程序开发 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ubuntu使用技巧</title>
      <link href="/posts/20211108203134/"/>
      <url>/posts/20211108203134/</url>
      
        <content type="html"><![CDATA[ <p>一、在桌面创建图标：<br>有两种情况：<br>一是标准安装的应用程序，这种程序一般安装之后就已经有.desktop文件了，我们只要把它复制到桌面就可以了。<br>还有一种就是第三方或自己写的非标应用程序，这个需要自己编写.desktop文件。</p><span id="more"></span><p>1、 首先在Ubuntu中已经安装该应用程序，比如在Ubuntu18中已经安装了firefox浏览器（Ubuntu16中也是一样的），想在桌面上建立一个快捷图      标（快捷方式）。<br>2、打开终端（ctrl+alt+t）进入&#x2F;usr&#x2F;share&#x2F;applications目录找到Firefox对应的.desktop文件，如下。hzq@ubuntu:~$ cd &#x2F;usr&#x2F;share&#x2F;applications</p><pre class="line-numbers language-none"><code class="language-none">hzq@ubuntu:&#x2F;usr&#x2F;share&#x2F;applications$ ls firefox*firefox.desktophzq@ubuntu:~$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>仔细确认该文件是不是你的应用程序对应的文件，有的时候会有多个类似文件（上图中只有一个比较好确认）。<br>3、将.desktop文件拷贝到桌面，如下。</p><pre class="line-numbers language-none"><code class="language-none">hzq@ubuntu:&#x2F;usr&#x2F;share&#x2F;applications$ cp firefox.desktop ~&#x2F;桌面&#x2F;hzq@ubuntu:&#x2F;usr&#x2F;share&#x2F;applications$ cdhzq@ubuntu:~$ ls 桌面&#x2F;firefox.desktophzq@ubuntu:~$ <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>回到桌面查看，效果如下。还需要进一步处理一下。<br>4、选中文件，右键属性打开，切换到“权限”标签，如下所示。选中“允许作为程序执行文件”。然后退出。<br>5、然后再次点击打开该图标，如果弹出提示如下，选“trust and launch”。</p><p>非标准应用程序的操作方法<br>1、其实只要是大规模发行的软件一般在Ubuntu里安装完之后都会在&#x2F;usr&#x2F;share&#x2F;applications里建立相应.desktop文件的，但是总有一些特殊情况。这里以新安装的gedit为例（gedit其实也有现成的.desktop文件，我只是以他为例子建立一个个性化的图标）。<br>2、进入&#x2F;usr&#x2F;share&#x2F;applications目录，建立一个空白的文本文件。如下。</p><pre class="line-numbers language-none"><code>hzq@ubuntu:~$ cd /usr/share/applicationshzq@ubuntu:/usr/share/applications$ sudo gedit myGedit.desktop#输入文件内容，注释内容可以删除---------------------[Desktop Entry]#名字Name=myGedit#注释Comment=Edit text files#执行文件、命令格式Exec=gedit %U#是否需要终端打开Terminal=false#类型Type=Application#图标，我这里是自己做的图标，你也可以引用别的程序的Icon=/home/hzq/word.png#分类，按自己需要填写Categories=GNOME;GTK;Utility;TextEditor;#保存退出-----------------------------hzq@ubuntu:/usr/share/applications$ </code></pre><p>3、将.desktop文件拷贝到桌面，如下。</p><pre class="line-numbers language-none"><code>hzq@ubuntu:/usr/share/applications$ cp myGedit.desktop ~/桌面/hzq@ubuntu:/usr/share/applications$ cdhzq@ubuntu:~$ ls 桌面/firefox.desktop   myGedit.desktophzq@ubuntu:~$ </code></pre><p>回到桌面查看，效果如下。下面的处理步骤就跟方法一中的步骤类似了。</p><p>在win10下安装了Ubuntu双系统，默认情况下，默认启动的是Ubuntu系统。将默认启动系统设置成win10的办法是：<br>① 进入ubuntu系统；<br>② 打开终端，进入到 &#x2F;etc&#x2F;default 目录下；<br>③ 使用 sudo gedit grub 打开grub配置文件，将GRUB_DEFAULT&#x3D;0修改为你想要默认启动的系统的序号，设置完后保存；<br>注：系统的序号即为启动时看到的顺序，从0开始数，默认ubuntu为第一个，即其序号为0，我的win10系统在第3个，所以设置GRUB_DEFAULT&#x3D;2<br>④ 输入 sudo update-grub 更新grub文件；<br>⑤ 重启系统，完工。</p><p>解决 ubuntu 与 win10 双系统，系统时间不同步问题<br>①  进入ubuntu，在 ubuntu 下更新本地时间<br>      sudo apt-get install ntpdate<br>      sudo ntpdate time.windows.com<br>② 将本地时间更新到硬件上<br>      sudo hwclock –localtime –systohc</p>]]></content>
      
      
      <categories>
          
          <category> Ubuntu </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Ubuntu-Desktop-ICON </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>微信常用知识</title>
      <link href="/posts/20211108090741/"/>
      <url>/posts/20211108090741/</url>
      
        <content type="html"><![CDATA[<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/">小程序开发文档</a></br><br><a target="_blank" rel="noopener" href="https://www.iconfont.cn/">阿里图标iconfont</a></br></p><span id="more"></span><p>一、微信小程序的优势：<br />     1、微信有海量用户，且粘性很高，在微信里开发产品更容易触达用户；<br />     2、推广app或公众号的成本太高；<br />     3、开发适配成本低；<br />     4、容易小规模试错，然后快速迭代；<br />     5、跨平台<br /> <br />事实上，应用号并非微信首创，之前百度推出过应用号，搜狐退出过快站，但是腾讯将这件事情做成功的概率确是最大的<br /><br><br />二、微信小程序对于创业者的优势：<br />     1、APP流量成本的急剧攀升；<br />     2、移动互联网格局基本已定，用户需求场景已被巨头把持；<br />     3、面向所有产品对用户时间的竞争；<br /> <br />三、开发环境准备<br />     1、注册账号：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/cgi-bin/registermidpage?action=index&lang=zh_CN&token=">官网注册</a><br />     2、获取APPID，由于调用微信小程序的接口等功能，需要索取开发者的小程序中的APPID，所以注册成功后，可登录，然后获取APPID。<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">登录</a>，在设置页面将APPID保存>下来，方便后期使用<br />     3、开发工具<br />      vs  cod下载地址：<a target="_blank" rel="noopener" href="https://code.visualstudio.com/Download">官网下载</a><br />          微信小程序开发工具（微信官方工具，用于查看小程序UI）  下载地址>：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html">官网>下载</a><br /> <br />四、其他小程序（和微信小程序开发很相似）<br />     1、支付宝小程序<br />     2、百度小程序<br />     3、QQ小程序<br />     4、今日头条 + 抖音小程序<br /> <br />五、大项目–黑马优购电商项目（十二大模块）<br />      1、商>品首页<br />     2、商品列表<br />     3、购物车<br />     4、授权页面<br />     5、商品搜索<br />     6、商品收藏<br />     7、商品分类<br />     8、商品详情<br />     9、结算页面<br />     10、订单列表<br />     11、个人中心<br />     12>、意见反馈<br /> <br />六、官方开发文档：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/">API文档</a><br /> <br />PS：写全局配置文件用微信开发者工具比较快捷，其他用vscode<br /> <br />七、小程序>结构目录<br />     小程序框架的目标是通过尽可能简单、高效的方式让开发者可以在微信中开发具有原生app体验的服务<br /> <br />     小程序内部原生框架名称：MINA<br /> <br />     标签：wxml<br />     样式：wxss<br />     逻辑：JS<br />     配置：JSON<br /> <br />     sitemap配置：小程序根目录下的sitemap.json文件用来配置小程序及其页面是否允许被微信索引<br /> <br />>八、全局配置app.json<br /> <br />    app.json是当前小程序的全局配置，包括了小程序的所有页面路径、界面表现、网络超时时间>、底部tab等<br />        <br />        1、pages字段：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#pages">API</a><br /> <br />PS：在vscode中通过字段新建页面，在微信小程序开发者工具中，必须产生保存行为，才能成功新建页面<br /> <br />2、window字段：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#window">API</a><br /> <br />导航栏属性：<br />navigationBarTextStyle 字段需为 black,white<br />enablePullDownRefresh：下拉刷新，默认为false<br />backgroundTextStyle：下拉刷新显示三个点，字段需为light, dark<br />backgroundColor：下拉刷新背景色<br /> <br />    3、tabbar字段：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#tabBar">API</a><br />   pagePath：页面跳转<br />     text：页面标题<br />     iconPath：未被选中图标<br />     selectedIconPath：当前选中图标<br /> <br />PS：该字段下的部分color属性仅支持十六进制<br /> <br />完整的配置信息请参考<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">app.json</a><br /> <br />九、页面配置<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html">page.json</a><br /> <br />page.json用来表示页面目录下的page.json这类和小程序页面相关的配置。开发者可以独立定义每个页面的一些属性，如：颜色、是否允许下拉刷新等。<br />PS：页面配置只能设置app.json中部分window配置项内容，页面中配置项会覆盖app.json的window中相同的配置项<br /> </p><table><thead><tr><th>navigationBarBackgroundColor</th><th>HexColor</th><th></th><th>#000000</th><th>导航栏背景颜色，如 #000000</th></tr></thead><tbody><tr><td>navigationBarTextStyle</td><td>string</td><td></td><td>white</td><td>导航栏标题颜色，仅支持 black &#x2F; white</td></tr><tr><td>navigationBarTitleText</td><td>string</td><td></td><td></td><td>导航栏标题文字内容</td></tr><tr><td>backgroundColor</td><td>HexColor</td><td></td><td>#ffffff</td><td>窗口的背景色</td></tr><tr><td>backgroundTextStyle</td><td>string</td><td></td><td>dark</td><td>下拉 loading 的样式，仅支持 dark &#x2F; light</td></tr><tr><td>enablePullDownRefresh</td><td>boolean</td><td>false</td><td></td><td>设置为 true 则页面整体不能上下滚动。只在页面配置中有效，无法在 app.json 中设置</td></tr></tbody></table><p> <br />十、sitemap配置—了解即可 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/sitemap.html">API</a><br />该配置文件用于配置小程序及其页面是否允许被微信索引<br /> <br />十一、模板语法<br />     <br />WXML（weixin Markup language）是框架设计的一套标签语言，结合基础组件、事件系统，可以构建出>页面的结构。<br />1、数据绑定<br />渲染object类型，需要单独属性渲染，否则只会出现object<br /> <br />text 相当于以前web中的 span标签 行内元素 不会换行<br /> <br />view 相当于以前web中的 div标签 块级元素 会换行<br /> <br />cheekbox 以前的复选框标签<br /> <br />字符串和花括号之间一定不要存在空格 否则会导致识别失败<br />以下写法就是错误的示范<br />  <checkbox checked="  "></checkbox><br />十二、运算 &#x3D;&gt; 表达式<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/data.html">API</a><br />   <br />1.可以在花括号中 加入 表达式 – “语句”<br />2.表达式<br />  指的是一些简单运算 数字运算 字符串拼接 逻辑运算…<br />  ·数字的加减乘除<br />  ·字符串拼接<br />  ·三元表达>式<br />3.语句<br />  ·复杂的代码段<br />      ☆ if else<br />      ☆switch<br />      ☆do while…<br />      ☆for…<br /> <br />PS:”&#x3D;&#x3D;&#x3D;” 表示全等,即类型和值都相等<br /> <br />十三、列表渲染<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/list.html">API</a><br />   <br />1、wx:for&#x3D;”“  wx:for-item&#x3D;”循环项的名称”    wx:for-index&#x3D;”循环项的索引”<br />2、wx:key&#x3D;”唯一的值” 用来提高列表渲染的性能<br />   ·wx:key 绑定一个普通的字符串的时候 那么这个字符串名称 肯定是循环数组 中的 对象的 唯一属性<br />   ·wx:key&#x3D;”*this” 就表示你的数组 是一个普通的数组 *this表示是 循环项<br />    [1, 2, 3, 44, 5]<br />    [“1”, “222”, “adfdf”]<br />3、当出现 数组的嵌套循环的时候 尤其要注意 一下绑定的名称 不要重名<br />        wx:for-item&#x3D;”item”  wx:for-index&#x3D;”index”<br />4、默认情况下 我们 不写wx:for-item&#x3D;”item”  wx:for-index&#x3D;”index”小程序也会把 循环项的名称 和 索引的名称 item 和 index<br />即 只有一层循环的话(wx:for-item&#x3D;”item”  wx:for-index&#x3D;”index”) 可以省略<br />5、对>象循环<br />   ·wx:for&#x3D;”“  wx:for-item&#x3D;”对象的值”  wx:for-index&#x3D;”对象的属性”<br />   ·循环对象的时候 最好把 item 和 index 的名称修改一下<br />     wx:for-item&#x3D;”value”  wx:for-index&#x3D;”key”<br />注：block<br />   ·占位符的标签<br />   ·写代码的时候 可以看到这标签的存在<br />   ·页面渲染 小程序会把它移除掉<br /> <br />十四、条件渲染 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/conditional.html">API</a><br /> <br />1、wx:if<br />  在框架中，使用 wx:if&#x3D;”” 来判断是否需要渲染该代码块   condition:true&#x2F;false<br />  wx:if<br />  wx:elif<br />  wx:else<br /> <br />2、hidden<br />  类似 wx:if<br />  频繁切换 用 hidden<br />      通过添加样式的方式来切换<br />PS：hidden 属性 不要和 样式 display 一起使用<br />hidden&#x3D;”false“显示标签<br />  <br />>不常使用 用wx:if<br />直接把标签从 页面结构给移除掉<br /> <br />十五、事件绑定<br /> <br />小程序中的事件绑定，通过bind>关键字来实现。如bindtap、bindinput、bindchange等  不同的组件支持不同的事件，具体看组件的说明即可<br /> <br />1 需要给 input 标签绑定 input 事件<br />  绑定关键字 bindinput<br /> <br />2 如何获取 输入框的值<br />  通过事件源对象来获取<br />   e.detail.value<br /> <br />3 把输入框的值 赋值到 data 当中<br />     不能直接<br />       · this.data.num &#x3D; e.detail.value<br />       · thie.num &#x3D; e.detail.value<br />      正确写法<br />        this.setData({<br />           num:e.detail.value<br />        })<br />需要加入一个点击事件<br />        1 bindtap<br />        2 无法在小程序当中的 事>件中 直接传参<br />        3 通过自定义属性的方式来传递参数<br />        4 事件源中获取自定义属性<br /> <br />4、特别注>意<br />   ·绑定事件时不能带参数 不能带括号<br />   ·事件传值 通过标签自定义属性的方式和value<br /> <br />十六、样式wxss <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html">API</a><br />wxss是一套样式语言，用于描述wxml的组件样式<br />与CSS相比  WXSS扩展的特性有：<br />    ·响应式长度单位rpx<br />·样式导入<br />   <br />1、尺寸单位<br />  rpx（responsive pixel）：可以根据屏幕宽度进行自适应，规定屏幕宽度为750rpx<br />建议：开发微信小程序是， 用iPhone6作为视觉稿的标准<br />使用步骤：<br />    ·确定设计稿宽度pageWidth<br />    ·计算比>列 750rpx &#x3D; pageWidth px，  因此 1px &#x3D; 750rpx &#x2F; pageWidth<br />    ·在less文件中，只要把设计稿中的 px &#x3D;&gt; 750 &#x2F; pageWidth rpx即可<br />      利用 一个属性 calc属性 css 和 wxss 都支持 一个属性<br />        · 750 和 rpx 中间不要留空格<br />           · 运算符的两边也不要留空格<br /> <br />2、样式导入<br />  wxss中直接支持 样式导入功>能<br />  也可以和 less中的导入混用<br />  使用 @import语句可以导入外联样式表，只支持相对路径<br /> <br />3、选择器<br />  特别需要注意的是 小程序 不支持通配符 *<br /> <br />目前支持的选择器有：</p><table><thead><tr><th><strong>选择器</strong></th><th><strong>样例</strong></th><th><strong>样例描述</strong></th></tr></thead><tbody><tr><td><strong>.class</strong></td><td>.intro</td><td>选择所有拥有 class&#x3D;”intro” 的组件</td></tr><tr><td><strong>#id</strong></td><td>#firstname</td><td>选择拥有 id&#x3D;”firstname” 的组件</td></tr><tr><td><strong>element</strong></td><td>view</td><td>选择所有 view 组件</td></tr><tr><td><strong>element, element</strong></td><td>view, checkbox</td><td>选择所有文档的 view 组件和所有的 checkbox 组件</td></tr><tr><td><strong>::after</strong></td><td>view::after</td><td>在 view 组件后边插入内容</td></tr><tr><td><strong>::before</strong></td><td>view::before</td><td>在 view 组件前边插入内容</td></tr></tbody></table><p> <br />4、小程序中使用less<br />  原生小程序不支持less  其他基于小程序的框架大体都支持， 如：wepy、mpvue、taro等 但是仅仅因为一个less功能，而去引入一个框架，肯定是不可取的 因此可用以下方式来实现<br />  ·在vscode中安装插件 easy less<br />  ·在vscode的设置中加入如下，配置<br />     <em>“less.compile”</em>: {<br />        <em>“outExt”</em>:     “.wxss”<br />    }<br />·在要编写样式的地方，新建less文件，如index.less即可<br /> <br />十七、常见组件 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/">API</a><br />    <br />1、view<br />      代替原>来的div标签  <br /> <br />2、text<br />  ·文本标签<br />  ·只能嵌套text<br />  ·长安文字可以复制（只有改标签有这个功能）<br />  ·可以对空格 回车 进行编码<br /> <br /> <br /> </p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th><th>最低版本</th></tr></thead><tbody><tr><td><strong>selectable</strong></td><td>boolean</td><td>false</td><td>否</td><td>文本是否可选</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.1.0</a></td></tr><tr><td><strong>decode</strong></td><td>boolean</td><td>false</td><td>否</td><td>是否解码</td><td></td></tr></tbody></table><p>   <br />3、image<br />      ·图片标签 image组件默认宽度320px 高度240px<br />      ·支持懒加载<br />     PS：lazy-load 会自己判断 当 图片 出现在 视口 上下三屏的高度之内的时候 自己开始加载图片<br /> </p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th><th>最低版本</th></tr></thead><tbody><tr><td><strong>src</strong></td><td>string</td><td></td><td>否</td><td>图片资源地址</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.0.0</a></td></tr><tr><td><strong>mode</strong></td><td>string</td><td>scaleToFill</td><td>否</td><td>图片裁剪、缩放的模式</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.0.0</a></td></tr><tr><td><strong>lazy-load</strong></td><td>boolean</td><td>false</td><td>否</td><td>图片懒加载</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.5.0</a></td></tr></tbody></table><p> <br />mode有效值：<br />mode有14种模式 其中5种是缩放模式，9种是裁剪模式<br /> </p><table><thead><tr><th>模式</th><th>值</th><th>说明</th></tr></thead><tbody><tr><td>缩放</td><td>scaleToFill</td><td>不保持纵横比缩放图片，使图片的宽高完全拉伸至填image元素</td></tr><tr><td>缩放</td><td>aspectFit</td><td>保持纵横比缩放图片，使图片的长边能完全显示出来。</td></tr><tr><td>缩放</td><td>aspectFill</td><td>保持纵横比缩放图片，只保证图片的短边能完全显示出来。</td></tr><tr><td>缩放</td><td>widthFix</td><td>宽度不变，高度自动变化，保持原图宽高比不变</td></tr><tr><td>缩放</td><td>heightFix</td><td>高度不变，宽度自动变化，保持原图宽高比不变</td></tr><tr><td>裁剪</td><td>top</td><td>不缩放图片，只显示图片的顶部区域</td></tr><tr><td>裁剪</td><td>bottom</td><td>不缩放图片，只显示图片的底部区域</td></tr><tr><td>裁剪</td><td>center</td><td>不缩放图片，只显示图片的中间区域</td></tr><tr><td>裁剪</td><td>left</td><td>不缩放图片，只显示图片的左边区域</td></tr><tr><td>裁剪</td><td>right</td><td>不缩放图片，只显示图片的右边区域</td></tr><tr><td>裁剪</td><td>top left</td><td>不缩放图片，只显示图片的左上边区域</td></tr><tr><td>裁剪</td><td>top right</td><td>不缩放图片，只显示图片的右上边区域</td></tr><tr><td>裁剪</td><td>bottom left</td><td>不缩放图片，只显示图片的左下边区域</td></tr><tr><td>裁剪</td><td>bottom right</td><td>不缩放图片，只显示图片的右下边区域</td></tr></tbody></table><p> <br />4、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html">swiper</a>（轮播图组件）<br />  </p><table><thead><tr><th><strong>属性</strong></th><th><strong>类型</strong></th><th><strong>默认值</strong></th><th><strong>必填</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><strong>indicator-dots</strong></td><td>boolean</td><td>false</td><td>否</td><td>是否显示面板指示点</td></tr><tr><td><strong>indicator-color</strong></td><td>color</td><td>rgba(0, 0, 0, .3)</td><td>否</td><td>指示点颜色</td></tr><tr><td><strong>indicator-active-color</strong></td><td>color</td><td>#000000</td><td>否</td><td>当前选中的指示点颜色</td></tr><tr><td><strong>autoplay</strong></td><td>boolean</td><td>false</td><td>否</td><td>是否自动切换</td></tr><tr><td><strong>interval</strong></td><td>number</td><td>5000</td><td>否</td><td>自动切换时间间隔</td></tr><tr><td><strong>circular</strong></td><td>boolean</td><td>false</td><td>否</td><td>是否循环轮播</td></tr></tbody></table><p> <br />5、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html">navigator</a>（导航组件）<br />  <br />类似超链接标签<br />  </p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>target</td><td>string</td><td>self</td><td>否</td><td>在哪个目标上发生跳转，默认当前小程序，可选值self&#x2F;miniProgram</td></tr><tr><td>url</td><td>string</td><td></td><td>否</td><td>当前小程序内的跳转链接</td></tr><tr><td>open-type</td><td>string</td><td>navigate</td><td>否</td><td>跳转方式</td></tr></tbody></table><p> <br />open-type有效值</p><table><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td>navigate</td><td>保留当前页面，跳转到应用内某个页面，但是不能跳到tabBar页面</td></tr><tr><td>redirect</td><td>关闭当前页面，跳转到应用内某个页面，但是不允许跳到tabBar页面</td></tr><tr><td>switchTab</td><td>跳转到tabBar页面，并关闭其他所有非tabBar页面</td></tr><tr><td>reLaunch</td><td>关闭所有页面，打开应用内的某个页面</td></tr><tr><td>navigateBack</td><td>关闭当前页面，返回上一页面或多级页面。可通过<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/getCurrentPages.html">getCurrentPages()</a>获取当前的页面栈，决定需要返回几层</td></tr><tr><td>exit</td><td>退出小程序，<code>target=&quot;miniProgram&quot;</code>时生效</td></tr></tbody></table><p>   <br />6、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/rich-text.html">rich-text</a>(富文本标签)<br /> <br />可以将字符解析成 对应标签 类似vue 中 v-heml 功能<br /> <br />7、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/button.html">button</a><br /> </p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td><strong>size</strong></td><td>string</td><td>default</td><td>否</td><td>按钮的大小</td></tr><tr><td><strong>type</strong></td><td>string</td><td>default</td><td>否</td><td>按钮的样式类型</td></tr><tr><td><strong>plain</strong></td><td>boolean</td><td>false</td><td>否</td><td>按钮是否镂空，背景色透明</td></tr><tr><td><strong>disabled</strong></td><td>boolean</td><td>false</td><td>否</td><td>是否禁用</td></tr><tr><td><strong>loading</strong></td><td>boolean</td><td>false</td><td>否</td><td>名称前是否带 loading 图标</td></tr><tr><td><strong>form-type</strong></td><td>string</td><td></td><td>否</td><td>用于<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/form.html"> </a>组件,点击分别会触发<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/form.html"> </a>组件submit&#x2F;reset事件</td></tr><tr><td><strong>open-type</strong></td><td>string</td><td></td><td>否</td><td>微信开放能力</td></tr></tbody></table><p> <br />size的合法值</p><table><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td>default</td><td>默认大小</td></tr><tr><td>mini</td><td>小尺寸</td></tr></tbody></table><p> <br />type的合法值</p><table><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td>primary</td><td>绿色</td></tr><tr><td>default</td><td>白色</td></tr><tr><td>warn</td><td>红色</td></tr></tbody></table><p> <br />form-type的合法值</p><table><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td>submit</td><td>提交表单</td></tr><tr><td>reset</td><td>重置表单</td></tr></tbody></table><p> <br />open-type的合法值<br /> </p><table><thead><tr><th>值</th><th>说明</th></tr></thead><tbody><tr><td>contact</td><td>打开客服会话，如果用户在会话中点击消息卡片后返回小程序，可以从 bindcontact 回调中获得具体信息，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/customer-message/customer-message.html">具体说明</a></td></tr><tr><td>share</td><td>触发用户转发，使用前建议先阅读<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/share.html#%E4%BD%BF%E7%94%A8%E6%8C%87%E5%BC%95">使用指引</a></td></tr><tr><td>getPhoneNumber</td><td>获取用户手机号，可以从bindgetphonenumber回调中获取到用户信息，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html">具体说明</a></td></tr><tr><td>getUserInfo</td><td>获取用户信息，可以从bindgetuserinfo回调中获取到用户信息</td></tr><tr><td>launchApp</td><td>打开APP，可以通过app-parameter属性设定向APP传的参数<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/launchApp.html">具体说明</a></td></tr><tr><td>openSetting</td><td>打开授权设置页</td></tr><tr><td>feedback</td><td>打开“意见反馈”页面，用户可提交反馈内容并上传<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/debug/wx.getLogManager.html">日志</a>，开发者可以登录<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">小程序管理后台</a>后进入左侧菜单“客服反馈”页面获取到反馈内容</td></tr></tbody></table><p> <br />open-type 的 contact 的实现过程<br />² 将小程序的appid 由测试后改为自己的appid<br />² 登录<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/wxamp/home/guide?token=1886309619">微信小程序官网</a>，添加 客服-微信<br />² 准备两个账号<br />                           i.           普通用户A<br />                         ii.           客服->微信B<br />   <br />² 就是干<br />8、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/icon.html">icon</a><br /> </p><table><thead><tr><th>属性</th><th>类型</th><th>默认值</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td><strong>type</strong></td><td>string</td><td></td><td>是</td><td>icon的类型，有效值：success, success_no_circle, info, warn, waiting, cancel, download, search, clear</td></tr><tr><td><strong>size</strong></td><td>number&#x2F;string</td><td>23</td><td>否</td><td>icon的大小</td></tr><tr><td><strong>color</strong></td><td>string</td><td></td><td>否</td><td>icon的颜色，同css的color</td></tr></tbody></table><p>   <br />9、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/radio.html">radio</a>（单选框）<br /> <br />可以通过color属性来修改颜色<br />需要搭配<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/radio-group.html">radio-group</a> 一起使用<br /> <br />10、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/checkbox.html">checkbox</a>（复选框）<br /> <br />可以通过color属性来修改颜色<br />需要搭配<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/checkbox-group.html">checkout-group</a> 一起使用<br /> <br />十八、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/">自定义组>件</a><br />类似于vue或者react中的自定义组件<br />小程序允许我们使用自定义组件的方式来构建页面<br /> <br />1、创建自定义组件<br />类似于页面，一个自定义组件由json wxml wxss js 4个文件组成<br /> <br />可以在微信开发者工具中快速创建组件的文件结构<br />在文件夹内 components&#x2F;myHeader  创建组件 名为 myHeader<br />² 声明组件<br />首先要在组件的json文件中进行>自定义组件声明<br />² 编辑组件<br />同时 还要在组件的wxml文件中编写组件模板 在wxss文件中加入组件样式<br />slot 表示插槽  类似vue中的slot<br />² 注册组件<br />PS： 1 页面.js  文件中 存放事件回调函数的时候 存放在data同层级下！！！<br /> 2 组>件.js  文件中 存放事件回调函数的时候 必须要存放在methods中！！！<br /> <br />1 绑定点击事件 需要在methods中绑定<br />2 >获取被点击的索引<br />3 获取原数组<br />解构 对 复杂类型进行解构的时候 复制了一份 变量的引用而已<br />    最严谨的做法  重新拷贝一份 数组，  再对这个数组的备份进行处理<br />     let tabs &#x3D; JSON.parse(JSON.stringify(this.data.tabs));<br />     不要直接修改 this.data.数据<br /> <br /> 4 对数组循环<br />    1 给每一个循环项 选中属性 改为false<br />    2 给 当前的索引的 项 添加激活选中效果就可以了 <br />[ ].forEach 遍历数组的时候 修改了 v  也会导致原数组被修改<br />5 点击事>件触发的时候<br />        触发父组件中的自定义事件  同时传递数据给 父组件<br />        this.triggerEvent(“父组件自定义事件的名称”, 要传递的参数)<br /> <br /><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Component.html">Component 构造器</a><br />可用于定义组件，调用 Component 构造器时可以指定组件的属性>、数据、方法等。<br /> </p><table><thead><tr><th><strong>定义段</strong></th><th><strong>类型</strong></th><th><strong>是否必填</strong></th><th><strong>描述</strong></th></tr></thead><tbody><tr><td><strong>properties</strong></td><td>Object Map</td><td>否</td><td>组件的对外属性，是属性名到属性设置的映射表</td></tr><tr><td><strong>data</strong></td><td>Object</td><td>否</td><td>组件的内部数据，和 properties 一同用于组件的模板渲染</td></tr><tr><td><strong>observers</strong></td><td>Object</td><td>否</td><td>组件数据字段监听器，用于监听 properties 和 data 的变化，参见 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/observer.html">数据监听器</a></td></tr><tr><td><strong>methods</strong></td><td>Object</td><td>否</td><td>组件的方法，包括事件响应函数和任意的自定义方法，关于事件响应函数的使用，参见 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/events.html">组件间通信与事件</a></td></tr><tr><td><strong>created</strong></td><td>Function</td><td>否</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html">组件生命周期</a>函数-在组件实例刚刚被创建时执行，注意此时不能调用 setData )</td></tr><tr><td><strong>attached</strong></td><td>Function</td><td>否</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html">组件生命周期</a>函数-在组件实例进入页面节点树时执行)</td></tr><tr><td><strong>ready</strong></td><td>Function</td><td>否</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html">组件生命周期</a>函数-在组件布局完成后执行)</td></tr><tr><td><strong>moved</strong></td><td>Function</td><td>否</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html">组件生命周期</a>函数-在组件实例被移动到节点树另一个位置时执行)</td></tr><tr><td><strong>detached</strong></td><td>Function</td><td>否</td><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html">组件生命周期</a>函数-在组件实例被从页面节点树移除时执行)</td></tr></tbody></table><p> <br /> <br />十九、小程序生命周期<br />   <br />分为应用生命周期和页面生命周期<br /> <br />1.    <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html">应用生命周期</a><br /> </p><table><thead><tr><th><strong>属性</strong></th><th><strong>类型</strong></th><th><strong>必填</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><strong><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onLaunch-Object-object">onLaunch</a></strong></td><td>function</td><td>否</td><td>监听小程序初始化。</td></tr><tr><td><strong><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onShow-Object-object">onShow</a></strong></td><td>function</td><td>否</td><td>监听小程序启动或切前台。</td></tr><tr><td><strong><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onHide">onHide</a></strong></td><td>function</td><td>否</td><td>监听小程序切后台。</td></tr><tr><td><strong><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onError-String-error">onError</a></strong></td><td>function</td><td>否</td><td>错误监听函数。</td></tr><tr><td><strong><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onPageNotFound-Object-object">onPageNotFound</a></strong></td><td>function</td><td>否</td><td>页面不存在监听函数。</td></tr></tbody></table><p> <br />2. <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html">页面生命周期</a><br /> </p><table><thead><tr><th><strong>属性</strong></th><th><strong>类型</strong></th><th><strong>说明</strong></th></tr></thead><tbody><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#data">data</a></td><td>Object</td><td>页面的初始数据</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onLoad-Object-query">onLoad</a></td><td>function</td><td>生命周期回调—监听页面加载</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShow">onShow</a></td><td>function</td><td>生命周期回调—监听页面显示</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onReady">onReady</a></td><td>function</td><td>生命周期回调—监听页面初次渲染完成</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onHide">onHide</a></td><td>function</td><td>生命周期回调—监听页面隐藏</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onUnload">onUnload</a></td><td>function</td><td>生命周期回调—监听页面卸载</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onPullDownRefresh">onPullDownRefresh</a></td><td>function</td><td>监听用户下拉动作</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onReachBottom">onReachBottom</a></td><td>function</td><td>页面上拉触底事件的处理函数</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareAppMessage-Object-object">onShareAppMessage</a></td><td>function</td><td>用户点击右上角转发</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onAddToFavorites-Object-object">onAddToFavorites</a></td><td>function</td><td>用户点击右上角收藏</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onPageScroll-Object-object">onPageScroll</a></td><td>function</td><td>页面滚动触发事件的处理函数</td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onResize-Object-object">onResize</a></td><td>function</td><td>页面尺寸改变时触发，详见 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/resizable.html#%E5%9C%A8%E6%89%8B%E6%9C%BA%E4%B8%8A%E5%90%AF%E7%94%A8%E5%B1%8F%E5%B9%95%E6%97%8B%E8%BD%AC%E6%94%AF%E6%8C%81">响应显示区域变化</a></td></tr><tr><td><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onTabItemTap-Object-object">onTabItemTap</a></td><td>function</td><td>当前是 tab 页时，点击 tab 时触发</td></tr></tbody></table><table><thead><tr><th></th><th><img src="https://pzxnys.github.io/images/IG7J3T.png"></th></tr></thead></table><p>页面生命周期图解</p>]]></content>
      
      
      <categories>
          
          <category> WeChat </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Initial </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
